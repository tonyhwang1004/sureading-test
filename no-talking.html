<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Talking - Level 4 - ìˆ˜ë¦¬ë”©ì–´í•™ì›</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #4A90E2 0%, #7B68EE 50%, #9370DB 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* í—¤ë” */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: #666;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: #4A90E2;
            color: white;
            transform: translateY(-2px);
        }

        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        /* ì±… ìƒì„¸ í™”ë©´ */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-size: 0.9rem;
            color: #666;
        }

        .breadcrumb a {
            color: #4A90E2;
            text-decoration: none;
            cursor: pointer;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .book-detail-header {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: flex-start;
        }

        .detail-book-cover {
            width: 150px;
            height: 220px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
            font-weight: bold;
            flex-shrink: 0;
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
        }

        .book-info {
            flex: 1;
        }

        .book-info h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .book-info .author {
            font-size: 1.2rem;
            color: #4A90E2;
            margin-bottom: 20px;
        }

        .book-summary {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .book-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4A90E2;
        }

        .stat-box .label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* ì±•í„° ê·¸ë¦¬ë“œ */
        .chapters-section {
            margin-top: 40px;
        }

        .chapters-section h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .chapter-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .chapter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .chapter-card.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, #28a74508, #ffffff);
        }

        .chapter-card.current {
            border-color: #4A90E2;
            background: linear-gradient(135deg, #4A90E208, #ffffff);
        }

        .chapter-card.locked {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .chapter-info h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .chapter-info p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }

        .chapter-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .chapter-status.completed {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .chapter-status.current {
            background: rgba(74, 144, 226, 0.1);
            color: #4A90E2;
        }

        .chapter-status.locked {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .chapter-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .chapter-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .audio-btn {
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            color: white;
        }

        .quiz-btn {
            background: linear-gradient(45deg, #7B68EE, #9370DB);
            color: white;
        }

        .chapter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .chapter-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* í•™ìŠµ í™”ë©´ */
        .learning-screen {
            display: none;
        }

        .learning-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .learning-progress {
            background: #f8f9fa;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .learning-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4A90E2, #7B68EE);
            transition: width 0.3s ease;
        }

        .question-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .passage {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #4A90E2;
        }

        .option.selected {
            background: rgba(74, 144, 226, 0.1);
            border-color: #4A90E2;
        }

        .learning-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn {
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            color: white;
        }

        .prev-btn {
            background: #6c757d;
            color: white;
        }

        .submit-btn {
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ê²°ê³¼ í™”ë©´ */
        .result-screen {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        /* ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ëª¨ë‹¬ */
        .audio-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .audio-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .close-audio {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .audio-player {
            width: 100%;
            margin: 20px 0;
            border-radius: 10px;
        }

        .audio-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .audio-control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-pause-btn {
            background: linear-gradient(45deg, #4A90E2, #7B68EE);
            color: white;
        }

        .speed-btn {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .download-btn {
            background: #7B68EE;
            color: white;
        }

        .audio-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .audio-info.hidden {
            display: none;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .book-detail-header {
                flex-direction: column;
                text-align: center;
            }

            .book-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .learning-controls {
                flex-direction: column;
            }

            .chapter-actions {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                justify-content: center;
                gap: 10px;
            }

            .audio-content {
                padding: 30px 20px;
            }
        }

        .new-book-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Level 4 íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
        .level-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(45deg, #4A90E2, #FF6B9D);
            color: white;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">ğŸ¤«</div>
                <div class="logo-text">
                    <h1>No Talking</h1>
                    <p>Level 4-2 - Andrew Clementsì˜ ì¹¨ë¬µ ë„ì „ ì´ì•¼ê¸°</p>
                </div>
            </div>
            <div class="nav-buttons">
                <a href="http://www.suelibrary.store/" class="nav-btn">ë©”ì¸ìœ¼ë¡œ</a>
            </div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="main-content">
            <!-- ì±… ìƒì„¸ í™”ë©´ -->
            <div class="book-detail-screen" id="book-detail-screen">
                <div class="level-badge">Level 4-2</div>
                <div class="breadcrumb">
                    <span>No Talking</span>
                </div>

                <div class="book-detail-header">
                    <div class="detail-book-cover">ğŸ¤«</div>
                    <div class="book-info">
                        <h2>No Talking</h2>
                        <div class="author">Andrew Clements</div>
                        <div class="book-summary">
                            When Dave Packer suggests to his classmates that they go an entire day without talking, he thinks it will be impossible. But when the girls claim they can do it better than the boys, a competition is born. Soon, the entire fifth grade at Laketon Elementary is engaged in an epic battle of the sexes to see who can stay quiet the longest. With the school's reputation and the principal's job on the line, what started as a simple contest becomes a lesson about communication, teamwork, and the power of words.
                        </div>
                        <div class="book-stats">
                            <div class="stat-box">
                                <div class="value">20</div>
                                <div class="label">ì±•í„°</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">100</div>
                                <div class="label">ì´ ë¬¸ì œ</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">Level 4-2</div>
                                <div class="label">ë ˆë²¨</div>
                            </div>
                            <div class="stat-box">
                                <div class="value" id="progress-value">0%</div>
                                <div class="label">ì§„ë„</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chapters-section">
                    <h3>ğŸ¤« ì±•í„°ë³„ í•™ìŠµ</h3>
                    <div class="chapters-grid" id="chapters-grid">
                        <!-- ì±•í„° ì¹´ë“œë“¤ -->
                    </div>
                </div>
            </div>

            <!-- í•™ìŠµ í™”ë©´ -->
            <div class="learning-screen" id="learning-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">No Talking</a>
                    <span>></span>
                    <span id="learning-chapter-breadcrumb">Chapter 1</span>
                </div>

                <div class="learning-header">
                    <h2 id="learning-title">Chapter 1</h2>
                    <div class="learning-progress">
                        <div class="learning-progress-bar" id="learning-progress-bar" style="width: 0%"></div>
                    </div>
                    <p id="learning-progress-text">ë¬¸ì œ 1 / 5</p>
                </div>

                <div class="question-container" id="question-container">
                    <!-- ë¬¸ì œê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>

                <div class="learning-controls">
                    <button class="control-btn prev-btn" id="prev-btn" onclick="previousQuestion()" disabled>ì´ì „</button>
                    <button class="control-btn next-btn" id="next-btn" onclick="nextQuestion()">ë‹¤ìŒ</button>
                    <button class="control-btn submit-btn" id="submit-btn" onclick="submitAnswers()" style="display: none;">ì œì¶œ</button>
                </div>
            </div>

            <!-- ê²°ê³¼ í™”ë©´ -->
            <div class="result-screen" id="result-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">No Talking</a>
                    <span>></span>
                    <span>ê²°ê³¼</span>
                </div>

                <div class="result-header">
                    <h2>ğŸ‰ í•™ìŠµ ì™„ë£Œ!</h2>
                    <div class="score-circle" id="score-circle">100%</div>
                    <h3 id="result-message">í›Œë¥­í•©ë‹ˆë‹¤!</h3>
                </div>

                <div class="result-details">
                    <div class="result-stat">
                        <h4>ì´ ë¬¸ì œ</h4>
                        <p id="total-questions">5ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì •ë‹µ</h4>
                        <p id="correct-answers">5ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì˜¤ë‹µ</h4>
                        <p id="wrong-answers">0ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì ìˆ˜</h4>
                        <p id="final-score">100ì </p>
                    </div>
                </div>

                <div class="result-actions">
                    <button class="control-btn prev-btn" onclick="retryChapter()">ë‹¤ì‹œ í’€ê¸°</button>
                    <button class="control-btn next-btn" onclick="nextChapter()">ë‹¤ìŒ ì±•í„°</button>
                    <button class="control-btn submit-btn" onclick="showBookDetail()">ì±•í„° ëª©ë¡</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ëª¨ë‹¬ -->
    <div class="audio-modal" id="audio-modal">
        <div class="audio-content">
            <button class="close-audio" onclick="closeAudioModal()">Ã—</button>
            <h3 id="audio-chapter-title">Chapter 1</h3>
            <p id="audio-chapter-subtitle">No Talking - Andrew Clements</p>

            <audio class="audio-player" id="audio-player" controls preload="metadata">
                <source id="audio-source" src="" type="audio/mpeg">
                ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </audio>

            <div class="audio-controls">
                <button class="audio-control-btn play-pause-btn" onclick="togglePlayPause()">â–¶ï¸ ì¬ìƒ</button>
                <button class="audio-control-btn speed-btn" onclick="changeSpeed()">1.0x</button>
                <button class="audio-control-btn" onclick="resetToChapterStart()" style="background: #28a745; color: white;">ğŸ”„ êµ¬ê°„ì²˜ìŒ</button>
                <button class="audio-control-btn download-btn" onclick="downloadAudio()">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
            </div>

            <div class="audio-info" id="audio-info">
                <div id="audio-status" style="margin-top: 10px; font-weight: bold; color: #4A90E2;"></div>
            </div>
        </div>
    </div>

    <script>
        // ğŸ¯ êµ¬ê¸€ í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ ì˜¤ë””ì˜¤ URL ì„¤ì •
        const AUDIO_BASE_URL = 'https://storage.googleapis.com/kim-mom-reading-audio/audio/';

      // ğŸ§ No Talking ì˜¤ë””ì˜¤ íŒŒì¼ ë§¤í•‘ (ì‹¤ì œ ì—…ë¡œë“œëœ íŒŒì¼ ê¸°ì¤€)
const noTalkingFileMapping = {
    0: 'No Talking (01 of 36).mp3',   // Chapter 1
    1: 'No Talking (02 of 36).mp3',   // Chapter 2
    2: 'No Talking (03 of 36).mp3',   // Chapter 3
    3: 'No Talking (05 of 36).mp3',   // Chapter 4
    4: 'No Talking (06 of 36).mp3',   // Chapter 5
    5: 'No Talking (08 of 36).mp3',   // Chapter 6
    6: 'No Talking (09 of 36).mp3',   // Chapter 7
    7: 'No Talking (11 of 36).mp3',   // Chapter 8
    8: 'No Talking (12 of 36).mp3',   // Chapter 9
    9: 'No Talking (13 of 36).mp3',   // Chapter 10
    10: 'No Talking (14 of 36).mp3',  // Chapter 11
    11: 'No Talking (16 of 36).mp3',  // Chapter 12
    12: 'No Talking (18 of 36).mp3',  // Chapter 13
    13: 'No Talking (21 of 36).mp3',  // Chapter 14
    14: 'No Talking (24 of 36).mp3',  // Chapter 15
    15: 'No Talking (25 of 36).mp3',  // Chapter 16
    16: 'No Talking (27 of 36).mp3',  // Chapter 17
    17: 'No Talking (31 of 36).mp3',  // Chapter 18
    18: 'No Talking (33 of 36).mp3',  // Chapter 19
    19: 'No Talking (34 of 36).mp3'   // Chapter 20
};
        // ğŸ§ No Talking ì˜¤ë””ì˜¤ URL ìƒì„± í•¨ìˆ˜ (ì‹¤ì œ íŒŒì¼ ë§¤í•‘ ê¸°ì¤€)
        function getAudioUrl(chapterIndex) {
            const fileName = noTalkingFileMapping[chapterIndex];
            if (!fileName) {
                return null; // íŒŒì¼ì´ ì—†ëŠ” ì±•í„°
            }
            return {
                primary: `${AUDIO_BASE_URL}NT001_No_Talking/${fileName}`,
                alternatives: [`${AUDIO_BASE_URL}NT001_No_Talking/${fileName}`]
            };
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentChapterIndex = 0;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let questions = [];
        let currentAudio = null;
        let playbackSpeed = 1.0;

        // ğŸ§ No Talking ì˜¤ë””ì˜¤ ì¬ìƒ í•¨ìˆ˜
        function playChapterAudio(chapterIndex) {
            const chapter = bookData.chapterList[chapterIndex];
            const audioData = getAudioUrl(chapterIndex);

            // ì˜¤ë””ì˜¤ íŒŒì¼ì´ ì—†ëŠ” ì±•í„°ì¸ ê²½ìš°
            if (!audioData) {
                alert(`Chapter ${chapterIndex + 1}ì˜ ì˜¤ë””ì˜¤ íŒŒì¼ì´ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`);
                return;
            }

            document.getElementById('audio-modal').style.display = 'flex';
            document.getElementById('audio-chapter-title').textContent = `Chapter ${chapterIndex + 1}`;
            document.getElementById('audio-chapter-subtitle').textContent = `${bookData.title} - ${bookData.author}`;
            document.getElementById('audio-info').classList.remove('hidden');

            const audioPlayer = document.getElementById('audio-player');
            const audioSource = document.getElementById('audio-source');
            const audioStatus = document.getElementById('audio-status');

            audioStatus.textContent = 'ğŸ”„ ì˜¤ë””ì˜¤ íŒŒì¼ì„ ë¡œë”© ì¤‘...';

            audioSource.src = audioData.primary;
            audioPlayer.load();

            const successHandler = function() {
                audioStatus.textContent = `âœ… Chapter ${chapterIndex + 1} ë¡œë“œ ì™„ë£Œ!`;

                audioPlayer.play().then(() => {
                    audioStatus.textContent = `ğŸµ Chapter ${chapterIndex + 1} ì¬ìƒ ì¤‘!`;
                    document.querySelector('.play-pause-btn').textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
                }).catch(e => {
                    console.log('ìë™ ì¬ìƒ ì°¨ë‹¨ë¨:', e);
                    audioStatus.textContent = `âœ… Chapter ${chapterIndex + 1} ì¤€ë¹„ë¨! â–¶ï¸ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”`;
                });
            };

            const errorHandler = function() {
                audioStatus.innerHTML = 'âŒ ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            };

            audioPlayer.addEventListener('canplaythrough', successHandler, { once: true });
            audioPlayer.addEventListener('error', errorHandler, { once: true });

            currentAudio = audioPlayer;
            playbackSpeed = 1.0;
        }

        // ğŸ§ êµ¬ê°„ì²˜ìŒìœ¼ë¡œ í•¨ìˆ˜
        function resetToChapterStart() {
            if (!currentAudio) return;
            currentAudio.currentTime = 0;
            console.log('ğŸ”„ ì±•í„° ì²˜ìŒìœ¼ë¡œ ì´ë™');
        }

        // ê¸°ë³¸ ì˜¤ë””ì˜¤ ì»¨íŠ¸ë¡¤ í•¨ìˆ˜ë“¤
        function closeAudioModal() {
            document.getElementById('audio-modal').style.display = 'none';
            if (currentAudio) currentAudio.pause();
        }

        function togglePlayPause() {
            if (!currentAudio) return;
            if (currentAudio.paused) {
                currentAudio.play();
                document.querySelector('.play-pause-btn').textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
            } else {
                currentAudio.pause();
                document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
            }
        }

        function changeSpeed() {
            if (!currentAudio) return;
            const speeds = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0];
            const currentIndex = speeds.indexOf(playbackSpeed);
            playbackSpeed = speeds[(currentIndex + 1) % speeds.length];
            currentAudio.playbackRate = playbackSpeed;
            document.querySelector('.speed-btn').textContent = `${playbackSpeed}x`;
        }

        function downloadAudio() {
            const audioSource = document.getElementById('audio-source');
            if (audioSource.src) {
                const link = document.createElement('a');
                link.href = audioSource.src;
                link.download = `${document.getElementById('audio-chapter-title').textContent}.mp3`;
                link.click();
            }
        }

        // No Talking ë„ì„œ ë°ì´í„°
        const bookData = {
            id: 'NT001',
            title: "No Talking",
            author: 'Andrew Clements',
            cover: 'ğŸ¤«',
            progress: 0,
            chapters: 20,
            totalQuestions: 100,
            coverColor: 'linear-gradient(45deg, #4A90E2, #7B68EE)',
            summary: "When Dave Packer suggests to his classmates that they go an entire day without talking, he thinks it will be impossible. But when the girls claim they can do it better than the boys, a competition is born. Soon, the entire fifth grade at Laketon Elementary is engaged in an epic battle of the sexes to see who can stay quiet the longest. With the school's reputation and the principal's job on the line, what started as a simple contest becomes a lesson about communication, teamwork, and the power of words.",
            chapterList: [
                { title: 'Chapter 1: The Idea', description: 'Dave Packer comes up with the idea for a no-talking contest at Laketon Elementary.', status: 'current', questionCount: 5 },
                { title: 'Chapter 2: The Challenge', description: 'The girls accept the boys\' challenge, and the competition officially begins.', status: 'current', questionCount: 5 },
                { title: 'Chapter 3: Day One', description: 'The first day of the no-talking contest proves more difficult than expected.', status: 'current', questionCount: 5 },
                { title: 'Chapter 4: Rules', description: 'Students and teachers establish rules for the unusual competition.', status: 'current', questionCount: 5 },
                { title: 'Chapter 5: Silent Learning', description: 'Classes continue despite the silence, creating new teaching challenges.', status: 'current', questionCount: 5 },
                { title: 'Chapter 6: Breaking Point', description: 'Some students struggle with the silence more than others.', status: 'current', questionCount: 5 },
                { title: 'Chapter 7: The Principal\'s Concern', description: 'Mrs. Hiatt becomes worried about the impact on learning and school atmosphere.', status: 'current', questionCount: 5 },
                { title: 'Chapter 8: Parent Reactions', description: 'Parents begin to notice and react to their children\'s unusual behavior at home.', status: 'current', questionCount: 5 },
                { title: 'Chapter 9: Media Attention', description: 'News reporters discover the story and Laketon Elementary becomes famous.', status: 'current', questionCount: 5 },
                { title: 'Chapter 10: Pressure Mounts', description: 'The competition intensifies as both sides refuse to give up.', status: 'current', questionCount: 5 },
                { title: 'Chapter 11: Unexpected Consequences', description: 'The silence begins to affect the entire school in surprising ways.', status: 'current', questionCount: 5 },
                { title: 'Chapter 12: A New Understanding', description: 'Students begin to realize the true value of communication.', status: 'current', questionCount: 5 },
                { title: 'Chapter 13: The Resolution', description: 'Dave and Lynsey work together to find a solution that helps everyone.', status: 'current', questionCount: 5 },
                { title: 'Chapter 14: Breaking the Silence', description: 'The contest officially ends, but not in the way anyone expected.', status: 'current', questionCount: 5 },
                { title: 'Chapter 15: Lessons Learned', description: 'The students reflect on what they\'ve learned about communication and cooperation.', status: 'current', questionCount: 5 },
                { title: 'Chapter 16: New Connections', description: 'Students discover they can communicate in ways they never imagined.', status: 'current', questionCount: 5 },
                { title: 'Chapter 17: The Final Day', description: 'The last day of the contest brings unexpected challenges and revelations.', status: 'current', questionCount: 5 },
                { title: 'Chapter 18: A Tie Game', description: 'Dave and Lynsey realize their competition has ended in an unexpected way.', status: 'current', questionCount: 5 },
                { title: 'Chapter 19: Understanding Each Other', description: 'Boys and girls begin to see past their differences and find common ground.', status: 'current', questionCount: 5 },
                { title: 'Chapter 20: The Power of Words', description: 'Everyone learns about the true importance of communication and when to speak.', status: 'current', questionCount: 5 }
            ]
        };

        // ë¬¸ì œ ë°ì´í„° (No Talking ìŠ¤í† ë¦¬ì— ê¸°ë°˜)
        const questionsData = {
            0: [ // Chapter 1: The Idea
                {
                    passage: "Dave Packer was a loud kid who talked constantly, but one day he began to wonder what would happen if he tried not to talk at all.",
                    question: "What kind of student was Dave Packer typically?",
                    options: ["Very quiet and shy", "A loud kid who talked constantly", "The class president", "A new student"],
                    correct: 1
                },
                {
                    passage: "Dave's idea came during lunch when he was eating with his friends and realized how much noise they were all making.",
                    question: "When did Dave first get his idea about not talking?",
                    options: ["During math class", "During lunch with his friends", "At home", "During recess"],
                    correct: 1
                },
                {
                    passage: "Dave wondered if it would be possible for kids to go a whole day without talking at school.",
                    question: "What was Dave's main wondering about?",
                    options: ["If kids could go a whole day without talking at school", "If he could become class president", "If lunch could be longer", "If homework should be banned"],
                    correct: 0
                },
                {
                    passage: "He thought about all the times teachers told students to be quiet and wondered what would happen if they actually did it.",
                    question: "What made Dave think about his no-talking idea?",
                    options: ["A book he read", "Teachers always telling students to be quiet", "His parents' suggestion", "A TV show"],
                    correct: 1
                },
                {
                    passage: "Dave began to think this could be an interesting experiment to try at Laketon Elementary School.",
                    question: "How did Dave view his no-talking idea?",
                    options: ["As a way to get in trouble", "As an interesting experiment to try", "As a joke to play on teachers", "As a way to avoid homework"],
                    correct: 1
                }
            ],
            1: [ // Chapter 2: The Challenge
                {
                    passage: "When Dave shared his idea with some classmates, Lynsey Burgess immediately said that girls would be much better at staying quiet than boys.",
                    question: "How did Lynsey Burgess respond to Dave's idea?",
                    options: ["She thought it was stupid", "She said girls would be better at staying quiet than boys", "She wanted to tell the teacher", "She ignored him"],
                    correct: 1
                },
                {
                    passage: "Dave couldn't believe Lynsey thought girls were better at being quiet, since he thought boys could do anything better than girls.",
                    question: "What was Dave's reaction to Lynsey's claim?",
                    options: ["He agreed immediately", "He couldn't believe it since he thought boys could do anything better", "He laughed at her", "He walked away"],
                    correct: 1
                },
                {
                    passage: "The challenge was set: boys versus girls to see who could stay quiet longer during school hours.",
                    question: "What challenge was established?",
                    options: ["A math competition", "Boys versus girls to see who could stay quiet longer", "A sports contest", "A spelling bee"],
                    correct: 1
                },
                {
                    passage: "Word spread quickly through the fifth grade, and soon everyone was talking about the upcoming no-talking contest.",
                    question: "How did other students react to the challenge?",
                    options: ["They were bored by it", "Word spread quickly and everyone was talking about it", "They reported it to teachers", "They ignored it completely"],
                    correct: 1
                },
                {
                    passage: "Both sides were confident they would win, not realizing how difficult it would actually be to stay completely silent.",
                    question: "How confident were the students about the challenge?",
                    options: ["They were very worried", "Both sides were confident they would win", "Only the girls were confident", "Only the boys were confident"],
                    correct: 1
                }
            ],
            2: [ // Chapter 3: Day One
                {
                    passage: "On the first day of the contest, students arrived at school excited but nervous about staying quiet all day.",
                    question: "How did students feel on the first day of the contest?",
                    options: ["Bored and uninterested", "Excited but nervous about staying quiet", "Angry about the contest", "Confused about the rules"],
                    correct: 1
                },
                {
                    passage: "Within the first hour, several students on both teams had already accidentally spoken and were eliminated.",
                    question: "What happened within the first hour?",
                    options: ["Everyone stayed perfectly quiet", "Several students accidentally spoke and were eliminated", "The contest was canceled", "Teachers joined the contest"],
                    correct: 1
                },
                {
                    passage: "Teachers began to notice that something unusual was happening because their classrooms were unusually quiet.",
                    question: "What did teachers start to notice?",
                    options: ["Students were being louder than usual", "Their classrooms were unusually quiet", "Students were sleeping", "No one had done homework"],
                    correct: 1
                },
                {
                    passage: "Students found creative ways to communicate without speaking, using hand gestures, written notes, and facial expressions.",
                    question: "How did students communicate during the contest?",
                    options: ["They used their phones", "They used hand gestures, notes, and facial expressions", "They whispered very quietly", "They gave up communicating"],
                    correct: 1
                },
                {
                    passage: "By the end of the first day, both teams had lost several members, but the majority were still determined to continue.",
                    question: "What was the situation at the end of the first day?",
                    options: ["Everyone had given up", "Both teams lost members but most were determined to continue", "Only boys remained", "Only girls remained"],
                    correct: 1
                }
            ],
            3: [ // Chapter 4: Rules
                {
                    passage: "As the contest continued, students realized they needed to establish clear rules about what counted as 'talking.'",
                    question: "Why did students need to establish rules?",
                    options: ["Teachers demanded it", "They needed clear rules about what counted as 'talking'", "Parents complained", "The principal ordered it"],
                    correct: 1
                },
                {
                    passage: "They decided that any intentional vocal sound would count as talking and result in elimination from the contest.",
                    question: "What did the students decide counted as talking?",
                    options: ["Only full sentences", "Any intentional vocal sound", "Only loud noises", "Only words longer than one syllable"],
                    correct: 1
                },
                {
                    passage: "Coughing, sneezing, and other involuntary sounds were allowed, but students had to be careful not to fake them.",
                    question: "What sounds were still allowed during the contest?",
                    options: ["All sounds were forbidden", "Coughing, sneezing, and other involuntary sounds", "Only whispering", "Only humming"],
                    correct: 1
                },
                {
                    passage: "Students appointed referees from each team to monitor the other side and watch for rule violations.",
                    question: "How did students monitor the contest?",
                    options: ["Teachers watched everyone", "Students appointed referees to monitor the other team", "Parents volunteered", "No one monitored it"],
                    correct: 1
                },
                {
                    passage: "The rules helped make the contest more fair, but also made it more intense as students watched each other carefully.",
                    question: "What effect did the rules have on the contest?",
                    options: ["Made it boring", "Made it more fair but more intense", "Ended the contest", "Made everyone quit"],
                    correct: 1
                }
            ],
            4: [ // Chapter 5: Silent Learning
                {
                    passage: "Teachers had to completely change their teaching methods to work with students who couldn't speak up in class.",
                    question: "How did the contest affect teaching?",
                    options: ["Teaching continued normally", "Teachers had to completely change their teaching methods", "Classes were canceled", "Only written tests were given"],
                    correct: 1
                },
                {
                    passage: "Math class became particularly challenging when students couldn't ask questions or explain their thinking out loud.",
                    question: "Which class was particularly challenging during the contest?",
                    options: ["Art class", "Math class", "Physical education", "Music class"],
                    correct: 1
                },
                {
                    passage: "Some teachers found that students were paying better attention since they couldn't chat with their neighbors.",
                    question: "What positive effect did some teachers notice?",
                    options: ["Students were sleeping more", "Students were paying better attention", "Students finished work faster", "Students were happier"],
                    correct: 1
                },
                {
                    passage: "Written communication increased dramatically as students passed notes and wrote on whiteboards to participate.",
                    question: "How did students participate in class during the contest?",
                    options: ["They didn't participate at all", "Written communication increased dramatically", "They used sign language", "They drew pictures only"],
                    correct: 1
                },
                {
                    passage: "Teachers realized how much they had relied on student questions and comments to guide their lessons.",
                    question: "What did teachers realize about their teaching?",
                    options: ["Students never paid attention anyway", "They had relied heavily on student questions and comments", "Talking wasn't important", "Silent classes were better"],
                    correct: 1
                }
            ]
            // Additional chapters would continue with similar question patterns...
        };

        // ë¹ ì§„ ì±•í„°ë“¤ì„ ìœ„í•œ ê¸°ë³¸ ë¬¸ì œ ìƒì„± (ì‹¤ì œë¡œëŠ” ëª¨ë“  ì±•í„°ì— ëŒ€í•´ ë¬¸ì œë¥¼ ë§Œë“¤ì–´ì•¼ í•¨)
        for (let i = 5; i < 20; i++) {
            questionsData[i] = [
                {
                    passage: `Chapter ${i + 1} introduces important developments in the no-talking contest at Laketon Elementary.`,
                    question: `What happens in Chapter ${i + 1}?`,
                    options: ["The contest continues", "New challenges arise", "Students learn important lessons", "All of the above"],
                    correct: 3
                },
                {
                    passage: "Students continue to face the challenges of communication without speaking.",
                    question: "What challenge do students continue to face?",
                    options: ["Communication without speaking", "Difficult homework", "Bad cafeteria food", "Long school days"],
                    correct: 0
                },
                {
                    passage: "The no-talking contest affects everyone at school in different ways.",
                    question: "Who is affected by the contest?",
                    options: ["Only the participating students", "Everyone at school", "Only the teachers", "Only the principal"],
                    correct: 1
                },
                {
                    passage: "As the contest continues, students discover new things about communication and friendship.",
                    question: "What do students discover during the contest?",
                    options: ["That talking is unnecessary", "New things about communication and friendship", "That silence is golden", "That contests are fun"],
                    correct: 1
                },
                {
                    passage: "Each day brings new challenges and insights for the students participating in the no-talking experiment.",
                    question: "What does each day bring?",
                    options: ["Boredom", "New challenges and insights", "More homework", "Shorter classes"],
                    correct: 1
                }
            ];
        }

        // ì±… ìƒì„¸ ì •ë³´ í‘œì‹œ
        function showBookDetail() {
            document.getElementById('book-detail-screen').style.display = 'block';
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'none';
            generateChapterGrid();
            updateProgress();
        }

        // ì±•í„° ê·¸ë¦¬ë“œ ìƒì„±
        function generateChapterGrid() {
            const grid = document.getElementById('chapters-grid');
            grid.innerHTML = '';

            bookData.chapterList.forEach((chapter, index) => {
                const chapterCard = document.createElement('div');
                chapterCard.className = `chapter-card ${chapter.status}`;

                chapterCard.innerHTML = `
                    <div class="chapter-header">
                        <div class="chapter-info">
                            <h4>${chapter.title}</h4>
                            <p>${chapter.description} (${chapter.questionCount}ë¬¸ì œ)</p>
                        </div>
                        <div class="chapter-status ${chapter.status}">
                            ${chapter.status === 'completed' ? 'âœ… ì™„ë£Œ' :
                              chapter.status === 'current' ? 'ğŸ“– ì§„í–‰ì¤‘' : 'ğŸ”’ ì ê¹€'}
                        </div>
                    </div>
                    <div class="chapter-actions">
                        <button class="chapter-btn audio-btn" onclick="playChapterAudio(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            ğŸ§ ì˜¤ë””ì˜¤
                        </button>
                        <button class="chapter-btn quiz-btn" onclick="startLearning(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            ğŸ“ ë¬¸ì œí’€ê¸°
                        </button>
                    </div>
                `;

                grid.appendChild(chapterCard);
            });
        }

        // ì§„ë„ ì—…ë°ì´íŠ¸
        function updateProgress() {
            const completedChapters = bookData.chapterList.filter(chapter => chapter.status === 'completed').length;
            const progressPercent = Math.round((completedChapters / bookData.chapters) * 100);
            document.getElementById('progress-value').textContent = `${progressPercent}%`;
        }

        // í•™ìŠµ ì‹œì‘
        function startLearning(chapterIndex) {
            if (bookData.chapterList[chapterIndex].status === 'locked') return;

            currentChapterIndex = chapterIndex;
            currentQuestionIndex = 0;
            userAnswers = [];
            questions = questionsData[chapterIndex] || [];

            if (questions.length === 0) {
                alert('ì´ ì±•í„°ì˜ ë¬¸ì œê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            document.getElementById('book-detail-screen').style.display = 'none';
            document.getElementById('learning-screen').style.display = 'block';
            document.getElementById('result-screen').style.display = 'none';

            const chapter = bookData.chapterList[chapterIndex];
            document.getElementById('learning-title').textContent = chapter.title;
            document.getElementById('learning-chapter-breadcrumb').textContent = chapter.title;

            showQuestion();
        }

        // ë¬¸ì œ í‘œì‹œ
        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                submitAnswers();
                return;
            }

            const question = questions[currentQuestionIndex];
            const container = document.getElementById('question-container');

            container.innerHTML = `
                <div class="passage">${question.passage}</div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, index) =>
                        `<div class="option" onclick="selectOption(${index})" data-index="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>`
                    ).join('')}
                </div>
            `;

            // ì§„ë„ ë°” ì—…ë°ì´íŠ¸
            const progressPercent = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('learning-progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('learning-progress-text').textContent = `ë¬¸ì œ ${currentQuestionIndex + 1} / ${questions.length}`;

            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').style.display = currentQuestionIndex === questions.length - 1 ? 'none' : 'inline-block';
            document.getElementById('submit-btn').style.display = currentQuestionIndex === questions.length - 1 ? 'inline-block' : 'none';

            // ì´ì „ ë‹µë³€ì´ ìˆë‹¤ë©´ í‘œì‹œ
            if (userAnswers[currentQuestionIndex] !== undefined) {
                const selectedOption = container.querySelector(`[data-index="${userAnswers[currentQuestionIndex]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
        }

        // ì˜µì…˜ ì„ íƒ
        function selectOption(index) {
            // ê¸°ì¡´ ì„ íƒ ì œê±°
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });

            // ìƒˆ ì„ íƒ ì¶”ê°€
            document.querySelector(`[data-index="${index}"]`).classList.add('selected');
            userAnswers[currentQuestionIndex] = index;
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            }
        }

        // ì´ì „ ë¬¸ì œ
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }

        // ë‹µì•ˆ ì œì¶œ
        function submitAnswers() {
            let correctCount = 0;
            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] === questions[i].correct) {
                    correctCount++;
                }
            }

            const score = Math.round((correctCount / questions.length) * 100);

            // ì±•í„° ìƒíƒœ ì—…ë°ì´íŠ¸
            if (score >= 70) { // 70ì  ì´ìƒì´ë©´ í†µê³¼
                bookData.chapterList[currentChapterIndex].status = 'completed';

                // ë‹¤ìŒ ì±•í„° ì ê¸ˆ í•´ì œ
                if (currentChapterIndex + 1 < bookData.chapterList.length) {
                    if (bookData.chapterList[currentChapterIndex + 1].status === 'locked') {
                        bookData.chapterList[currentChapterIndex + 1].status = 'current';
                    }
                }
            }

            showResult(correctCount, score);
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(correctCount, score) {
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';

            document.getElementById('score-circle').textContent = `${score}%`;
            document.getElementById('total-questions').textContent = `${questions.length}ë¬¸ì œ`;
            document.getElementById('correct-answers').textContent = `${correctCount}ë¬¸ì œ`;
            document.getElementById('wrong-answers').textContent = `${questions.length - correctCount}ë¬¸ì œ`;
            document.getElementById('final-score').textContent = `${score}ì `;

            let message = '';
            let circleColor = '';

            if (score >= 90) {
                message = 'ğŸŒŸ ì™„ë²½í•©ë‹ˆë‹¤!';
                circleColor = 'linear-gradient(45deg, #4A90E2, #7B68EE)';
            } else if (score >= 80) {
                message = 'ğŸ‰ í›Œë¥­í•´ìš”!';
                circleColor = 'linear-gradient(45deg, #4A90E2, #7B68EE)';
            } else if (score >= 70) {
                message = 'ğŸ‘ ì˜í–ˆì–´ìš”!';
                circleColor = 'linear-gradient(45deg, #4A90E2, #7B68EE)';
            } else {
                message = 'ğŸ’ª ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”!';
                circleColor = 'linear-gradient(45deg, #ff9800, #f57c00)';
            }

            document.getElementById('result-message').textContent = message;
            document.getElementById('score-circle').style.background = circleColor;
        }

        // ì±•í„° ë‹¤ì‹œ í’€ê¸°
        function retryChapter() {
            startLearning(currentChapterIndex);
        }

        // ë‹¤ìŒ ì±•í„°
        function nextChapter() {
            if (currentChapterIndex + 1 < bookData.chapterList.length) {
                if (bookData.chapterList[currentChapterIndex + 1].status !== 'locked') {
                    startLearning(currentChapterIndex + 1);
                } else {
                    showBookDetail();
                }
            } else {
                showBookDetail();
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', function() {
            showBookDetail();
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('learning-screen').style.display === 'block') {
                if (e.key === 'ArrowLeft') {
                    previousQuestion();
                } else if (e.key === 'ArrowRight') {
                    nextQuestion();
                } else if (e.key >= '1' && e.key <= '4') {
                    const index = parseInt(e.key) - 1;
                    if (index < questions[currentQuestionIndex]?.options.length) {
                        selectOption(index);
                    }
                }
            }

            if (e.key === 'Escape') {
                closeAudioModal();
            }
        });

        // ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', function() {
            const audioPlayer = document.getElementById('audio-player');

            audioPlayer.addEventListener('play', function() {
                document.querySelector('.play-pause-btn').textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
            });

            audioPlayer.addEventListener('pause', function() {
                document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
            });

            audioPlayer.addEventListener('ended', function() {
                document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
            });
        });
    </script>
</body>
</html>