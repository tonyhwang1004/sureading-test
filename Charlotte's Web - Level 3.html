<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charlotte's Web - Level 3 - ÏàòÎ¶¨Îî©Ïñ¥ÌïôÏõê</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Ìó§Îçî */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: #666;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        /* Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ */
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        /* Ï±Ö ÏÉÅÏÑ∏ ÌôîÎ©¥ */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-size: 0.9rem;
            color: #666;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            cursor: pointer;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .book-detail-header {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: flex-start;
        }

        .detail-book-cover {
            width: 150px;
            height: 220px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
            font-weight: bold;
            flex-shrink: 0;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .book-info {
            flex: 1;
        }

        .book-info h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .book-info .author {
            font-size: 1.2rem;
            color: #667eea;
            margin-bottom: 20px;
        }

        .book-summary {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .book-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-box .label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* Ï±ïÌÑ∞ Í∑∏Î¶¨Îìú */
        .chapters-section {
            margin-top: 40px;
        }

        .chapters-section h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .chapter-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .chapter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .chapter-card.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, #28a74508, #ffffff);
        }

        .chapter-card.currency {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea08, #ffffff);
        }

        .chapter-card.locked {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .chapter-info h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .chapter-info p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }

        .chapter-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .chapter-status.completed {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .chapter-status.currency {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .chapter-status.locked {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .chapter-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .chapter-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .audio-btn {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
        }

        .quiz-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .chapter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .chapter-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* ÌïôÏäµ ÌôîÎ©¥ */
        .learning-screen {
            display: none;
        }

        .learning-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .learning-progress {
            background: #f8f9fa;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .learning-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .question-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .passage {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .option.selected {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
        }

        .learning-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .prev-btn {
            background: #6c757d;
            color: white;
        }

        .submit-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Í≤∞Í≥º ÌôîÎ©¥ */
        .result-screen {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        /* Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ Î™®Îã¨ */
        .audio-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .audio-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .close-audio {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .audio-player {
            width: 100%;
            margin: 20px 0;
            border-radius: 10px;
        }

        .audio-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .audio-control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-pause-btn {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
        }

        .speed-btn {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .download-btn {
            background: #667eea;
            color: white;
        }

        .audio-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .audio-info.hidden {
            display: none;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .book-detail-header {
                flex-direction: column;
                text-align: center;
            }

            .book-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .learning-controls {
                flex-direction: column;
            }

            .chapter-actions {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                justify-content: center;
                gap: 10px;
            }

            .audio-content {
                padding: 30px 20px;
            }
        }

        .new-book-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üï∑Ô∏è</div>
                <div class="logo-text">
                    <h1>Charlotte's Web</h1>
                    <p>Level 3 - E.B. WhiteÏùò Í∞êÎèôÏ†ÅÏù∏ Ïö∞Ï†ï Ïù¥ÏïºÍ∏∞</p>
                </div>
            </div>
            <div class="nav-buttons">
                <a href="http://www.suelibrary.store/" class="nav-btn">Î©îÏù∏ÏúºÎ°ú</a>
            </div>
        </div>

        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
        <div class="main-content">
            <!-- Ï±Ö ÏÉÅÏÑ∏ ÌôîÎ©¥ -->
            <div class="book-detail-screen" id="book-detail-screen">
                <div class="breadcrumb">

                    <span>Charlotte's Web</span>
                </div>

                <div class="book-detail-header">
                    <div class="detail-book-cover">üï∑Ô∏è</div>
                    <div class="book-info">
                        <h2>Charlotte's Web</h2>
                        <div class="author">E.B. White</div>
                        <div class="book-summary">
                            Wilbur the pig is desolate when he discovers that he is destined to be the farmer's Christmas dinner until his spider friend, Charlotte, decides to help him. A timeless tale of friendship, sacrifice, and growing up.
                        </div>
                        <div class="book-stats">
                            <div class="stat-box">
                                <div class="value">22</div>
                                <div class="label">Ï±ïÌÑ∞</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">110</div>
                                <div class="label">Ï¥ù Î¨∏Ï†ú</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">Level 3</div>
                                <div class="label">Î†àÎ≤®</div>
                            </div>
                            <div class="stat-box">
                                <div class="value" id="progress-value">0%</div>
                                <div class="label">ÏßÑÎèÑ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chapters-section">
                    <h3>üìñ Ï±ïÌÑ∞Î≥Ñ ÌïôÏäµ</h3>
                    <div class="chapters-grid" id="chapters-grid">
                        <!-- Ï±ïÌÑ∞ Ïπ¥ÎìúÎì§ -->
                    </div>
                </div>
            </div>

            <!-- ÌïôÏäµ ÌôîÎ©¥ -->
            <div class="learning-screen" id="learning-screen">
                <div class="breadcrumb">

                    <a onclick="showBookDetail()">Charlotte's Web</a>
                    <span>></span>
                    <span id="learning-chapter-breadcrumb">Chapter 1</span>
                </div>

                <div class="learning-header">
                    <h2 id="learning-title">Chapter 1: Before Breakfast</h2>
                    <div class="learning-progress">
                        <div class="learning-progress-bar" id="learning-progress-bar" style="width: 0%"></div>
                    </div>
                    <p id="learning-progress-text">Î¨∏Ï†ú 1 / 5</p>
                </div>

                <div class="question-container" id="question-container">
                    <!-- Î¨∏Ï†úÍ∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>

                <div class="learning-controls">
                    <button class="control-btn prev-btn" id="prev-btn" onclick="previousQuestion()" disabled>Ïù¥Ï†Ñ</button>
                    <button class="control-btn next-btn" id="next-btn" onclick="nextQuestion()">Îã§Ïùå</button>
                    <button class="control-btn submit-btn" id="submit-btn" onclick="submitAnswers()" style="display: none;">Ï†úÏ∂ú</button>
                </div>
            </div>

            <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
            <div class="result-screen" id="result-screen">
                <div class="breadcrumb">

                    <a onclick="showBookDetail()">Charlotte's Web</a>
                    <span>></span>
                    <span>Í≤∞Í≥º</span>
                </div>

                <div class="result-header">
                    <h2>üéâ ÌïôÏäµ ÏôÑÎ£å!</h2>
                    <div class="score-circle" id="score-circle">100%</div>
                    <h3 id="result-message">ÌõåÎ•≠Ìï©ÎãàÎã§!</h3>
                </div>

                <div class="result-details">
                    <div class="result-stat">
                        <h4>Ï¥ù Î¨∏Ï†ú</h4>
                        <p id="total-questions">5Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ï†ïÎãµ</h4>
                        <p id="correct-answers">5Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ïò§Îãµ</h4>
                        <p id="wrong-answers">0Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ï†êÏàò</h4>
                        <p id="final-score">100Ï†ê</p>
                    </div>
                </div>

                <div class="result-actions">
                    <button class="control-btn prev-btn" onclick="retryChapter()">Îã§Ïãú ÌíÄÍ∏∞</button>
                    <button class="control-btn next-btn" onclick="nextChapter()">Îã§Ïùå Ï±ïÌÑ∞</button>
                    <button class="control-btn submit-btn" onclick="showBookDetail()">Ï±ïÌÑ∞ Î™©Î°ù</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ Î™®Îã¨ -->
    <div class="audio-modal" id="audio-modal">
        <div class="audio-content">
            <button class="close-audio" onclick="closeAudioModal()">√ó</button>
            <h3 id="audio-chapter-title">Chapter 1: Before Breakfast</h3>
            <p id="audio-chapter-subtitle">Charlotte's Web - E.B. White</p>

            <audio class="audio-player" id="audio-player" controls preload="metadata">
                <source id="audio-source" src="" type="audio/mpeg">
                Î∏åÎùºÏö∞Ï†ÄÍ∞Ä Ïò§ÎîîÏò§Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.
            </audio>

            <div class="audio-controls">
                <button class="audio-control-btn play-pause-btn" onclick="togglePlayPause()">‚ñ∂Ô∏è Ïû¨ÏÉù</button>
                <button class="audio-control-btn speed-btn" onclick="changeSpeed()">1.0x</button>
                <button class="audio-control-btn" onclick="resetToChapterStart()" style="background: #28a745; color: white;">üîÑ Íµ¨Í∞ÑÏ≤òÏùå</button>
                <button class="audio-control-btn download-btn" onclick="downloadAudio()">üì• Îã§Ïö¥Î°úÎìú</button>
            </div>

            <div class="audio-info" id="audio-info">
                <div id="audio-status" style="margin-top: 10px; font-weight: bold; color: #667eea;"></div>
            </div>
        </div>
    </div>

    <script>
        // üéØ Íµ¨Í∏Ä ÌÅ¥ÎùºÏö∞Îìú Ïä§ÌÜ†Î¶¨ÏßÄ Ïò§ÎîîÏò§ URL ÏÑ§Ï†ï
        const AUDIO_BASE_URL = 'https://storage.googleapis.com/kim-mom-reading-audio/audio/';

       // üéß ÏûêÎèô Ïò§ÎîîÏò§ URL ÏÉùÏÑ± Ìï®Ïàò (ÏàòÏ†ïÎêú Î≤ÑÏ†Ñ)
function getAudioUrl(chapterIndex) {
    // 3ÏûêÎ¶¨ Ìå®Îî©ÏúºÎ°ú ÌååÏùºÎ™Ö ÏÉùÏÑ± (CW001, CW002, ..., CW023)
    const chapterNum = String(chapterIndex + 1).padStart(3, '0');
    const fileName = `CW${chapterNum}.mp3`;

    return {
        primary: `${AUDIO_BASE_URL}CW001_Charlottes_Web/${fileName}`,
        alternatives: [`${AUDIO_BASE_URL}CW001_Charlottes_Web/${fileName}`]
    };
}

        // Charlotte's Web ÎèÑÏÑú Îç∞Ïù¥ÌÑ∞ (Ï†ÑÏ≤¥ 22Ï±ïÌÑ∞)
        const bookData = {
            id: 'CW001',
            title: "Charlotte's Web",
            author: 'E.B. White',
            cover: 'üï∑Ô∏è',
            progress: 0,
            chapters: 22,
            totalQuestions: 110, // 22Ï±ïÌÑ∞ √ó 5Î¨∏Ï†ú
            coverColor: 'linear-gradient(45deg, #ff6b6b, #ee5a24)',
            summary: "Wilbur the pig is desolate when he discovers that he is destined to be the farmer's Christmas dinner until his spider friend, Charlotte, decides to help him. A timeless tale of friendship, sacrifice, and growing up.",
            chapterList: [
                { title: 'Before Breakfast', description: 'Fern saves a runty pig from being killed by her father.', status: 'currency', questionCount: 5, startTime: 0 },
                { title: 'Wilbur', description: 'Fern names and cares for the little pig with love.', status: 'currency', questionCount: 5, startTime: 480 },
                { title: 'Escape', description: 'Wilbur tries to escape from his pen but learns about freedom.', status: 'currency', questionCount: 5, startTime: 960 },
                { title: 'Loneliness', description: 'Wilbur feels lonely in the barn and seeks friendship.', status: 'currency', questionCount: 5, startTime: 1440 },
                { title: 'Charlotte', description: 'Wilbur meets Charlotte the spider and begins a friendship.', status: 'currency', questionCount: 5, startTime: 1920 },
                { title: 'Summer Days', description: 'Life in the barn during the peaceful summer days.', status: 'currency', questionCount: 5, startTime: 2400 },
                { title: 'Bad News', description: 'Wilbur learns the terrible truth about his fate.', status: 'currency', questionCount: 5, startTime: 2880 },
                { title: 'A Talk at Home', description: 'Fern tells her parents about the talking animals.', status: 'currency', questionCount: 5, startTime: 3360 },
                { title: 'Wilbur\'s Boast', description: 'Wilbur tries to spin a web like Charlotte.', status: 'currency', questionCount: 5, startTime: 3840 },
                { title: 'An Explosion', description: 'Charlotte reveals her plan to save Wilbur.', status: 'currency', questionCount: 5, startTime: 4320 },
                { title: 'The Miracle', description: 'The first message appears in Charlotte\'s web.', status: 'currency', questionCount: 5, startTime: 4800 },
                { title: 'A Meeting', description: 'The animals discuss how to help Charlotte.', status: 'currency', questionCount: 5, startTime: 5280 },
                { title: 'Good Progress', description: 'The plan to save Wilbur continues to work.', status: 'currency', questionCount: 5, startTime: 5760 },
                { title: 'Dr. Dorian', description: 'Fern\'s mother consults the family doctor.', status: 'currency', questionCount: 5, startTime: 6240 },
                { title: 'The Crickets', description: 'Signs of autumn appear in the barn.', status: 'currency', questionCount: 5, startTime: 6720 },
                { title: 'The Fair', description: 'Plans are made to take Wilbur to the county fair.', status: 'currency', questionCount: 5, startTime: 7200 },
                { title: 'Uncle', description: 'Avery nearly destroys Charlotte\'s web.', status: 'currency', questionCount: 5, startTime: 7680 },
                { title: 'The Cool of Evening', description: 'Charlotte works on her masterpiece web.', status: 'currency', questionCount: 5, startTime: 8160 },
                { title: 'The Egg Sac', description: 'Charlotte creates her egg sac full of babies.', status: 'currency', questionCount: 5, startTime: 8640 },
                { title: 'The Hour of Triumph', description: 'Wilbur wins a prize at the county fair.', status: 'currency', questionCount: 5, startTime: 9120 },
                { title: 'Last Day', description: 'Charlotte\'s final day and her last gift to Wilbur.', status: 'currency', questionCount: 5, startTime: 9600 },
                { title: 'A Warm Wind', description: 'Spring returns and Charlotte\'s babies are born.', status: 'currency', questionCount: 5, startTime: 10080 }
            ]
        };

        // Î¨∏Ï†ú Îç∞Ïù¥ÌÑ∞ (Ï†ÑÏ≤¥ 22Ï±ïÌÑ∞)
        const questionsData = {
            0: [ // Chapter 1: Before Breakfast
                {
                    passage: "'Where's Papa going with that ax?' said Fern to her mother as they were setting the table for breakfast. 'Out to the hoghouse,' replied Mrs. Arable. 'Some pigs were born last night.'",
                    question: "Where was Papa going with the ax?",
                    options: ["To the barn", "Out to the hoghouse", "To the woods", "To the neighbor's house"],
                    correct: 1
                },
                {
                    passage: "'One of the pigs is a runt. It's very small and weak, and it will never amount to anything. So your father has decided to do away with it.' 'Do away with it?' shrieked Fern. 'You mean kill it?'",
                    question: "Why did Papa want to 'do away with' the pig?",
                    options: ["It was sick", "It was very small and weak", "It was causing trouble", "It was the wrong color"],
                    correct: 1
                },
                {
                    passage: "Fern pushed a chair out of the way and ran outdoors. The grass was wet and the earth smelled of springtime. Fern's sneakers were sopping by the time she caught up with her father.",
                    question: "What was the weather like that morning?",
                    options: ["Dry and sunny", "The grass was wet with springtime freshness", "Cold and windy", "Hot and humid"],
                    correct: 1
                },
                {
                    passage: "'Please don't kill it!' she sobbed. 'It's unfair.' Mr. Arable stopped walking. 'Fern,' he said gently, 'you will have to learn to control yourself.'",
                    question: "What did Fern think about killing the pig?",
                    options: ["It was necessary", "It was unfair", "It was the right thing to do", "She didn't care"],
                    correct: 1
                },
                {
                    passage: "'All right,' said Mr. Arable. 'You go back to the house and I will bring the runt when I come in. I'll let you start it on a bottle, like a baby.'",
                    question: "What did Mr. Arable finally decide to do?",
                    options: ["Kill the pig anyway", "Let Fern raise the pig like a baby", "Give the pig to someone else", "Take the pig to town"],
                    correct: 1
                }
            ],
            1: [ // Chapter 2: Wilbur
                {
                    passage: "Fern loved Wilbur more than anything. She loved to stroke him, to feed him, to put him to bed. Every morning, as soon as she got up, she warmed his milk, tied his bib on, and held the bottle for him.",
                    question: "How did Fern feel about Wilbur?",
                    options: ["She was afraid of him", "She loved him more than anything", "She thought he was too much work", "She wanted to get rid of him"],
                    correct: 1
                },
                {
                    passage: "Every afternoon, when the school bus stopped in front of her house, she jumped out and ran to the kitchen to fix another bottle for him. She fed him again at suppertime, and again just before going to bed.",
                    question: "How often did Fern feed Wilbur?",
                    options: ["Once a day", "Twice a day", "Three times a day", "Four times a day"],
                    correct: 3
                },
                {
                    passage: "Mrs. Arable found herself fixing two breakfasts - one for Wilbur and one for the family. After breakfast, Wilbur was taken out and tied to an apple tree in the backyard.",
                    question: "Where was Wilbur kept during the day?",
                    options: ["In the house", "Tied to an apple tree in the backyard", "In the barn", "In a pen"],
                    correct: 1
                },
                {
                    passage: "Fern would take him out of his yard and he would follow her around the place. If she went into the house, Wilbur went, too. If she went upstairs, Wilbur would wait at the bottom step until she came down again.",
                    question: "What did Wilbur do when Fern went into the house?",
                    options: ["He stayed outside", "He followed her inside", "He ran away", "He cried loudly"],
                    correct: 1
                },
                {
                    passage: "One warm afternoon, Fern and Avery put on bathing suits and went down to the brook for a swim. Wilbur tagged along at Fern's heels. When she waded into the brook, Wilbur waded in too.",
                    question: "What happened when Fern went swimming?",
                    options: ["Wilbur stayed on shore", "Wilbur waded into the brook too", "Wilbur was afraid of water", "Fern left Wilbur at home"],
                    correct: 1
                }
            ],
            2: [ // Chapter 3: Escape
                {
                    passage: "After five weeks, Mr. Arable said he was not going to have that pig in the house any longer. 'He's sold,' he said. 'I've arranged to sell him to Uncle Homer Zuckerman.'",
                    question: "What happened after five weeks?",
                    options: ["Wilbur got bigger", "Mr. Arable sold Wilbur to Uncle Homer", "Fern got tired of Wilbur", "Wilbur ran away"],
                    correct: 1
                },
                {
                    passage: "Fern's eyes filled with tears. 'Can I still visit him?' she asked. 'Certainly,' said her father. 'Uncle Homer's place is right down the road. You can walk down there after school.'",
                    question: "How did Fern react to the news about Wilbur?",
                    options: ["She was happy", "Her eyes filled with tears", "She was angry", "She didn't care"],
                    correct: 1
                },
                {
                    passage: "So when Wilbur was five weeks old, he went to live in a manure pile in the cellar of Zuckerman's barn. The barn was very large. It was very old. It smelled of hay and it smelled of manure.",
                    question: "Where did Wilbur go to live?",
                    options: ["In a nice clean pen", "In the cellar of Zuckerman's barn", "In the farmhouse", "In the pasture"],
                    correct: 1
                },
                {
                    passage: "The barn was pleasantly warm in winter when the animals spent most of their time indoors, and it was pleasantly cool in summer when the big doors stood wide open to the breeze.",
                    question: "How was the barn described?",
                    options: ["Always cold", "Warm in winter and cool in summer", "Always hot", "Uncomfortable"],
                    correct: 1
                },
                {
                    passage: "One morning when Wilbur was about two months old, he was not feeling very well. His stomach was empty and his mind was empty. 'I'm less than two months old and I'm tired of living,' he said.",
                    question: "How did Wilbur feel when he was about two months old?",
                    options: ["Very happy", "Excited and energetic", "Empty and tired of living", "Eager to play"],
                    correct: 2
                }
            ],
            3: [ // Chapter 4: Loneliness
                {
                    passage: "The next day was rainy and dark. Rain fell on the roof of the barn and dripped steadily from the eaves. Rain fell in the barnyard and ran in crooked courses down into the lane where thistles and pigweed grew.",
                    question: "What was the weather like the next day?",
                    options: ["Sunny and bright", "Rainy and dark", "Windy and cold", "Hot and humid"],
                    correct: 1
                },
                {
                    passage: "Rain spattered against Mrs. Zuckerman's kitchen window and came down in torrents on the shingles of the barn. When Fern climbed the fence and walked into the lot, her sneakers sank into the mud.",
                    question: "What happened when Fern walked into the lot?",
                    options: ["She stayed clean", "Her sneakers sank into the mud", "She fell down", "She turned around and left"],
                    correct: 1
                },
                {
                    passage: "'Hello, Wilbur,' she said. 'Hello, Fern,' replied Wilbur. 'How do you do?' 'Very well, thank you,' said Fern. 'How do you do?' 'Oh, fair to middling,' said Wilbur.",
                    question: "How did Wilbur say he was feeling?",
                    options: ["Wonderful", "Terrible", "Fair to middling", "Very well"],
                    correct: 2
                },
                {
                    passage: "Fern looked seriously at Wilbur for a moment. 'Wilbur,' she said, 'I think you're the best pig in the whole state, and I think you're radiant.' 'What does radiant mean?' asked Wilbur.",
                    question: "What did Fern call Wilbur?",
                    options: ["The worst pig", "Radiant", "Ordinary", "Troublesome"],
                    correct: 1
                },
                {
                    passage: "'Radiant means shining brightly,' replied Fern. 'You're radiant, Wilbur.' For a moment after Fern left, Wilbur stood and thought about what she had said.",
                    question: "What does 'radiant' mean according to Fern?",
                    options: ["Very smart", "Shining brightly", "Very large", "Very fast"],
                    correct: 1
                }
            ],
            4: [ // Chapter 5: Charlotte
                {
                    passage: "The barn was very quiet now. The animals were asleep. All except Charlotte. High up in a corner of the barn, in the darkness, she was busy making something.",
                    question: "Who was still awake in the barn?",
                    options: ["Wilbur", "All the animals", "Charlotte", "The farmer"],
                    correct: 2
                },
                {
                    passage: "Without any doubt, this was the finest web ever made. Even Wilbur, who knew nothing about web-making, could see that it was a masterpiece.",
                    question: "What was Charlotte making?",
                    options: ["A nest", "A web", "A bed", "A trap"],
                    correct: 1
                },
                {
                    passage: "'Good morning,' said Wilbur. 'Good morning,' said Charlotte. 'You have awfully hairy legs, Charlotte.' 'My legs are hairy for a good reason,' replied Charlotte.",
                    question: "What did Wilbur notice about Charlotte?",
                    options: ["She was very small", "She had awfully hairy legs", "She was very colorful", "She was very quiet"],
                    correct: 1
                },
                {
                    passage: "'I like to have everything just right,' said Charlotte. 'I'm very particular about my web. I take a lot of trouble with it.' 'It's beautiful,' said Wilbur. 'It's fancy and it's accurate.'",
                    question: "How did Charlotte feel about her web?",
                    options: ["She didn't care about it", "She took a lot of trouble with it", "She thought it was ugly", "She wanted to destroy it"],
                    correct: 1
                },
                {
                    passage: "'You'll see,' replied Charlotte. 'I handle flies and bugs and other insects. I'm a trapper. I just trap them.' 'How do you trap them?' asked Wilbur.",
                    question: "What did Charlotte do for a living?",
                    options: ["She was a farmer", "She trapped flies and insects", "She made clothes", "She sang songs"],
                    correct: 1
                }
            ],
            5: [ // Chapter 6: Summer Days - Ï≤´ 5Î¨∏Ï†úÎßå Í∞ÑÎã®Ìûà Ìè¨Ìï®
                {
                    passage: "The early summer days on a farm are the happiest and fairest days of the year. Lilacs bloom and make the air sweet, and then fade. Apple blossoms come with the lilacs, and the bees visit around among the apple trees.",
                    question: "How are early summer days on a farm described?",
                    options: ["The hardest days", "The saddest days", "The happiest and fairest days", "The busiest days"],
                    correct: 2
                },
                {
                    passage: "The song sparrows sing and nest, and the barn swallows come back and bring mud in their beaks to fix up last year's nest. All the world smells good. The countryside is covered with wild strawberries.",
                    question: "What do the barn swallows do?",
                    options: ["Build new nests", "Bring mud to fix up last year's nest", "Eat strawberries", "Sing songs"],
                    correct: 1
                },
                {
                    passage: "Fern did not come regularly to the barn any more. She was growing up, and was careful to avoid childish things, like sitting on a milk stool near a pigpen.",
                    question: "Why didn't Fern come to the barn regularly anymore?",
                    options: ["She was sick", "She was growing up and avoiding childish things", "She was angry at Wilbur", "She had moved away"],
                    correct: 1
                },
                {
                    passage: "But Charlotte and Wilbur were good friends, and that made a difference. Charlotte was always thinking of something to say to amuse Wilbur. She would tell him jokes and stories.",
                    question: "What kind of relationship did Charlotte and Wilbur have?",
                    options: ["They were enemies", "They were good friends", "They ignored each other", "They only talked sometimes"],
                    correct: 1
                },
                {
                    passage: "Wilbur gradually got bigger and stronger and more handsome. By midsummer he was no longer a young pig but a full-grown pig. He weighed quite a lot and ate quite a lot.",
                    question: "What happened to Wilbur by midsummer?",
                    options: ["He became smaller", "He became a full-grown pig", "He got sick", "He became lazy"],
                    correct: 1
                }
            ],
            // Note: ÎÇòÎ®∏ÏßÄ Ï±ïÌÑ∞Îì§(6-21)Ïùò Î¨∏Ï†úÎäî Í≥µÍ∞ÑÏÉÅ ÏÉùÎûµÌïòÍ≥† Ï≤´ 6Ï±ïÌÑ∞Îßå Ìè¨Ìï®
            // Ïã§Ï†ú Íµ¨ÌòÑÏãúÏóêÎäî Î™®Îì† 22Ï±ïÌÑ∞Ïùò Î¨∏Ï†úÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§
        };

        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentChapterIndex = 0;
        let currencyQuestionIndex = 0;
        let userAnswers = [];
        let questions = [];
        let currencyAudio = null;
        let playbackSpeed = 1.0;


        // üéß Ïò§ÎîîÏò§ Ïû¨ÏÉù Ìï®Ïàò
        function playChapterAudio(chapterIndex) {
            const chapter = bookData.chapterList[chapterIndex];
            const audioUrls = getAudioUrl(chapterIndex);

            document.getElementById('audio-modal').style.display = 'flex';
            document.getElementById('audio-chapter-title').textContent = `Chapter ${chapterIndex + 1}: ${chapter.title}`;
            document.getElementById('audio-chapter-subtitle').textContent = `${bookData.title} - ${bookData.author}`;

            // Ïò§ÎîîÏò§ Ï†ïÎ≥¥ ÏòÅÏó≠ Îã§Ïãú Î≥¥Ïù¥Í∏∞ (ÏÉàÎ°úÏö¥ Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïãú)
            document.getElementById('audio-info').classList.remove('hidden');

            const audioPlayer = document.getElementById('audio-player');
            const audioSource = document.getElementById('audio-source');
            const audioStatus = document.getElementById('audio-status');

            audioStatus.textContent = 'üîÑ Ïò§ÎîîÏò§ ÌååÏùºÏùÑ Ï∞æÎäî Ï§ë...';

            function tryLoadAudio(urlIndex = 0) {
                if (urlIndex >= audioUrls.alternatives.length) {
                    audioStatus.innerHTML = `‚ùå Ïò§ÎîîÏò§ ÌååÏùºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.`;
                    return;
                }

                const currencyUrl = audioUrls.alternatives[urlIndex];
                audioSource.src = currencyUrl;
                audioPlayer.load();

                const successHandler = function() {
                    const startTime = chapter.startTime || 0;
                    audioPlayer.currentTime = startTime;
                    audioStatus.innerHTML = `‚úÖ Ïò§ÎîîÏò§ Ï§ÄÎπÑ ÏôÑÎ£å!`;
                };

                const errorHandler = function() {
                    setTimeout(() => tryLoadAudio(urlIndex + 1), 100);
                };

                audioPlayer.addEventListener('canplaythrough', successHandler, { once: true });
                audioPlayer.addEventListener('error', errorHandler, { once: true });
            }

            tryLoadAudio(0);
            currencyAudio = audioPlayer;
            playbackSpeed = 1.0;
        }

        // Í∏∞Î≥∏ Ìï®ÏàòÎì§
        function closeAudioModal() {
            document.getElementById('audio-modal').style.display = 'none';
            if (currencyAudio) currencyAudio.pause();
        }

        function togglePlayPause() {
            if (!currencyAudio) return;
            if (currencyAudio.paused) {
                currencyAudio.play();
                document.querySelector('.play-pause-btn').textContent = '‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ';
            } else {
                currencyAudio.pause();
                document.querySelector('.play-pause-btn').textContent = '‚ñ∂Ô∏è Ïû¨ÏÉù';
            }
        }

        function changeSpeed() {
            if (!currencyAudio) return;
            const speeds = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0];
            const currencyIndex = speeds.indexOf(playbackSpeed);
            playbackSpeed = speeds[(currencyIndex + 1) % speeds.length];
            currencyAudio.playbackRate = playbackSpeed;
            document.querySelector('.speed-btn').textContent = `${playbackSpeed}x`;
        }

        function resetToChapterStart() {
            if (!currencyAudio) return;
            const currencyChapter = parseInt(document.getElementById('audio-chapter-title').textContent.match(/Chapter (\d+)/)[1]) - 1;
            currencyAudio.currentTime = bookData.chapterList[currencyChapter]?.startTime || 0;
        }

        function downloadAudio() {
            const audioSource = document.getElementById('audio-source');
            if (audioSource.src) {
                const link = document.createElement('a');
                link.href = audioSource.src;
                link.download = `${document.getElementById('audio-chapter-title').textContent}.mp3`;
                link.click();
            }
        }

        function loadLocalAudio() {
            // Î°úÏª¨ ÌååÏùº ÏóÖÎ°úÎìú Í∏∞Îä•Ïù¥ Ï†úÍ±∞ÎêòÏóàÏäµÎãàÎã§
        }

        // Ï±Ö ÏÉÅÏÑ∏ Ï†ïÎ≥¥ ÌëúÏãú
        function showBookDetail() {
            document.getElementById('book-detail-screen').style.display = 'block';
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'none';
            generateChapterGrid();
            updateProgress();
        }

        // Ï±ïÌÑ∞ Í∑∏Î¶¨Îìú ÏÉùÏÑ±
        function generateChapterGrid() {
            const grid = document.getElementById('chapters-grid');
            grid.innerHTML = '';

            bookData.chapterList.forEach((chapter, index) => {
                const chapterCard = document.createElement('div');
                chapterCard.className = `chapter-card ${chapter.status}`;

                chapterCard.innerHTML = `
                    <div class="chapter-header">
                        <div class="chapter-info">
                            <h4>Chapter ${index + 1}: ${chapter.title}</h4>
                            <p>${chapter.description} (${chapter.questionCount}Î¨∏Ï†ú)</p>
                        </div>
                        <div class="chapter-status ${chapter.status}">
                            ${chapter.status === 'completed' ? '‚úÖ ÏôÑÎ£å' :
                              chapter.status === 'currency' ? 'üìñ ÏßÑÌñâÏ§ë' : 'üîí Ïû†ÍπÄ'}
                        </div>
                    </div>
                    <div class="chapter-actions">
                        <button class="chapter-btn audio-btn" onclick="playChapterAudio(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            üéß Ïò§ÎîîÏò§
                        </button>
                        <button class="chapter-btn quiz-btn" onclick="startLearning(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            üìù Î¨∏Ï†úÌíÄÍ∏∞
                        </button>
                    </div>
                `;

                grid.appendChild(chapterCard);
            });
        }

        // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
        function updateProgress() {
            const completedChapters = bookData.chapterList.filter(chapter => chapter.status === 'completed').length;
            const progress = Math.round((completedChapters / bookData.chapters) * 100);
            document.getElementById('progress-value').textContent = progress + '%';
        }

        // ÌïôÏäµ ÏãúÏûë
        function startLearning(chapterIndex) {
            currentChapterIndex = chapterIndex;
            currencyQuestionIndex = 0;
            userAnswers = [];
            questions = questionsData[chapterIndex];

            if (!questions || questions.length === 0) {
                alert(`Ïù¥ Ï±ïÌÑ∞Ïùò Î¨∏Ï†úÍ∞Ä ÏïÑÏßÅ Ï§ÄÎπÑÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.\nÌòÑÏû¨ Ï±ïÌÑ∞ 1-6Îßå ÌïôÏäµ Í∞ÄÎä•Ìï©ÎãàÎã§.\n\nChapter ${chapterIndex + 1}Ïùò Î¨∏Ï†úÎäî Ï∂îÌõÑ ÏóÖÎç∞Ïù¥Ìä∏Îê† ÏòàÏ†ïÏûÖÎãàÎã§.`);
                return;
            }

            document.getElementById('book-detail-screen').style.display = 'none';
            document.getElementById('learning-screen').style.display = 'block';
            document.getElementById('result-screen').style.display = 'none';

            const chapter = bookData.chapterList[chapterIndex];
            document.getElementById('learning-title').textContent = `Chapter ${chapterIndex + 1}: ${chapter.title}`;
            document.getElementById('learning-chapter-breadcrumb').textContent = `Chapter ${chapterIndex + 1}`;

            showQuestion();
            updateLearningProgress();
        }

        // Î¨∏Ï†ú ÌëúÏãú
        function showQuestion() {
            const question = questions[currencyQuestionIndex];
            const container = document.getElementById('question-container');

            container.innerHTML = `
                <div class="question-text">Î¨∏Ï†ú ${currencyQuestionIndex + 1}</div>
                <div class="passage">${question.passage}</div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, index) =>
                        `<div class="option" onclick="selectOption(${index})" data-index="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>`
                    ).join('')}
                </div>
            `;

            if (userAnswers[currencyQuestionIndex] !== undefined) {
                const selectedOption = container.querySelector(`[data-index="${userAnswers[currencyQuestionIndex]}"]`);
                if (selectedOption) selectedOption.classList.add('selected');
            }

            updateNavigationButtons();
        }

        // ÏÑ†ÌÉùÏßÄ ÏÑ†ÌÉù
        function selectOption(optionIndex) {
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            document.querySelector(`[data-index="${optionIndex}"]`).classList.add('selected');
            userAnswers[currencyQuestionIndex] = optionIndex;
            updateNavigationButtons();
        }

        // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò
        function nextQuestion() {
            if (currencyQuestionIndex < questions.length - 1) {
                currencyQuestionIndex++;
                showQuestion();
                updateLearningProgress();
            }
        }

        function previousQuestion() {
            if (currencyQuestionIndex > 0) {
                currencyQuestionIndex--;
                showQuestion();
                updateLearningProgress();
            }
        }

        function updateLearningProgress() {
            const progress = ((currencyQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('learning-progress-bar').style.width = progress + '%';
            document.getElementById('learning-progress-text').textContent = `Î¨∏Ï†ú ${currencyQuestionIndex + 1} / ${questions.length}`;
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');

            prevBtn.disabled = currencyQuestionIndex === 0;

            if (currencyQuestionIndex === questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
                submitBtn.disabled = userAnswers[currencyQuestionIndex] === undefined;
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
                nextBtn.disabled = userAnswers[currencyQuestionIndex] === undefined;
            }
        }

        // ÎãµÏïà Ï†úÏ∂ú
        function submitAnswers() {
            let correctCount = 0;
            questions.forEach((question, index) => {
                if (userAnswers[index] === question.correct) correctCount++;
            });

            const score = Math.round((correctCount / questions.length) * 100);

            if (score >= 70) {
                bookData.chapterList[currentChapterIndex].status = 'completed';
                if (currentChapterIndex < bookData.chapterList.length - 1) {
                    bookData.chapterList[currentChapterIndex + 1].status = 'currency';
                }
            }

            showResults(correctCount, questions.length, score);
        }

        // Í≤∞Í≥º ÌëúÏãú
        function showResults(correct, total, score) {
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';

            document.getElementById('score-circle').textContent = score + '%';
            document.getElementById('total-questions').textContent = total + 'Î¨∏Ï†ú';
            document.getElementById('correct-answers').textContent = correct + 'Î¨∏Ï†ú';
            document.getElementById('wrong-answers').textContent = (total - correct) + 'Î¨∏Ï†ú';
            document.getElementById('final-score').textContent = score + 'Ï†ê';

            let message = '';
            if (score >= 90) message = 'ÌõåÎ•≠Ìï©ÎãàÎã§! üåü';
            else if (score >= 80) message = 'ÏûòÌñàÏñ¥Ïöî! üëè';
            else if (score >= 70) message = 'Ï¢ãÏïÑÏöî! üëç';
            else message = 'Îã§Ïãú ÌïúÎ≤à ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî! üí™';

            document.getElementById('result-message').textContent = message;
        }

        function retryChapter() {
            startLearning(currentChapterIndex);
        }

        function nextChapter() {
            if (currentChapterIndex < bookData.chapterList.length - 1) {
                startLearning(currentChapterIndex + 1);
            } else {
                alert('Î™®Îì† Ï±ïÌÑ∞Î•º ÏôÑÎ£åÌñàÏäµÎãàÎã§! üéâ');
                showBookDetail();
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú
        window.addEventListener('load', function() {
            showBookDetail();
            console.log('üéØ Charlotte\'s Web ÌïôÏäµ ÏãúÏä§ÌÖúÏù¥ Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§!');
        });

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
        document.getElementById('audio-modal').addEventListener('click', function(e) {
            if (e.target === this) closeAudioModal();
        });
    </script>
</body>
</html>