<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ë¦¬ë”©ì–´í•™ì› - ë¯¸ë˜ì˜ ì˜ì–´í•™ìŠµ</title>
    <style>
        /* ================ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ================ ë™ì  ë°°ê²½ íš¨ê³¼ ================ */
        .dynamic-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: radial-gradient(circle at center, #1a1a2e, #0f0f0f);
        }

        /* ë– ë‹¤ë‹ˆëŠ” í…ìŠ¤íŠ¸ íš¨ê³¼ */
        .floating-text {
            position: fixed;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(45deg, #fff, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            pointer-events: none;
            z-index: 10;
            opacity: 0.3;
            animation: floatAround 20s ease-in-out infinite;
        }

        @keyframes floatAround {
            0% { transform: translate(5vw, 15vh) rotate(0deg) scale(0.8); opacity: 0.2; }
            20% { transform: translate(75vw, 25vh) rotate(45deg) scale(1); opacity: 0.4; }
            40% { transform: translate(70vw, 65vh) rotate(90deg) scale(0.9); opacity: 0.3; }
            60% { transform: translate(20vw, 70vh) rotate(180deg) scale(1.1); opacity: 0.5; }
            80% { transform: translate(15vw, 35vh) rotate(270deg) scale(0.7); opacity: 0.3; }
            100% { transform: translate(5vw, 15vh) rotate(360deg) scale(0.8); opacity: 0.2; }
        }

        /* ================ ë„¤ë¹„ê²Œì´ì…˜ ================ */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #00ff88;
        }

        .login-btn {
            padding: 10px 25px;
            background: linear-gradient(45deg, #00ff88, #0088ff);
            border: none;
            border-radius: 25px;
            color: #000;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .login-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        /* ================ íˆì–´ë¡œ ì„¹ì…˜ ================ */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 120px 20px 60px;
        }

        .hero h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #fff, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.7);
            max-width: 600px;
            margin-bottom: 40px;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .cta-btn {
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .cta-btn.primary {
            background: linear-gradient(45deg, #00ff88, #0088ff);
            border: none;
            color: #000;
            font-weight: 600;
        }

        .cta-btn.secondary {
            background: transparent;
            border: 2px solid #00ff88;
            color: #00ff88;
        }

        .cta-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }

        /* ================ ë ˆë²¨ ì„¹ì…˜ ================ */
        .levels-section {
            padding: 80px 40px;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 50px;
            background: linear-gradient(45deg, #fff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .level-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .level-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.1);
            border-color: #00ff88;
            box-shadow: 0 20px 40px rgba(0, 255, 136, 0.2);
        }

        .level-number {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(45deg, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .level-title {
            font-size: 1.3rem;
            margin: 15px 0 10px;
            color: #fff;
        }

        .level-desc {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }

        .book-count {
            margin-top: 15px;
            padding: 8px 15px;
            background: rgba(0, 255, 136, 0.2);
            border-radius: 20px;
            display: inline-block;
            font-size: 0.85rem;
            color: #00ff88;
        }

        /* ================ ì±… ëª©ë¡ ì„¹ì…˜ ================ */
        .books-section {
            padding: 80px 40px;
            background: rgba(255, 255, 255, 0.02);
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .book-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .book-card:hover {
            transform: scale(1.03);
            border-color: #0088ff;
            box-shadow: 0 10px 30px rgba(0, 136, 255, 0.2);
        }

        .book-level {
            font-size: 0.8rem;
            color: #00ff88;
            margin-bottom: 10px;
        }

        .book-title {
            font-size: 1.1rem;
            color: #fff;
            margin-bottom: 8px;
        }

        .book-chapters {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ================ ë¡œê·¸ì¸ ëª¨ë‹¬ ================ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: linear-gradient(135deg, #1a1a2e, #0f0f0f);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            color: #fff;
            cursor: pointer;
            background: none;
            border: none;
        }

        .modal h2 {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            border-color: #00ff88;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #00ff88, #0088ff);
            border: none;
            border-radius: 10px;
            color: #000;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .submit-btn:hover {
            transform: scale(1.02);
        }

        .modal-footer {
            text-align: center;
            margin-top: 20px;
            color: rgba(255, 255, 255, 0.6);
        }

        .modal-footer a {
            color: #00ff88;
            text-decoration: none;
        }

        /* ================ ì‚¬ìš©ì ë©”ë‰´ (ë¡œê·¸ì¸ í›„) ================ */
        .user-menu {
            display: none;
            align-items: center;
            gap: 15px;
        }

        .user-menu.active {
            display: flex;
        }

        .user-name {
            color: #00ff88;
            font-weight: 600;
        }

        .logout-btn {
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff4444;
        }

        /* ================ ì•Œë¦¼ ë©”ì‹œì§€ ================ */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 15px 25px;
            border-radius: 10px;
            color: #fff;
            font-weight: 500;
            z-index: 3000;
            transform: translateX(150%);
            transition: transform 0.3s;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
        }

        .toast.error {
            background: linear-gradient(45deg, #ff4444, #cc0000);
        }

        /* ================ ë°˜ì‘í˜• ================ */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .navbar {
                padding: 15px 20px;
            }

            .nav-links {
                display: none;
            }

            .levels-section, .books-section {
                padding: 60px 20px;
            }

            .section-title {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- ë™ì  ë°°ê²½ -->
    <div class="dynamic-background"></div>
    
    <!-- ë– ë‹¤ë‹ˆëŠ” í…ìŠ¤íŠ¸ -->
    <div class="floating-text" style="animation-delay: 0s;">Reading</div>
    <div class="floating-text" style="animation-delay: -8s;">English</div>
    <div class="floating-text" style="animation-delay: -15s;">Learning</div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="navbar">
        <a href="index.html" class="logo" style="text-decoration: none; color: inherit;">ğŸ“š ìˆ˜ë¦¬ë”©ì–´í•™ì›</a>
        <div class="nav-links">
            <a href="#levels">ë ˆë²¨ë³„ í•™ìŠµ</a>
            <a href="#books">ë„ì„œ ëª©ë¡</a>
            <a href="#" onclick="openModal('leveltest')">ë ˆë²¨ í…ŒìŠ¤íŠ¸</a>
            <a href="#" onclick="openModal('progress')">ë‚´ ì§„ë„</a>
            <a href="#" onclick="openModal('qr')">QR ì²´í—˜</a>
        </div>
        <div id="authArea">
            <button class="login-btn" onclick="openModal('login')">ë¡œê·¸ì¸</button>
        </div>
        <div class="user-menu" id="userMenu">
            <span class="user-name" id="userName"></span>
            <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </nav>

    <!-- íˆì–´ë¡œ ì„¹ì…˜ -->
    <section class="hero">
        <h1>ìˆ˜ë¦¬ë”©ì–´í•™ì›</h1>
        <p>ë ˆë²¨ë³„ ë§ì¶¤ ì˜ì–´ ì›ì„œ ì½ê¸° í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì˜ì–´ ì‹¤ë ¥ì„ í‚¤ì›Œë³´ì„¸ìš”</p>
        <div class="cta-buttons">
            <a href="#" class="cta-btn primary" onclick="openModal('leveltest')">ë ˆë²¨ í…ŒìŠ¤íŠ¸ ì‹œì‘</a>
            <a href="#books" class="cta-btn secondary">ë„ì„œ ë‘˜ëŸ¬ë³´ê¸°</a>
        </div>
    </section>

    <!-- ë ˆë²¨ ì„¹ì…˜ -->
    <section class="levels-section" id="levels">
        <h2 class="section-title">ğŸ“– ë ˆë²¨ë³„ í•™ìŠµ</h2>
        <div class="levels-grid" id="levelsGrid">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
        </div>
    </section>

    <!-- ë„ì„œ ëª©ë¡ ì„¹ì…˜ -->
    <section class="books-section" id="books">
        <h2 class="section-title">ğŸ“š ë„ì„œ ëª©ë¡</h2>
        <div class="books-grid" id="booksGrid">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
        </div>
    </section>

    <!-- ë‚´ ì§„ë„ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="progressModal">
        <div class="modal" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <button class="modal-close" onclick="closeModal('progress')">&times;</button>
            <h2>ğŸ“Š ë‚´ í•™ìŠµ ì§„ë„</h2>
            
            <div id="progressContent">
                <div id="progressLogin" style="text-align: center; padding: 30px;">
                    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">ë¡œê·¸ì¸ í›„ ì§„ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <button class="submit-btn" onclick="closeModal('progress'); openModal('login');">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
                
                <div id="progressData" style="display: none;">
                    <div style="background: rgba(0,255,136,0.1); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: rgba(255,255,255,0.7);">í˜„ì¬ ë ˆë²¨</span>
                            <span id="userLevel" style="font-size: 1.5rem; color: #00ff88; font-weight: bold;">Level 1</span>
                        </div>
                    </div>
                    
                    <h3 style="margin-bottom: 15px; color: #fff;">ğŸ“š í•™ìŠµ ê¸°ë¡</h3>
                    <div id="progressList" style="max-height: 300px; overflow-y: auto;">
                        <p style="color: rgba(255,255,255,0.5); text-align: center;">ì•„ì§ í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR ì²´í—˜ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="qrModal">
        <div class="modal" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('qr')">&times;</button>
            <h2>ğŸ“± QR ì½”ë“œ ì²´í—˜</h2>
            
            <div style="text-align: center; padding: 20px;">
                <div style="background: #fff; padding: 20px; border-radius: 15px; display: inline-block; margin-bottom: 20px;">
                    <div id="qrCode" style="width: 200px; height: 200px; background: #f0f0f0; display: flex; align-items: center; justify-content: center;">
                        <svg viewBox="0 0 100 100" width="180" height="180">
                            <!-- QR ì½”ë“œ íŒ¨í„´ ì‹œë®¬ë ˆì´ì…˜ -->
                            <rect x="10" y="10" width="25" height="25" fill="#000"/>
                            <rect x="65" y="10" width="25" height="25" fill="#000"/>
                            <rect x="10" y="65" width="25" height="25" fill="#000"/>
                            <rect x="15" y="15" width="15" height="15" fill="#fff"/>
                            <rect x="70" y="15" width="15" height="15" fill="#fff"/>
                            <rect x="15" y="70" width="15" height="15" fill="#fff"/>
                            <rect x="20" y="20" width="5" height="5" fill="#000"/>
                            <rect x="75" y="20" width="5" height="5" fill="#000"/>
                            <rect x="20" y="75" width="5" height="5" fill="#000"/>
                            <rect x="40" y="10" width="5" height="5" fill="#000"/>
                            <rect x="50" y="15" width="5" height="5" fill="#000"/>
                            <rect x="40" y="25" width="5" height="5" fill="#000"/>
                            <rect x="45" y="40" width="10" height="10" fill="#000"/>
                            <rect x="10" y="45" width="5" height="5" fill="#000"/>
                            <rect x="25" y="50" width="5" height="5" fill="#000"/>
                            <rect x="65" y="45" width="5" height="5" fill="#000"/>
                            <rect x="80" y="55" width="5" height="5" fill="#000"/>
                            <rect x="45" y="65" width="5" height="5" fill="#000"/>
                            <rect x="55" y="75" width="5" height="5" fill="#000"/>
                            <rect x="70" y="70" width="5" height="5" fill="#000"/>
                            <rect x="80" y="80" width="5" height="5" fill="#000"/>
                        </svg>
                    </div>
                </div>
                
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
                    QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ë©´ í•´ë‹¹ ì±…ì˜ í•™ìŠµ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!
                </p>
                
                <div style="margin-bottom: 20px;">
                    <select id="qrBookSelect" onchange="updateQRCode()" style="width: 100%; padding: 12px; border-radius: 10px; background: #222; border: 1px solid rgba(255,255,255,0.2); color: #fff; font-size: 1rem;">
                        <option value="" style="background: #222;">-- ì±…ì„ ì„ íƒí•˜ì„¸ìš” --</option>
                        <optgroup label="ğŸ“— Level 2 - Elementary" style="background: #222;">
                            <option value="dinosaurs-before-dark-level2.html">ğŸ¦– Dinosaurs Before Dark</option>
                            <option value="The%20Knight%20at%20Dawn%20-%20Level%202.html">ğŸ° The Knight at Dawn</option>
                            <option value="Mummies%20in%20the%20Morning%20-%20Level%202.html">ğŸ›ï¸ Mummies in the Morning</option>
                            <option value="Pirates%20Past%20Noon%20-%20Level%202.html">ğŸ´â€â˜ ï¸ Pirates Past Noon</option>
                            <option value="Night%20of%20the%20Ninjas%20-%20Level%202.html">ğŸ¥· Night of the Ninjas</option>
                            <option value="Afternoon%20on%20the%20Amazon%20-%20Level%202.html">ğŸŒ´ Afternoon on the Amazon</option>
                            <option value="Dolphins%20at%20Daybreak%20-%20Level%202.html">ğŸ¬ Dolphins at Daybreak</option>
                            <option value="Ghost%20Town%20at%20Sundown%20-%20Level%202.html">ğŸ‘» Ghost Town at Sundown</option>
                            <option value="Lions%20at%20Lunchtime%20-%20Level%202.html">ğŸ¦ Lions at Lunchtime</option>
                            <option value="Polar%20Bears%20Past%20Bedtime%20-%20Level%202.html">ğŸ»â€â„ï¸ Polar Bears Past Bedtime</option>
                            <option value="Sunset%20of%20the%20Sabertooth%20-%20Level%202.html">ğŸ¯ Sunset of the Sabertooth</option>
                            <option value="midnight-on-the-moon.html">ğŸŒ™ Midnight on the Moon</option>
                            <option value="high-tide-in-hawaii.html">ğŸ„ High Tide in Hawaii</option>
                        </optgroup>
                        <optgroup label="ğŸ“˜ Level 3 - Intermediate" style="background: #222;">
                            <option value="Charlotte's%20Web%20-%20Level%203.html">ğŸ•·ï¸ Charlotte's Web</option>
                            <option value="Sarah,%20Plain%20and%20Tall%20-%20Level%203.html">ğŸ‘© Sarah, Plain and Tall</option>
                            <option value="The%20Lion,%20the%20Witch%20and%20the%20Wardrobe%20-%20Level%203.html">ğŸ¦ The Lion, the Witch and the Wardrobe</option>
                            <option value="Prince%20Caspian%20-%20Level%203.html">ğŸ‘‘ Prince Caspian</option>
                            <option value="The%20Voyage%20of%20Dawn%20Treader%20-%20Level%203.html">â›µ The Voyage of Dawn Treader</option>
                            <option value="Matilda%20-%20Level%203.html">ğŸ“š Matilda</option>
                            <option value="bridge-to-terabithia-level3.html">ğŸŒ‰ Bridge to Terabithia</option>
                            <option value="where-red-fern-grows-level3.html">ğŸŒ¿ Where the Red Fern Grows</option>
                            <option value="The%20Wild%20Robot%20-%20Level%203.html">ğŸ¤– The Wild Robot</option>
                            <option value="Buffalo%20Before%20Breakfast%20-%20Level%203.html">ğŸ¦¬ Buffalo Before Breakfast</option>
                            <option value="Tigers%20at%20Twilight%20-%20Level%203.html">ğŸ… Tigers at Twilight</option>
                            <option value="Dingoes%20at%20Dinnertime%20-%20Level%203.html">ğŸ• Dingoes at Dinnertime</option>
                            <option value="Viking%20Ships%20at%20Sunrise%20-%20Level%203.html">â›µ Viking Ships at Sunrise</option>
                            <option value="Tonight%20on%20the%20Titanic%20-%20Level%203.html">ğŸš¢ Tonight on the Titanic</option>
                            <option value="Day%20of%20the%20Dragon%20King%20-%20Level%203.html">ğŸ‰ Day of the Dragon King</option>
                            <option value="Civil%20War%20on%20Sunday%20-%20Level%203.html">âš”ï¸ Civil War on Sunday</option>
                            <option value="Hour%20of%20the%20Olympics%20-%20Level%203.html">ğŸ… Hour of the Olympics</option>
                            <option value="Vacation%20Under%20the%20Volcano%20-%20Level%203.html">ğŸŒ‹ Vacation Under the Volcano</option>
                            <option value="James%20and%20the%20Giant%20Peach%20-%20Level%203-2.html">ğŸ‘ James and the Giant Peach</option>
                            <option value="The%20Landry%20News%20-%20Level%203-2.html">ğŸ“° The Landry News</option>
                            <option value="frindle.html">âœï¸ Frindle</option>
                            <option value="no-talking.html">ğŸ¤« No Talking</option>
                        </optgroup>
                        <optgroup label="ğŸ“™ Level 4 - Upper-Intermediate" style="background: #222;">
                            <option value="The%20Alchemist%20-%20Level%204.html">âš—ï¸ The Alchemist</option>
                            <option value="Shiloh%20-%20Level%204.html">ğŸ• Shiloh</option>
                            <option value="Gangsta%20Granny%20-%20Level%204.html">ğŸ‘µ Gangsta Granny</option>
                            <option value="Billionaire%20Boy%20-%20Level%204-1.html">ğŸ’° Billionaire Boy</option>
                            <option value="The%20cricket%20in%20times%20square-Level4.html">ğŸ¦— The Cricket in Times Square</option>
                            <option value="To%20Kill%20a%20Mockingbird%20-%20Level%204-2.html">ğŸ¦ To Kill a Mockingbird</option>
                            <option value="Revolutionary%20War%20on%20Wednesday%20-%20Level%204.html">ğŸ–ï¸ Revolutionary War on Wednesday</option>
                            <option value="Savvy%20-%20Level%204-3.html">âœ¨ Savvy</option>
                        </optgroup>
                        <optgroup label="ğŸ“• Level 5 - Advanced" style="background: #222;">
                            <option value="Hatchet%20-%20Level%205.html">ğŸª“ Hatchet</option>
                            <option value="The%20Giver%20-%20Level%205.html">ğŸ The Giver</option>
                            <option value="The%20Hunger%20Games%20-%20Level%205.html">ğŸ¹ The Hunger Games</option>
                            <option value="The%20Maze%20Runner%20-%20Level%205.html">ğŸƒ The Maze Runner</option>
                            <option value="The%20Boy%20in%20the%20Striped%20Pajamas%20-%20Level%205.html">ğŸ‘¦ The Boy in the Striped Pajamas</option>
                            <option value="Flora%20and%20Ulysses%20-%20Level%205.html">ğŸ¿ï¸ Flora and Ulysses</option>
                            <option value="A%20Single%20Shard%20-%20Level%205.html">ğŸº A Single Shard</option>
                            <option value="Fish%20in%20a%20Tree%20-%20Level%205-3.html">ğŸŸ Fish in a Tree</option>
                            <option value="The%20War%20That%20Saved%20My%20Life%20-%20Level%205.html">ğŸ—ï¸ The War That Saved My Life</option>
                            <option value="One%20Crazy%20Summer%20-%20Level%205.html">â˜€ï¸ One Crazy Summer</option>
                            <option value="The%20Lemonade%20War%20-%20Level%205-1.html">ğŸ‹ The Lemonade War</option>
                        </optgroup>
                    </select>
                </div>
                
                <button class="submit-btn" onclick="goToSelectedBook()">ì„ íƒí•œ ì±…ìœ¼ë¡œ ì´ë™</button>
            </div>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('login')">&times;</button>
            <h2>ğŸ“š ë¡œê·¸ì¸</h2>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>ì‚¬ìš©ìëª…</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label>ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="submit-btn">ë¡œê·¸ì¸</button>
            </form>
            <div class="modal-footer">
                ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <a href="#" onclick="switchModal('login', 'signup')">íšŒì›ê°€ì…</a>
            </div>
        </div>
    </div>

    <!-- ë ˆë²¨ í…ŒìŠ¤íŠ¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="leveltestModal">
        <div class="modal" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <button class="modal-close" onclick="closeModal('leveltest')">&times;</button>
            <h2>ğŸ“ ë ˆë²¨ í…ŒìŠ¤íŠ¸</h2>
            
            <!-- í…ŒìŠ¤íŠ¸ ì‹œì‘ í™”ë©´ -->
            <div id="testStart">
                <p style="text-align: center; color: rgba(255,255,255,0.7); margin-bottom: 30px;">
                    10ë¬¸ì œë¥¼ í’€ê³  ë‹¹ì‹ ì˜ ì˜ì–´ ì½ê¸° ë ˆë²¨ì„ í™•ì¸í•˜ì„¸ìš”!
                </p>
                <button class="submit-btn" onclick="startLevelTest()">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
            </div>
            
            <!-- ë¬¸ì œ í™”ë©´ -->
            <div id="testQuestions" style="display: none;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <span id="questionNum" style="color: #00ff88;">ë¬¸ì œ 1/10</span>
                    <span id="questionLevel" style="color: rgba(255,255,255,0.5);">Level 1</span>
                </div>
                <div id="questionText" style="font-size: 1.1rem; margin-bottom: 25px; line-height: 1.6;"></div>
                <div id="answerOptions"></div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="submit-btn" onclick="nextQuestion()" id="nextBtn" style="display: none;">ë‹¤ìŒ ë¬¸ì œ</button>
                </div>
            </div>
            
            <!-- ê²°ê³¼ í™”ë©´ -->
            <div id="testResult" style="display: none; text-align: center;">
                <div style="font-size: 4rem; margin-bottom: 20px;">ğŸ‰</div>
                <h3 style="font-size: 1.5rem; margin-bottom: 10px;">í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</h3>
                <div id="resultScore" style="font-size: 2rem; color: #00ff88; margin-bottom: 10px;"></div>
                <div id="resultLevel" style="font-size: 1.3rem; margin-bottom: 30px;"></div>
                <button class="submit-btn" onclick="closeModal('leveltest'); location.reload();">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- íšŒì›ê°€ì… ëª¨ë‹¬ -->
    <div class="modal-overlay" id="signupModal">
        <div class="modal">
            <button class="modal-close" onclick="closeModal('signup')">&times;</button>
            <h2>ğŸ“ íšŒì›ê°€ì…</h2>
            <form id="signupForm" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label>í•™ìƒ ì´ë¦„ *</label>
                    <input type="text" id="signupName" placeholder="í™ê¸¸ë™" required>
                </div>
                <div class="form-group">
                    <label>ì•„ì´ë”” *</label>
                    <input type="text" id="signupUsername" placeholder="ì˜ë¬¸, ìˆ«ì ì¡°í•©" required>
                </div>
                <div class="form-group">
                    <label>ë¹„ë°€ë²ˆí˜¸ *</label>
                    <input type="password" id="signupPassword" placeholder="6ì ì´ìƒ" required>
                </div>
                <div class="form-group">
                    <label>í•™ë…„ *</label>
                    <select id="signupGrade" required style="width:100%; padding:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background:#1a1a2e; color:#fff; font-size:16px;">
                        <option value="" style="background:#1a1a2e; color:#fff;">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                        <option value="ì´ˆ1" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 1í•™ë…„</option>
                        <option value="ì´ˆ2" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 2í•™ë…„</option>
                        <option value="ì´ˆ3" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 3í•™ë…„</option>
                        <option value="ì´ˆ4" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 4í•™ë…„</option>
                        <option value="ì´ˆ5" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 5í•™ë…„</option>
                        <option value="ì´ˆ6" style="background:#1a1a2e; color:#fff;">ì´ˆë“±í•™êµ 6í•™ë…„</option>
                        <option value="ì¤‘1" style="background:#1a1a2e; color:#fff;">ì¤‘í•™êµ 1í•™ë…„</option>
                        <option value="ì¤‘2" style="background:#1a1a2e; color:#fff;">ì¤‘í•™êµ 2í•™ë…„</option>
                        <option value="ì¤‘3" style="background:#1a1a2e; color:#fff;">ì¤‘í•™êµ 3í•™ë…„</option>
                        <option value="ê³ 1" style="background:#1a1a2e; color:#fff;">ê³ ë“±í•™êµ 1í•™ë…„</option>
                        <option value="ê³ 2" style="background:#1a1a2e; color:#fff;">ê³ ë“±í•™êµ 2í•™ë…„</option>
                        <option value="ê³ 3" style="background:#1a1a2e; color:#fff;">ê³ ë“±í•™êµ 3í•™ë…„</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>í•™êµ *</label>
                    <input type="text" id="signupSchool" placeholder="OOì´ˆë“±í•™êµ" required>
                </div>
                <div class="form-group">
                    <label>ë¶€ëª¨ë‹˜ ì—°ë½ì²˜ *</label>
                    <input type="tel" id="signupParentPhone" placeholder="010-0000-0000" required>
                </div>
                <div class="form-group">
                    <label>í•™ìƒ ì—°ë½ì²˜ (ì„ íƒ)</label>
                    <input type="tel" id="signupStudentPhone" placeholder="010-0000-0000">
                </div>
                <button type="submit" class="submit-btn">íšŒì›ê°€ì… ì‹ ì²­</button>
            </form>
            <p style="text-align:center; font-size:12px; color:rgba(255,255,255,0.5); margin-top:10px;">
                * ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤
            </p>
            <div class="modal-footer">
                ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? <a href="#" onclick="switchModal('signup', 'login')">ë¡œê·¸ì¸</a>
            </div>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ë©”ì‹œì§€ -->
    <div class="toast" id="toast"></div>

    <script>
        // ================ Google Sheets ì„¤ì • ================
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz6Tbz0LI9OvrHi9uZN3-DXW7FclJMZE2CtH8O3cVRzXPTc2Htg5LK1nOpvYned8qco/exec';

        // ================ ë°ì´í„° ================
        const levels = [
            { level: 1, title: 'Beginner', desc: 'ì˜ì–´ ì›ì„œ ì…ë¬¸ ë‹¨ê³„', books: 5 },
            { level: 2, title: 'Elementary', desc: 'Magic Tree House ì‹œë¦¬ì¦ˆ', books: 15 },
            { level: 3, title: 'Intermediate', desc: 'Narnia, Charlotte\'s Web ë“±', books: 12 },
            { level: 4, title: 'Upper-Intermediate', desc: 'The Alchemist, Shiloh ë“±', books: 8 },
            { level: 5, title: 'Advanced', desc: 'Hatchet, The Giver ë“±', books: 10 },
            { level: 6, title: 'Upper-Advanced', desc: 'ê³ ê¸‰ ì›ì„œ', books: 5 },
            { level: 7, title: 'Master', desc: 'ë§ˆìŠ¤í„° ë ˆë²¨', books: 3 }
        ];

        const books = [
            // Level 2
            { title: 'Dinosaurs Before Dark', level: 2, chapters: 10, url: 'dinosaurs-before-dark-level2.html' },
            { title: 'The Knight at Dawn', level: 2, chapters: 10, url: 'The%20Knight%20at%20Dawn%20-%20Level%202.html' },
            { title: 'Mummies in the Morning', level: 2, chapters: 10, url: 'Mummies%20in%20the%20Morning%20-%20Level%202.html' },
            { title: 'Pirates Past Noon', level: 2, chapters: 10, url: 'Pirates%20Past%20Noon%20-%20Level%202.html' },
            { title: 'Night of the Ninjas', level: 2, chapters: 10, url: 'Night%20of%20the%20Ninjas%20-%20Level%202.html' },
            { title: 'Afternoon on the Amazon', level: 2, chapters: 10, url: 'Afternoon%20on%20the%20Amazon%20-%20Level%202.html' },
            { title: 'Dolphins at Daybreak', level: 2, chapters: 10, url: 'Dolphins%20at%20Daybreak%20-%20Level%202.html' },
            { title: 'Ghost Town at Sundown', level: 2, chapters: 10, url: 'Ghost%20Town%20at%20Sundown%20-%20Level%202.html' },
            { title: 'Lions at Lunchtime', level: 2, chapters: 10, url: 'Lions%20at%20Lunchtime%20-%20Level%202.html' },
            { title: 'Polar Bears Past Bedtime', level: 2, chapters: 10, url: 'Polar%20Bears%20Past%20Bedtime%20-%20Level%202.html' },
            { title: 'Sunset of the Sabertooth', level: 2, chapters: 10, url: 'Sunset%20of%20the%20Sabertooth%20-%20Level%202.html' },
            { title: 'Midnight on the Moon', level: 2, chapters: 10, url: 'midnight-on-the-moon.html' },
            { title: 'High Tide in Hawaii', level: 2, chapters: 10, url: 'high-tide-in-hawaii.html' },
            // Level 3
            { title: "Charlotte's Web", level: 3, chapters: 22, url: "Charlotte's%20Web%20-%20Level%203.html" },
            { title: 'Sarah, Plain and Tall', level: 3, chapters: 9, url: 'Sarah,%20Plain%20and%20Tall%20-%20Level%203.html' },
            { title: 'The Lion, the Witch and the Wardrobe', level: 3, chapters: 17, url: 'The%20Lion,%20the%20Witch%20and%20the%20Wardrobe%20-%20Level%203.html' },
            { title: 'Prince Caspian', level: 3, chapters: 15, url: 'Prince%20Caspian%20-%20Level%203.html' },
            { title: 'The Voyage of Dawn Treader', level: 3, chapters: 16, url: 'The%20Voyage%20of%20Dawn%20Treader%20-%20Level%203.html' },
            { title: 'Matilda', level: 3, chapters: 21, url: 'Matilda%20-%20Level%203.html' },
            { title: 'Bridge to Terabithia', level: 3, chapters: 13, url: 'bridge-to-terabithia-level3.html' },
            { title: 'Where the Red Fern Grows', level: 3, chapters: 20, url: 'where-red-fern-grows-level3.html' },
            { title: 'The Wild Robot', level: 3, chapters: 20, url: 'The%20Wild%20Robot%20-%20Level%203.html' },
            { title: 'Buffalo Before Breakfast', level: 3, chapters: 10, url: 'Buffalo%20Before%20Breakfast%20-%20Level%203.html' },
            { title: 'Tigers at Twilight', level: 3, chapters: 10, url: 'Tigers%20at%20Twilight%20-%20Level%203.html' },
            { title: 'Dingoes at Dinnertime', level: 3, chapters: 10, url: 'Dingoes%20at%20Dinnertime%20-%20Level%203.html' },
            { title: 'Vikings Ships at Sunrise', level: 3, chapters: 10, url: 'Viking%20Ships%20at%20Sunrise%20-%20Level%203.html' },
            { title: 'Tonight on the Titanic', level: 3, chapters: 10, url: 'Tonight%20on%20the%20Titanic%20-%20Level%203.html' },
            { title: 'Day of the Dragon King', level: 3, chapters: 10, url: 'Day%20of%20the%20Dragon%20King%20-%20Level%203.html' },
            { title: 'Civil War on Sunday', level: 3, chapters: 10, url: 'Civil%20War%20on%20Sunday%20-%20Level%203.html' },
            { title: 'Hour of the Olympics', level: 3, chapters: 10, url: 'Hour%20of%20the%20Olympics%20-%20Level%203.html' },
            { title: 'Vacation Under the Volcano', level: 3, chapters: 10, url: 'Vacation%20Under%20the%20Volcano%20-%20Level%203.html' },
            { title: 'James and the Giant Peach', level: 3, chapters: 15, url: 'James%20and%20the%20Giant%20Peach%20-%20Level%203-2.html' },
            { title: 'The Landry News', level: 3, chapters: 15, url: 'The%20Landry%20News%20-%20Level%203-2.html' },
            { title: 'Frindle', level: 3, chapters: 15, url: 'frindle.html' },
            { title: 'No Talking', level: 3, chapters: 15, url: 'no-talking.html' },
            // Level 4
            { title: 'The Alchemist', level: 4, chapters: 15, url: 'The%20Alchemist%20-%20Level%204.html' },
            { title: 'Shiloh', level: 4, chapters: 15, url: 'Shiloh%20-%20Level%204.html' },
            { title: 'Gangsta Granny', level: 4, chapters: 20, url: 'Gangsta%20Granny%20-%20Level%204.html' },
            { title: 'Billionaire Boy', level: 4, chapters: 20, url: 'Billionaire%20Boy%20-%20Level%204-1.html' },
            { title: 'The Cricket in Times Square', level: 4, chapters: 15, url: 'The%20cricket%20in%20times%20square-Level4.html' },
            { title: 'To Kill a Mockingbird', level: 4, chapters: 31, url: 'To%20Kill%20a%20Mockingbird%20-%20Level%204-2.html' },
            { title: 'Revolutionary War on Wednesday', level: 4, chapters: 10, url: 'Revolutionary%20War%20on%20Wednesday%20-%20Level%204.html' },
            { title: 'Savvy', level: 4, chapters: 20, url: 'Savvy%20-%20Level%204-3.html' },
            // Level 5
            { title: 'Hatchet', level: 5, chapters: 19, url: 'Hatchet%20-%20Level%205.html' },
            { title: 'The Giver', level: 5, chapters: 23, url: 'The%20Giver%20-%20Level%205.html' },
            { title: 'The Hunger Games', level: 5, chapters: 27, url: 'The%20Hunger%20Games%20-%20Level%205.html' },
            { title: 'The Maze Runner', level: 5, chapters: 25, url: 'The%20Maze%20Runner%20-%20Level%205.html' },
            { title: 'The Boy in the Striped Pajamas', level: 5, chapters: 20, url: 'The%20Boy%20in%20the%20Striped%20Pajamas%20-%20Level%205.html' },
            { title: 'Flora and Ulysses', level: 5, chapters: 20, url: 'Flora%20and%20Ulysses%20-%20Level%205.html' },
            { title: 'A Single Shard', level: 5, chapters: 13, url: 'A%20Single%20Shard%20-%20Level%205.html' },
            { title: 'Fish in a Tree', level: 5, chapters: 20, url: 'Fish%20in%20a%20Tree%20-%20Level%205-3.html' },
            { title: 'The War That Saved My Life', level: 5, chapters: 25, url: 'The%20War%20That%20Saved%20My%20Life%20-%20Level%205.html' },
            { title: 'One Crazy Summer', level: 5, chapters: 20, url: 'One%20Crazy%20Summer%20-%20Level%205.html' },
            { title: 'The Lemonade War', level: 5, chapters: 15, url: 'The%20Lemonade%20War%20-%20Level%205-1.html' },
        ];

        // ================ í˜„ì¬ ì‚¬ìš©ì ================
        let currentUser = null;

        // ================ ì´ˆê¸°í™” ================
        document.addEventListener('DOMContentLoaded', () => {
            renderLevels();
            renderBooks();
            checkLoginStatus();
        });

        // ================ ë ˆë²¨ ì¹´ë“œ ë Œë”ë§ ================
        function renderLevels() {
            const grid = document.getElementById('levelsGrid');
            grid.innerHTML = levels.map(l => `
                <div class="level-card" onclick="filterBooks(${l.level})">
                    <div class="level-number">L${l.level}</div>
                    <div class="level-title">${l.title}</div>
                    <div class="level-desc">${l.desc}</div>
                    <div class="book-count">ğŸ“š ${l.books}ê¶Œ</div>
                </div>
            `).join('');
        }

        // ================ ì±… ì¹´ë“œ ë Œë”ë§ ================
        function renderBooks(filterLevel = null) {
            const grid = document.getElementById('booksGrid');
            const filtered = filterLevel ? books.filter(b => b.level === filterLevel) : books;
            
            grid.innerHTML = filtered.map(b => `
                <div class="book-card" onclick="openBook('${b.url}')">
                    <div class="book-level">Level ${b.level}</div>
                    <div class="book-title">${b.title}</div>
                    <div class="book-chapters">${b.chapters} chapters</div>
                </div>
            `).join('');
        }

        function filterBooks(level) {
            renderBooks(level);
            document.getElementById('books').scrollIntoView({ behavior: 'smooth' });
        }

        function openBook(url) {
            // ë¡œê·¸ì¸ í™•ì¸
            if (!currentUser) {
                showToast('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                openModal('login');
                return;
            }
            window.location.href = url;
        }

        // ================ ëª¨ë‹¬ ì œì–´ ================
        function closeModal(type) {
            document.getElementById(`${type}Modal`).classList.remove('active');
        }

        function switchModal(from, to) {
            closeModal(from);
            openModal(to);
        }

        // ================ ì¸ì¦ (Google Sheets ì—°ë™) ================
        async function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            try {
                // Google Sheetsì—ì„œ ì‚¬ìš©ì í™•ì¸
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=login&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);
                const result = await response.json();

                if (result.success) {
                    // ìŠ¹ì¸ ìƒíƒœ í™•ì¸
                    if (result.user.status === 'pending') {
                        showToast('â³ ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸°ì¤‘ì…ë‹ˆë‹¤. ìŠ¹ì¸ í›„ ë¡œê·¸ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
                        return;
                    }
                    if (result.user.status === 'rejected') {
                        showToast('âŒ ìŠ¹ì¸ì´ ê±°ì ˆë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.', 'error');
                        return;
                    }
                    currentUser = result.user;
                    localStorage.setItem('sureading_user', JSON.stringify(currentUser));
                    updateAuthUI();
                    closeModal('login');
                    showToast(`í™˜ì˜í•©ë‹ˆë‹¤, ${currentUser.name}ë‹˜!`, 'success');
                } else {
                    showToast(result.message || 'ë¡œê·¸ì¸ ì‹¤íŒ¨', 'error');
                }
            } catch (error) {
                // Google Sheets ì—°ë™ ì „ í…ŒìŠ¤íŠ¸ìš© ë¡œì»¬ ë¡œê·¸ì¸
                if (username && password) {
                    currentUser = { name: username, username: username, level: 1 };
                    localStorage.setItem('sureading_user', JSON.stringify(currentUser));
                    updateAuthUI();
                    closeModal('login');
                    showToast(`í™˜ì˜í•©ë‹ˆë‹¤, ${username}ë‹˜! (í…ŒìŠ¤íŠ¸ ëª¨ë“œ)`, 'success');
                } else {
                    showToast('ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”', 'error');
                }
            }
        }

        async function handleSignup(event) {
            event.preventDefault();
            const name = document.getElementById('signupName').value;
            const username = document.getElementById('signupUsername').value;
            const password = document.getElementById('signupPassword').value;
            const grade = document.getElementById('signupGrade').value;
            const school = document.getElementById('signupSchool').value;
            const parentPhone = document.getElementById('signupParentPhone').value;
            const studentPhone = document.getElementById('signupStudentPhone').value;

            try {
                // Google Sheetsì— ì‚¬ìš©ì ì¶”ê°€ (ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœë¡œ)
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=signup&name=${encodeURIComponent(name)}&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&grade=${encodeURIComponent(grade)}&school=${encodeURIComponent(school)}&parentPhone=${encodeURIComponent(parentPhone)}&studentPhone=${encodeURIComponent(studentPhone)}`);
                const result = await response.json();

                if (result.success) {
                    closeModal('signup');
                    showPendingModal();
                } else {
                    showToast(result.message || 'íšŒì›ê°€ì… ì‹¤íŒ¨', 'error');
                }
            } catch (error) {
                // í…ŒìŠ¤íŠ¸ìš©
                closeModal('signup');
                showPendingModal();
            }
        }

        function showPendingModal() {
            // ìŠ¹ì¸ ëŒ€ê¸° ì•ˆë‚´ ëª¨ë‹¬ í‘œì‹œ
            const modal = document.createElement('div');
            modal.className = 'modal-overlay active';
            modal.id = 'pendingModal';
            modal.innerHTML = `
                <div class="modal" style="text-align: center;">
                    <div class="modal-header">
                        <h2>ğŸ“ íšŒì›ê°€ì… ì‹ ì²­ ì™„ë£Œ!</h2>
                    </div>
                    <div class="modal-body" style="padding: 30px;">
                        <div style="font-size: 60px; margin-bottom: 20px;">â³</div>
                        <h3 style="color: #00ff88; margin-bottom: 15px;">ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸°ì¤‘</h3>
                        <p style="color: rgba(255,255,255,0.7); line-height: 1.8;">
                            íšŒì›ê°€ì… ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                            ê´€ë¦¬ìê°€ ìŠ¹ì¸í•˜ë©´ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>
                            <strong style="color: #ff9800;">ìŠ¹ì¸ê¹Œì§€ 1~2ì¼ ì •ë„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</strong>
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button onclick="document.getElementById('pendingModal').remove()" 
                                style="background: #00ff88; color: #000; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px;">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('sureading_user');
            updateAuthUI();
            showToast('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
        }

        function checkLoginStatus() {
            const saved = localStorage.getItem('sureading_user');
            if (saved) {
                currentUser = JSON.parse(saved);
                updateAuthUI();
            }
        }

        function updateAuthUI() {
            const authArea = document.getElementById('authArea');
            const userMenu = document.getElementById('userMenu');
            const userName = document.getElementById('userName');

            if (currentUser) {
                authArea.style.display = 'none';
                userMenu.classList.add('active');
                userName.textContent = `ğŸ‘¤ ${currentUser.name}`;
            } else {
                authArea.style.display = 'block';
                userMenu.classList.remove('active');
            }
        }

        // ================ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // ================ ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ìœ¼ë¡œ ë‹«ê¸° ================
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });

        // ================ ë‚´ ì§„ë„ ê¸°ëŠ¥ ================
        function openModal(type) {
            document.getElementById(`${type}Modal`).classList.add('active');
            
            // ë‚´ ì§„ë„ ëª¨ë‹¬ ì—´ë¦´ ë•Œ ë°ì´í„° ë¡œë“œ
            if (type === 'progress') {
                loadProgress();
            }
        }

        function loadProgress() {
            if (currentUser) {
                document.getElementById('progressLogin').style.display = 'none';
                document.getElementById('progressData').style.display = 'block';
                document.getElementById('userLevel').textContent = `Level ${currentUser.level || 1}`;
                
                // Google Sheetsì—ì„œ ì§„ë„ ê°€ì ¸ì˜¤ê¸°
                fetchProgress(currentUser.username);
            } else {
                document.getElementById('progressLogin').style.display = 'block';
                document.getElementById('progressData').style.display = 'none';
            }
        }

        async function fetchProgress(username) {
            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getProgress&username=${encodeURIComponent(username)}`);
                const result = await response.json();
                
                if (result.success && result.progress.length > 0) {
                    const listHtml = result.progress.map(p => `
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; color: #fff;">${p.book_title}</div>
                                <div style="font-size: 0.85rem; color: rgba(255,255,255,0.5);">Chapter ${p.chapter}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: ${p.completed ? '#00ff88' : '#ff4444'};">${p.completed ? 'âœ… ì™„ë£Œ' : 'ğŸ“– ì§„í–‰ì¤‘'}</div>
                                <div style="font-size: 0.85rem; color: rgba(255,255,255,0.5);">${p.score}ì </div>
                            </div>
                        </div>
                    `).join('');
                    document.getElementById('progressList').innerHTML = listHtml;
                } else {
                    document.getElementById('progressList').innerHTML = '<p style="color: rgba(255,255,255,0.5); text-align: center;">ì•„ì§ í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
            } catch (error) {
                document.getElementById('progressList').innerHTML = '<p style="color: rgba(255,255,255,0.5); text-align: center;">ì•„ì§ í•™ìŠµ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ================ QR ì²´í—˜ ê¸°ëŠ¥ ================
        function updateQRCode() {
            const select = document.getElementById('qrBookSelect');
            const selectedBook = select.value;
            // QR ì½”ë“œ ì—…ë°ì´íŠ¸ (ì‹¤ì œë¡œëŠ” QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)
            console.log('Selected book:', selectedBook);
        }

        function goToSelectedBook() {
            const select = document.getElementById('qrBookSelect');
            const selectedBook = select.value;
            
            if (!selectedBook) {
                showToast('ì±…ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
                return;
            }
            
            if (!currentUser) {
                showToast('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                closeModal('qr');
                openModal('login');
                return;
            }
            
            window.location.href = selectedBook;
        }

        // ================ ë ˆë²¨ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ ================
        const levelTestQuestions = [
            // Level 1 - ê¸°ì´ˆ
            { level: 1, question: "What color is the sky?", options: ["Blue", "Green", "Red", "Yellow"], answer: 0 },
            { level: 1, question: "How many legs does a dog have?", options: ["Two", "Three", "Four", "Five"], answer: 2 },
            // Level 2 - ì´ˆê¸‰
            { level: 2, question: "Jack and Annie found a tree house in the woods. What was special about it?", options: ["It was very old", "It was full of books", "It was painted red", "It had no door"], answer: 1 },
            { level: 2, question: "In 'Dinosaurs Before Dark', where did the tree house take Jack and Annie?", options: ["To the future", "To dinosaur times", "To a castle", "To the moon"], answer: 1 },
            // Level 3 - ì¤‘ê¸‰
            { level: 3, question: "In 'Charlotte's Web', what kind of animal is Charlotte?", options: ["A pig", "A rat", "A spider", "A goose"], answer: 2 },
            { level: 3, question: "What does Charlotte write in her web to save Wilbur?", options: ["'Help me'", "'Some Pig'", "'Run away'", "'Be free'"], answer: 1 },
            // Level 4 - ì¤‘ìƒê¸‰
            { level: 4, question: "In 'The Alchemist', what is Santiago's original profession?", options: ["A merchant", "A shepherd", "A soldier", "A teacher"], answer: 1 },
            { level: 4, question: "What is the main theme of 'To Kill a Mockingbird'?", options: ["Adventure", "Romance", "Racial injustice", "War"], answer: 2 },
            // Level 5 - ê³ ê¸‰
            { level: 5, question: "In 'The Giver', what is Jonas's assignment?", options: ["The Receiver of Memory", "The Chief Elder", "The Nurturer", "The Speaker"], answer: 0 },
            { level: 5, question: "What is the significance of the 'Hunger Games' in the story?", options: ["Entertainment", "Population control and oppression", "Sports competition", "Education"], answer: 1 },
        ];

        let currentQuestion = 0;
        let correctAnswers = 0;
        let selectedAnswer = null;
        let testQuestions = [];

        function startLevelTest() {
            // ë¬¸ì œ ì„ê¸°
            testQuestions = [...levelTestQuestions].sort(() => Math.random() - 0.5).slice(0, 10);
            currentQuestion = 0;
            correctAnswers = 0;
            
            document.getElementById('testStart').style.display = 'none';
            document.getElementById('testQuestions').style.display = 'block';
            document.getElementById('testResult').style.display = 'none';
            
            showQuestion();
        }

        function showQuestion() {
            const q = testQuestions[currentQuestion];
            document.getElementById('questionNum').textContent = `ë¬¸ì œ ${currentQuestion + 1}/10`;
            document.getElementById('questionLevel').textContent = `Level ${q.level}`;
            document.getElementById('questionText').textContent = q.question;
            
            const optionsHtml = q.options.map((opt, i) => `
                <div class="answer-option" onclick="selectAnswer(${i})" id="opt${i}" 
                     style="padding: 15px; margin: 10px 0; background: rgba(255,255,255,0.1); 
                            border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; 
                            cursor: pointer; transition: all 0.3s;">
                    ${String.fromCharCode(65 + i)}. ${opt}
                </div>
            `).join('');
            
            document.getElementById('answerOptions').innerHTML = optionsHtml;
            document.getElementById('nextBtn').style.display = 'none';
            selectedAnswer = null;
        }

        function selectAnswer(index) {
            if (selectedAnswer !== null) return; // ì´ë¯¸ ì„ íƒí•¨
            
            selectedAnswer = index;
            const q = testQuestions[currentQuestion];
            
            // ëª¨ë“  ì˜µì…˜ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            for (let i = 0; i < 4; i++) {
                const opt = document.getElementById(`opt${i}`);
                if (i === q.answer) {
                    opt.style.background = 'rgba(0, 255, 136, 0.3)';
                    opt.style.borderColor = '#00ff88';
                } else if (i === index && index !== q.answer) {
                    opt.style.background = 'rgba(255, 68, 68, 0.3)';
                    opt.style.borderColor = '#ff4444';
                }
            }
            
            if (index === q.answer) {
                correctAnswers++;
            }
            
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').textContent = currentQuestion < 9 ? 'ë‹¤ìŒ ë¬¸ì œ' : 'ê²°ê³¼ ë³´ê¸°';
        }

        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion >= 10) {
                showResult();
            } else {
                showQuestion();
            }
        }

        function showResult() {
            document.getElementById('testQuestions').style.display = 'none';
            document.getElementById('testResult').style.display = 'block';
            
            const score = correctAnswers * 10;
            let level, levelText;
            
            if (score >= 90) { level = 5; levelText = 'Level 5 - Advanced'; }
            else if (score >= 70) { level = 4; levelText = 'Level 4 - Upper-Intermediate'; }
            else if (score >= 50) { level = 3; levelText = 'Level 3 - Intermediate'; }
            else if (score >= 30) { level = 2; levelText = 'Level 2 - Elementary'; }
            else { level = 1; levelText = 'Level 1 - Beginner'; }
            
            document.getElementById('resultScore').textContent = `${score}ì  (${correctAnswers}/10)`;
            document.getElementById('resultLevel').innerHTML = `ì¶”ì²œ ë ˆë²¨: <span style="color: #00ff88;">${levelText}</span>`;
            
            // Google Sheetsì— ê²°ê³¼ ì €ì¥
            if (currentUser) {
                saveLevelTestResult(currentUser.username, level, score);
            }
        }

        async function saveLevelTestResult(username, level, score) {
            try {
                await fetch(`${GOOGLE_SCRIPT_URL}?action=saveProgress&username=${encodeURIComponent(username)}&book_title=LevelTest&chapter=${level}&score=${score}`);
            } catch (error) {
                console.log('ê²°ê³¼ ì €ì¥ ì‹¤íŒ¨');
            }
        }

        // ê´€ë¦¬ì ì ‘ê·¼
        function adminAccess() {
            const password = prompt('ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (password === 'davich06') {
                window.location.href = 'admin.html';
            } else if (password !== null) {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
            }
        }
    </script>

    <!-- í‘¸í„° -->
    <footer style="text-align: center; padding: 30px 20px; margin-top: 50px; border-top: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.4); font-size: 12px;">
        <p>Â© 2024 ìˆ˜ë¦¬ë”©ì–´í•™ì› (Sureading Academy) | 
            <a href="#" onclick="adminAccess(); return false;" style="color: rgba(255,255,255,0.3); text-decoration: none;" 
               onmouseover="this.style.color='#00ff88'" 
               onmouseout="this.style.color='rgba(255,255,255,0.3)'">ê´€ë¦¬ì</a>
        </p>
    </footer>
</body>
</html>
