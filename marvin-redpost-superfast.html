<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marvin Redpost: Super Fast, Out of Control! - Level 2 - ÏàòÎ¶¨Îî©Ïñ¥ÌïôÏõê</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #FF6B9D 0%, #C44569 50%, #8B4582 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Ìó§Îçî */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: #666;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: #FF6B9D;
            color: white;
            transform: translateY(-2px);
        }

        /* Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ */
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        /* Ï±Ö ÏÉÅÏÑ∏ ÌôîÎ©¥ */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-size: 0.9rem;
            color: #666;
        }

        .breadcrumb a {
            color: #FF6B9D;
            text-decoration: none;
            cursor: pointer;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .book-detail-header {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: flex-start;
        }

        .detail-book-cover {
            width: 150px;
            height: 220px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
            font-weight: bold;
            flex-shrink: 0;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
        }

        .book-info {
            flex: 1;
        }

        .book-info h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .book-info .author {
            font-size: 1.2rem;
            color: #FF6B9D;
            margin-bottom: 20px;
        }

        .book-summary {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .book-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #FF6B9D;
        }

        .stat-box .label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* Ï±ïÌÑ∞ Í∑∏Î¶¨Îìú */
        .chapters-section {
            margin-top: 40px;
        }

        .chapters-section h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .chapter-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .chapter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .chapter-card.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, #28a74508, #ffffff);
        }

        .chapter-card.current {
            border-color: #FF6B9D;
            background: linear-gradient(135deg, #FF6B9D08, #ffffff);
        }

        .chapter-card.locked {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .chapter-info h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .chapter-info p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }

        .chapter-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .chapter-status.completed {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .chapter-status.current {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
        }

        .chapter-status.locked {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .chapter-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .chapter-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .audio-btn {
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
        }

        .quiz-btn {
            background: linear-gradient(45deg, #C44569, #8B4582);
            color: white;
        }

        .chapter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .chapter-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* ÌïôÏäµ ÌôîÎ©¥ */
        .learning-screen {
            display: none;
        }

        .learning-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .learning-progress {
            background: #f8f9fa;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .learning-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #FF6B9D, #C44569);
            transition: width 0.3s ease;
        }

        .question-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .passage {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #FF6B9D;
        }

        .option.selected {
            background: rgba(255, 107, 157, 0.1);
            border-color: #FF6B9D;
        }

        .learning-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn {
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
        }

        .prev-btn {
            background: #6c757d;
            color: white;
        }

        .submit-btn {
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Í≤∞Í≥º ÌôîÎ©¥ */
        .result-screen {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        /* Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ Î™®Îã¨ */
        .audio-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .audio-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .close-audio {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .audio-player {
            width: 100%;
            margin: 20px 0;
            border-radius: 10px;
        }

        .audio-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .audio-control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-pause-btn {
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
        }

        .speed-btn {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .download-btn {
            background: #C44569;
            color: white;
        }

        .audio-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .audio-info.hidden {
            display: none;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .book-detail-header {
                flex-direction: column;
                text-align: center;
            }

            .book-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .learning-controls {
                flex-direction: column;
            }

            .chapter-actions {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                justify-content: center;
                gap: 10px;
            }

            .audio-content {
                padding: 30px 20px;
            }
        }

        .new-book-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Level 2 ÌäπÎ≥Ñ Ïä§ÌÉÄÏùº */
        .level-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(45deg, #FF6B9D, #C44569);
            color: white;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üèÉ</div>
                <div class="logo-text">
                    <h1>Super Fast, Out of Control!</h1>
                    <p>Level 2 - Marvin Redpost #7 by Louis Sachar</p>
                </div>
            </div>
            <div class="nav-buttons">
                <a href="http://www.suelibrary.store/" class="nav-btn">Î©îÏù∏ÏúºÎ°ú</a>
            </div>
        </div>

        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
        <div class="main-content">
            <!-- Ï±Ö ÏÉÅÏÑ∏ ÌôîÎ©¥ -->
            <div class="book-detail-screen" id="book-detail-screen">
                <div class="level-badge">Level 2</div>
                <div class="breadcrumb">
                    <span>Marvin Redpost: Super Fast, Out of Control!</span>
                </div>

                <div class="book-detail-header">
                    <div class="detail-book-cover">üèÉ</div>
                    <div class="book-info">
                        <h2>Super Fast, Out of Control!</h2>
                        <div class="author">Louis Sachar</div>
                        <div class="book-summary">
                            Marvin Redpost gets a new bicycle for his birthday - a super fast red bike that he loves! But when he starts riding it, something strange happens. The bike seems to go faster and faster, and Marvin can't control it! He's going so fast that he can't stop, and he's heading straight for trouble. Will Marvin be able to control his super fast bike before something terrible happens? This exciting Level 2 book is perfect for young readers who are building confidence and fluency.
                        </div>
                        <div class="book-stats">
                            <div class="stat-box">
                                <div class="value">8</div>
                                <div class="label">Ï±ïÌÑ∞</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">40</div>
                                <div class="label">Ï¥ù Î¨∏Ï†ú</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">Level 2</div>
                                <div class="label">Î†àÎ≤®</div>
                            </div>
                            <div class="stat-box">
                                <div class="value" id="progress-value">0%</div>
                                <div class="label">ÏßÑÎèÑ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chapters-section">
                    <h3>üèÉ Ï±ïÌÑ∞Î≥Ñ ÌïôÏäµ</h3>
                    <div class="chapters-grid" id="chapters-grid">
                        <!-- Ï±ïÌÑ∞ Ïπ¥ÎìúÎì§ -->
                    </div>
                </div>
            </div>

            <!-- ÌïôÏäµ ÌôîÎ©¥ -->
            <div class="learning-screen" id="learning-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">Super Fast, Out of Control!</a>
                    <span>></span>
                    <span id="learning-chapter-breadcrumb">Chapter 1</span>
                </div>

                <div class="learning-header">
                    <h2 id="learning-title">Chapter 1</h2>
                    <div class="learning-progress">
                        <div class="learning-progress-bar" id="learning-progress-bar" style="width: 0%"></div>
                    </div>
                    <p id="learning-progress-text">Î¨∏Ï†ú 1 / 5</p>
                </div>

                <div class="question-container" id="question-container">
                    <!-- Î¨∏Ï†úÍ∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>

                <div class="learning-controls">
                    <button class="control-btn prev-btn" id="prev-btn" onclick="previousQuestion()" disabled>Ïù¥Ï†Ñ</button>
                    <button class="control-btn next-btn" id="next-btn" onclick="nextQuestion()">Îã§Ïùå</button>
                    <button class="control-btn submit-btn" id="submit-btn" onclick="submitAnswers()" style="display: none;">Ï†úÏ∂ú</button>
                </div>
            </div>

            <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
            <div class="result-screen" id="result-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">Super Fast, Out of Control!</a>
                    <span>></span>
                    <span>Í≤∞Í≥º</span>
                </div>

                <div class="result-header">
                    <h2>üéâ ÌïôÏäµ ÏôÑÎ£å!</h2>
                    <div class="score-circle" id="score-circle">100%</div>
                    <h3 id="result-message">ÌõåÎ•≠Ìï©ÎãàÎã§!</h3>
                </div>

                <div class="result-details">
                    <div class="result-stat">
                        <h4>Ï¥ù Î¨∏Ï†ú</h4>
                        <p id="total-questions">5Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ï†ïÎãµ</h4>
                        <p id="correct-answers">5Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ïò§Îãµ</h4>
                        <p id="wrong-answers">0Î¨∏Ï†ú</p>
                    </div>
                    <div class="result-stat">
                        <h4>Ï†êÏàò</h4>
                        <p id="final-score">100Ï†ê</p>
                    </div>
                </div>

                <div class="result-actions">
                    <button class="control-btn prev-btn" onclick="retryChapter()">Îã§Ïãú ÌíÄÍ∏∞</button>
                    <button class="control-btn next-btn" onclick="nextChapter()">Îã§Ïùå Ï±ïÌÑ∞</button>
                    <button class="control-btn submit-btn" onclick="showBookDetail()">Ï±ïÌÑ∞ Î™©Î°ù</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ Î™®Îã¨ -->
    <div class="audio-modal" id="audio-modal">
        <div class="audio-content">
            <button class="close-audio" onclick="closeAudioModal()">√ó</button>
            <h3 id="audio-chapter-title">Chapter 1</h3>
            <p id="audio-chapter-subtitle">Super Fast, Out of Control! - Louis Sachar</p>

            <audio class="audio-player" id="audio-player" controls preload="metadata">
                <source id="audio-source" src="" type="audio/mpeg">
                Î∏åÎùºÏö∞Ï†ÄÍ∞Ä Ïò§ÎîîÏò§Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.
            </audio>

            <div class="audio-controls">
                <button class="audio-control-btn play-pause-btn" onclick="togglePlayPause()">‚ñ∂Ô∏è Ïû¨ÏÉù</button>
                <button class="audio-control-btn speed-btn" onclick="changeSpeed()">1.0x</button>
                <button class="audio-control-btn download-btn" onclick="downloadAudio()">üì• Îã§Ïö¥Î°úÎìú</button>
            </div>

            <div class="audio-info" id="audio-info">
                <div id="audio-status" style="margin-top: 10px; font-weight: bold; color: #FF6B9D;"></div>
            </div>
        </div>
    </div>

    <script>
        // Íµ¨Í∏Ä ÌÅ¥ÎùºÏö∞Îìú Ïä§ÌÜ†Î¶¨ÏßÄ Ïò§ÎîîÏò§ URL ÏÑ§Ï†ï
        const AUDIO_BASE_URL = 'https://storage.googleapis.com/kim-mom-reading-audio/audio/';

        // Super Fast, Out of Control Ï±ïÌÑ∞Î≥Ñ Í∞úÎ≥Ñ ÌååÏùº Îß§Ìïë
        const superFastFileMapping = {
            0: '001.mp3',   // Chapter 1: Marvin gets a new red bicycle
            1: '002.mp3',   // Chapter 2: Marvin starts riding his new bike
            2: '003.mp3',   // Chapter 3: The bicycle goes faster and faster
            3: '004.mp3',   // Chapter 4: Marvin tries to stop but can't control it
            4: '005.mp3',   // Chapter 5: The runaway bike takes Marvin on a wild ride
            5: '006.mp3',   // Chapter 6: Marvin realizes he needs to find a way to stop
            6: '007.mp3',   // Chapter 7: With help from friends, Marvin learns to control the bike
            7: '008.mp3'    // Chapter 8: Marvin masters his bike and rides safely
        };

        // Ïò§ÎîîÏò§ URL ÏÉùÏÑ± Ìï®Ïàò
        function getAudioUrl(chapterIndex) {
            const fileName = superFastFileMapping[chapterIndex];
            return {
                primary: `${AUDIO_BASE_URL}SF007_Super_Fast_Out_of_Control/${fileName}`,
                alternatives: [`${AUDIO_BASE_URL}SF007_Super_Fast_Out_of_Control/${fileName}`]
            };
        }

        // Ïò§ÎîîÏò§ Ïû¨ÏÉù Ìï®Ïàò
        function playChapterAudio(chapterIndex) {
            const chapter = bookData.chapterList[chapterIndex];
            const audioData = getAudioUrl(chapterIndex);

            document.getElementById('audio-modal').style.display = 'flex';
            document.getElementById('audio-chapter-title').textContent = `Chapter ${chapterIndex + 1}`;
            document.getElementById('audio-chapter-subtitle').textContent = `${bookData.title} - ${bookData.author}`;
            document.getElementById('audio-info').classList.remove('hidden');

            const audioPlayer = document.getElementById('audio-player');
            const audioSource = document.getElementById('audio-source');
            const audioStatus = document.getElementById('audio-status');

            audioStatus.textContent = 'üîÑ Ïò§ÎîîÏò§ ÌååÏùºÏùÑ Î°úÎî© Ï§ë...';

            // Ï≤´ Î≤àÏß∏ URLÎ°ú ÏãúÎèÑ
            audioSource.src = audioData.primary;
            audioPlayer.load();

            const successHandler = function() {
                audioStatus.textContent = `‚úÖ Chapter ${chapterIndex + 1} Î°úÎìú ÏôÑÎ£å!`;
                console.log(`Audio loaded successfully: ${audioData.primary}`);
                
                audioPlayer.play().then(() => {
                    audioStatus.textContent = `üéµ Chapter ${chapterIndex + 1} Ïû¨ÏÉù Ï§ë!`;
                    document.querySelector('.play-pause-btn').textContent = '‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ';
                }).catch(e => {
                    console.log('ÏûêÎèô Ïû¨ÏÉù Ï∞®Îã®Îê®:', e);
                    audioStatus.textContent = `‚úÖ Chapter ${chapterIndex + 1} Ï§ÄÎπÑÎê®! ‚ñ∂Ô∏è Ïû¨ÏÉù Î≤ÑÌäºÏùÑ ÎàåÎü¨Ï£ºÏÑ∏Ïöî`;
                });
            };

            const errorHandler = function() {
                console.error(`Audio failed to load: ${audioData.primary}`);
                audioStatus.innerHTML = `‚ùå Ïò§ÎîîÏò§ ÌååÏùºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.<br>URL: ${audioData.primary}`;
                
                // ÎåÄÏ≤¥ URLÎì§ÏùÑ ÏãúÎèÑÌï¥Î≥º Ïàò ÏûàÎèÑÎ°ù Ï†ïÎ≥¥ ÌëúÏãú
                const alternativeUrls = [
                    `${AUDIO_BASE_URL}SF007_Super_Fast_Out_of_Control/${superFastFileMapping[chapterIndex]}`,
                    `${AUDIO_BASE_URL}SF007/${superFastFileMapping[chapterIndex]}`,
                    `${AUDIO_BASE_URL}SuperFast/${superFastFileMapping[chapterIndex]}`
                ];
                
                console.log('Alternative URLs to try:', alternativeUrls);
            };

            audioPlayer.addEventListener('canplaythrough', successHandler, { once: true });
            audioPlayer.addEventListener('error', errorHandler, { once: true });

            currentAudio = audioPlayer;
            playbackSpeed = 1.0;
        }

        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentChapterIndex = 0;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let questions = [];
        let currentAudio = null;
        let playbackSpeed = 1.0;

        // Í∏∞Î≥∏ Ïò§ÎîîÏò§ Ïª®Ìä∏Î°§ Ìï®ÏàòÎì§
        function closeAudioModal() {
            document.getElementById('audio-modal').style.display = 'none';
            if (currentAudio) currentAudio.pause();
        }

        function togglePlayPause() {
            if (!currentAudio) return;
            if (currentAudio.paused) {
                currentAudio.play();
                document.querySelector('.play-pause-btn').textContent = '‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ';
            } else {
                currentAudio.pause();
                document.querySelector('.play-pause-btn').textContent = '‚ñ∂Ô∏è Ïû¨ÏÉù';
            }
        }

        function changeSpeed() {
            if (!currentAudio) return;
            const speeds = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0];
            const currentIndex = speeds.indexOf(playbackSpeed);
            playbackSpeed = speeds[(currentIndex + 1) % speeds.length];
            currentAudio.playbackRate = playbackSpeed;
            document.querySelector('.speed-btn').textContent = `${playbackSpeed}x`;
        }

        function downloadAudio() {
            const audioSource = document.getElementById('audio-source');
            if (audioSource.src) {
                const link = document.createElement('a');
                link.href = audioSource.src;
                link.download = `${document.getElementById('audio-chapter-title').textContent}.mp3`;
                link.click();
            }
        }

        // Marvin Redpost: Super Fast, Out of Control! ÎèÑÏÑú Îç∞Ïù¥ÌÑ∞
        const bookData = {
            id: 'ICR007',
            title: "Super Fast, Out of Control!",
            author: 'Louis Sachar',
            cover: 'üèÉ',
            progress: 0,
            chapters: 8,
            totalQuestions: 40,
            coverColor: 'linear-gradient(45deg, #FF6B9D, #C44569)',
            summary: "Marvin Redpost gets a new bicycle for his birthday - a super fast red bike that he loves! But when he starts riding it, something strange happens. The bike seems to go faster and faster, and Marvin can't control it! He's going so fast that he can't stop, and he's heading straight for trouble. Will Marvin be able to control his super fast bike before something terrible happens? This exciting Level 2 book is perfect for young readers who are building confidence and fluency.",
            chapterList: [
                { title: 'Chapter 1', description: 'Marvin gets a new red bicycle for his birthday and is very excited to ride it.', status: 'current', questionCount: 5 },
                { title: 'Chapter 2', description: 'Marvin starts riding his new bike and notices it goes very fast.', status: 'current', questionCount: 5 },
                { title: 'Chapter 3', description: 'The bicycle seems to be going faster and faster, and Marvin feels scared.', status: 'current', questionCount: 5 },
                { title: 'Chapter 4', description: 'Marvin tries to stop the bike but it won\'t slow down. He\'s out of control!', status: 'current', questionCount: 5 },
                { title: 'Chapter 5', description: 'The runaway bike takes Marvin on a wild ride through the neighborhood.', status: 'current', questionCount: 5 },
                { title: 'Chapter 6', description: 'Marvin realizes he needs to find a way to stop before he gets hurt.', status: 'current', questionCount: 5 },
                { title: 'Chapter 7', description: 'With help from his friends, Marvin learns how to control the fast bicycle.', status: 'current', questionCount: 5 },
                { title: 'Chapter 8', description: 'Marvin finally masters his bike and enjoys riding it safely and happily.', status: 'current', questionCount: 5 }
            ]
        };

        // Î¨∏Ï†ú Îç∞Ïù¥ÌÑ∞ (Level 2Ïóê Ï†ÅÌï©Ìïú Í∞ÑÎã®Ìïú Î¨∏Ï†úÎì§)
        const questionsData = {
            0: [ // Chapter 1
                {
                    passage: "It was Marvin's birthday, and he was very excited. His parents had a special surprise for him in the garage.",
                    question: "What special day was it for Marvin?",
                    options: ["Christmas", "His birthday", "Halloween", "First day of school"],
                    correct: 1
                },
                {
                    passage: "When Marvin opened the garage door, he saw a shiny new red bicycle with a big bow on it.",
                    question: "What did Marvin find in the garage?",
                    options: ["A red car", "A shiny new red bicycle", "A toy truck", "A basketball"],
                    correct: 1
                },
                {
                    passage: "The bicycle was the most beautiful bike Marvin had ever seen. It was bright red and looked super fast.",
                    question: "What color was Marvin's new bicycle?",
                    options: ["Blue", "Green", "Bright red", "Yellow"],
                    correct: 2
                },
                {
                    passage: "Marvin jumped up and down with joy. He couldn't wait to ride his new birthday present.",
                    question: "How did Marvin feel about his new bicycle?",
                    options: ["Sad", "Angry", "Very excited and joyful", "Scared"],
                    correct: 2
                },
                {
                    passage: "His mom and dad smiled as they watched Marvin's happy reaction to his birthday gift.",
                    question: "How did Marvin's parents feel when they saw his reaction?",
                    options: ["They were upset", "They smiled and were happy", "They were worried", "They were surprised"],
                    correct: 1
                }
            ],
            1: [ // Chapter 2
                {
                    passage: "The next morning, Marvin put on his helmet and got ready to ride his new bicycle for the first time.",
                    question: "What did Marvin put on before riding his bike?",
                    options: ["His shoes", "His helmet", "His jacket", "His gloves"],
                    correct: 1
                },
                {
                    passage: "As soon as Marvin started pedaling, he noticed that the bike moved much faster than his old one.",
                    question: "What did Marvin notice about his new bike?",
                    options: ["It was heavier", "It moved much faster", "It was harder to pedal", "It made noise"],
                    correct: 1
                },
                {
                    passage: "The red bicycle seemed to glide down the street like it was flying.",
                    question: "How did the bicycle move down the street?",
                    options: ["Very slowly", "Like it was flying", "It kept stopping", "It made loud noises"],
                    correct: 1
                },
                {
                    passage: "Marvin felt the wind rushing through his hair as he rode faster than ever before.",
                    question: "What did Marvin feel as he rode fast?",
                    options: ["Nothing special", "The wind rushing through his hair", "Very tired", "Cold and shivering"],
                    correct: 1
                },
                {
                    passage: "At first, Marvin thought it was fun to go so fast on his new bicycle.",
                    question: "How did Marvin feel about going fast at first?",
                    options: ["He was scared", "He thought it was fun", "He was angry", "He wanted to stop"],
                    correct: 1
                }
            ],
            2: [ // Chapter 3
                {
                    passage: "But soon, Marvin realized that the bicycle was going faster and faster, even when he wasn't pedaling hard.",
                    question: "What strange thing did Marvin notice about his bike?",
                    options: ["It stopped working", "It went faster even without pedaling hard", "It turned purple", "It made loud music"],
                    correct: 1
                },
                {
                    passage: "Marvin tried to slow down by pedaling less, but the bike kept speeding up.",
                    question: "What happened when Marvin tried to slow down?",
                    options: ["The bike stopped immediately", "The bike kept speeding up", "The bike fell over", "Nothing happened"],
                    correct: 1
                },
                {
                    passage: "He began to feel scared as the bicycle went faster than any bike should go.",
                    question: "How did Marvin start to feel about the fast speed?",
                    options: ["More excited", "Very happy", "Scared", "Sleepy"],
                    correct: 2
                },
                {
                    passage: "The houses and trees were becoming a blur as Marvin zoomed past them.",
                    question: "What happened to the houses and trees as Marvin rode by?",
                    options: ["They became a blur", "They looked bigger", "They disappeared", "They changed colors"],
                    correct: 0
                },
                {
                    passage: "Marvin gripped the handlebars tightly and wondered what was happening to his bicycle.",
                    question: "What did Marvin do as he got more worried?",
                    options: ["He let go of the bike", "He gripped the handlebars tightly", "He closed his eyes", "He started singing"],
                    correct: 1
                }
            ],
            3: [ // Chapter 4
                {
                    passage: "Marvin tried to use the brakes, but they didn't seem to work. The bike just kept going faster.",
                    question: "What happened when Marvin tried to use the brakes?",
                    options: ["The bike stopped quickly", "They didn't work and the bike kept going faster", "The bike fell over", "The bike went backwards"],
                    correct: 1
                },
                {
                    passage: "Now Marvin was really frightened. He was completely out of control on his bicycle.",
                    question: "How did Marvin feel when the brakes didn't work?",
                    options: ["Happy", "Really frightened", "Excited", "Sleepy"],
                    correct: 1
                },
                {
                    passage: "The bicycle was racing down the hill faster than a car, and Marvin couldn't stop it.",
                    question: "How fast was the bicycle going?",
                    options: ["Slower than walking", "Faster than a car", "At normal speed", "Very slowly"],
                    correct: 1
                },
                {
                    passage: "Marvin shouted for help, but he was going too fast for anyone to hear him clearly.",
                    question: "What did Marvin do when he needed help?",
                    options: ["He stayed quiet", "He shouted for help", "He started crying", "He jumped off"],
                    correct: 1
                },
                {
                    passage: "People on the sidewalk stopped and pointed as the red bicycle zoomed past them.",
                    question: "What did people do when they saw Marvin zoom past?",
                    options: ["They ignored him", "They stopped and pointed", "They ran away", "They laughed"],
                    correct: 1
                }
            ],
            4: [ // Chapter 5
                {
                    passage: "The runaway bicycle took Marvin through the park, past the school, and down Main Street.",
                    question: "Where did the runaway bicycle take Marvin?",
                    options: ["Only around his house", "Through the park, past school, and down Main Street", "To the store", "To his friend's house"],
                    correct: 1
                },
                {
                    passage: "Dogs started chasing the bicycle, barking loudly as Marvin sped by.",
                    question: "What did the dogs do when they saw Marvin?",
                    options: ["They slept", "They started chasing and barking", "They ran away", "They ignored him"],
                    correct: 1
                },
                {
                    passage: "Marvin's hair was flying in all directions from the wind as he held on tight.",
                    question: "What was happening to Marvin's hair?",
                    options: ["It stayed perfectly neat", "It was flying in all directions", "It turned green", "It fell out"],
                    correct: 1
                },
                {
                    passage: "The bicycle seemed to have a mind of its own, turning corners without Marvin steering it.",
                    question: "What strange thing was the bicycle doing?",
                    options: ["It stopped working", "It turned corners without Marvin steering", "It went backwards", "It changed colors"],
                    correct: 1
                },
                {
                    passage: "Marvin closed his eyes and hoped that somehow the wild ride would end safely.",
                    question: "What did Marvin hope for?",
                    options: ["To go even faster", "That the wild ride would end safely", "To ride forever", "To get a new bike"],
                    correct: 1
                }
            ],
            5: [ // Chapter 6
                {
                    passage: "Marvin opened his eyes and saw that he was heading straight toward the busy street downtown.",
                    question: "What dangerous situation was Marvin approaching?",
                    options: ["A quiet park", "A busy street downtown", "His home", "A swimming pool"],
                    correct: 1
                },
                {
                    passage: "He knew he had to do something quickly before he reached the dangerous traffic.",
                    question: "What did Marvin realize he needed to do?",
                    options: ["Take a nap", "Do something quickly", "Buy ice cream", "Call his mom"],
                    correct: 1
                },
                {
                    passage: "Marvin remembered what his dad had taught him about emergency stops on bicycles.",
                    question: "What did Marvin remember?",
                    options: ["How to ride faster", "What his dad taught him about emergency stops", "His favorite song", "His lunch"],
                    correct: 1
                },
                {
                    passage: "He tried dragging his feet on the ground, but he was going too fast for that to work.",
                    question: "What did Marvin try to do to stop?",
                    options: ["Drag his feet on the ground", "Jump off immediately", "Close his eyes", "Pedal faster"],
                    correct: 0
                },
                {
                    passage: "Marvin looked around desperately for something soft to steer the bike toward.",
                    question: "What was Marvin looking for?",
                    options: ["A hard wall", "Something soft to steer toward", "A police officer", "His friends"],
                    correct: 1
                }
            ],
            6: [ // Chapter 7
                {
                    passage: "Just then, Marvin's friends Nick and Stuart saw him racing by and started running after him.",
                    question: "Who saw Marvin and tried to help?",
                    options: ["His teacher", "His friends Nick and Stuart", "His parents", "A police officer"],
                    correct: 1
                },
                {
                    passage: "Nick shouted, 'Marvin! Try steering into the grass at the park!'",
                    question: "What advice did Nick give Marvin?",
                    options: ["Keep going fast", "Try steering into the grass at the park", "Jump off the bike", "Close your eyes"],
                    correct: 1
                },
                {
                    passage: "Stuart ran ahead and waved his arms to show Marvin where the soft grass was.",
                    question: "How did Stuart help Marvin?",
                    options: ["He ran away", "He waved his arms to show where the soft grass was", "He called for pizza", "He threw a ball"],
                    correct: 1
                },
                {
                    passage: "Marvin carefully steered the speeding bicycle toward the grassy area of the park.",
                    question: "What did Marvin do with his friends' help?",
                    options: ["He gave up", "He steered toward the grassy area", "He went faster", "He stopped pedaling"],
                    correct: 1
                },
                {
                    passage: "As soon as the bicycle hit the soft grass, it began to slow down and finally stopped.",
                    question: "What happened when the bike hit the grass?",
                    options: ["It went faster", "It began to slow down and stopped", "It exploded", "It turned purple"],
                    correct: 1
                }
            ],
            7: [ // Chapter 8
                {
                    passage: "Marvin fell off the bicycle onto the soft grass, breathing heavily but completely safe.",
                    question: "What happened to Marvin when the bike stopped?",
                    options: ["He got hurt badly", "He fell onto soft grass, safe but breathing heavily", "He kept riding", "He disappeared"],
                    correct: 1
                },
                {
                    passage: "His friends Nick and Stuart ran over to make sure he was okay.",
                    question: "What did Marvin's friends do when he stopped?",
                    options: ["They went home", "They ran over to check if he was okay", "They ignored him", "They started laughing"],
                    correct: 1
                },
                {
                    passage: "Marvin looked at his bicycle and realized that the brakes had been broken the whole time.",
                    question: "What did Marvin discover about his bicycle?",
                    options: ["It was perfect", "The brakes had been broken", "It was the wrong color", "It was too small"],
                    correct: 1
                },
                {
                    passage: "After his dad fixed the brakes, Marvin learned to ride his bicycle safely and had lots of fun.",
                    question: "What happened after the brakes were fixed?",
                    options: ["Marvin was too scared to ride", "Marvin learned to ride safely and had fun", "The bike broke again", "Marvin sold the bike"],
                    correct: 1
                },
                {
                    passage: "From that day on, Marvin always checked his brakes before riding and never had another runaway bike adventure.",
                    question: "What lesson did Marvin learn?",
                    options: ["Never ride bikes", "Always check brakes before riding", "Bikes are dangerous", "Only walk everywhere"],
                    correct: 1
                }
            ]
        };

        // Ï±Ö ÏÉÅÏÑ∏ Ï†ïÎ≥¥ ÌëúÏãú
        function showBookDetail() {
            document.getElementById('book-detail-screen').style.display = 'block';
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'none';
            generateChapterGrid();
            updateProgress();
        }

        // Ï±ïÌÑ∞ Í∑∏Î¶¨Îìú ÏÉùÏÑ±
        function generateChapterGrid() {
            const grid = document.getElementById('chapters-grid');
            grid.innerHTML = '';

            bookData.chapterList.forEach((chapter, index) => {
                const chapterCard = document.createElement('div');
                chapterCard.className = `chapter-card ${chapter.status}`;

                chapterCard.innerHTML = `
                    <div class="chapter-header">
                        <div class="chapter-info">
                            <h4>${chapter.title}</h4>
                            <p>${chapter.description} (${chapter.questionCount}Î¨∏Ï†ú)</p>
                        </div>
                        <div class="chapter-status ${chapter.status}">
                            ${chapter.status === 'completed' ? '‚úÖ ÏôÑÎ£å' :
                              chapter.status === 'current' ? 'üìñ ÏßÑÌñâÏ§ë' : 'üîí Ïû†ÍπÄ'}
                        </div>
                    </div>
                    <div class="chapter-actions">
                        <button class="chapter-btn audio-btn" onclick="playChapterAudio(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            üéß Ïò§ÎîîÏò§
                        </button>
                        <button class="chapter-btn quiz-btn" onclick="startLearning(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            üìù Î¨∏Ï†úÌíÄÍ∏∞
                        </button>
                    </div>
                `;

                grid.appendChild(chapterCard);
            });
        }

        // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
        function updateProgress() {
            const completedChapters = bookData.chapterList.filter(chapter => chapter.status === 'completed').length;
            const progressPercent = Math.round((completedChapters / bookData.chapters) * 100);
            document.getElementById('progress-value').textContent = `${progressPercent}%`;
        }

        // ÌïôÏäµ ÏãúÏûë
        function startLearning(chapterIndex) {
            if (bookData.chapterList[chapterIndex].status === 'locked') return;

            currentChapterIndex = chapterIndex;
            currentQuestionIndex = 0;
            userAnswers = [];
            questions = questionsData[chapterIndex] || [];

            if (questions.length === 0) {
                alert('Ïù¥ Ï±ïÌÑ∞Ïùò Î¨∏Ï†úÍ∞Ä Ï§ÄÎπÑÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                return;
            }

            document.getElementById('book-detail-screen').style.display = 'none';
            document.getElementById('learning-screen').style.display = 'block';
            document.getElementById('result-screen').style.display = 'none';

            const chapter = bookData.chapterList[chapterIndex];
            document.getElementById('learning-title').textContent = chapter.title;
            document.getElementById('learning-chapter-breadcrumb').textContent = chapter.title;

            showQuestion();
        }

        // Î¨∏Ï†ú ÌëúÏãú
        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                submitAnswers();
                return;
            }

            const question = questions[currentQuestionIndex];
            const container = document.getElementById('question-container');

            container.innerHTML = `
                <div class="passage">${question.passage}</div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, index) =>
                        `<div class="option" onclick="selectOption(${index})" data-index="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>`
                    ).join('')}
                </div>
            `;

            // ÏßÑÎèÑ Î∞î ÏóÖÎç∞Ïù¥Ìä∏
            const progressPercent = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('learning-progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('learning-progress-text').textContent = `Î¨∏Ï†ú ${currentQuestionIndex + 1} / ${questions.length}`;

            // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').style.display = currentQuestionIndex === questions.length - 1 ? 'none' : 'inline-block';
            document.getElementById('submit-btn').style.display = currentQuestionIndex === questions.length - 1 ? 'inline-block' : 'none';

            // Ïù¥Ï†Ñ ÎãµÎ≥ÄÏù¥ ÏûàÎã§Î©¥ ÌëúÏãú
            if (userAnswers[currentQuestionIndex] !== undefined) {
                const selectedOption = container.querySelector(`[data-index="${userAnswers[currentQuestionIndex]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
        }

        // ÏòµÏÖò ÏÑ†ÌÉù
        function selectOption(index) {
            // Í∏∞Ï°¥ ÏÑ†ÌÉù Ï†úÍ±∞
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });

            // ÏÉà ÏÑ†ÌÉù Ï∂îÍ∞Ä
            document.querySelector(`[data-index="${index}"]`).classList.add('selected');
            userAnswers[currentQuestionIndex] = index;
        }

        // Îã§Ïùå Î¨∏Ï†ú
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            }
        }

        // Ïù¥Ï†Ñ Î¨∏Ï†ú
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }

        // ÎãµÏïà Ï†úÏ∂ú
        function submitAnswers() {
            let correctCount = 0;
            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] === questions[i].correct) {
                    correctCount++;
                }
            }

            const score = Math.round((correctCount / questions.length) * 100);

            // Ï±ïÌÑ∞ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            if (score >= 70) { // 70Ï†ê Ïù¥ÏÉÅÏù¥Î©¥ ÌÜµÍ≥º
                bookData.chapterList[currentChapterIndex].status = 'completed';

                // Îã§Ïùå Ï±ïÌÑ∞ Ïû†Í∏à Ìï¥Ï†ú
                if (currentChapterIndex + 1 < bookData.chapterList.length) {
                    if (bookData.chapterList[currentChapterIndex + 1].status === 'locked') {
                        bookData.chapterList[currentChapterIndex + 1].status = 'current';
                    }
                }
            }

            showResult(correctCount, score);
        }

        // Í≤∞Í≥º ÌëúÏãú
        function showResult(correctCount, score) {
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';

            document.getElementById('score-circle').textContent = `${score}%`;
            document.getElementById('total-questions').textContent = `${questions.length}Î¨∏Ï†ú`;
            document.getElementById('correct-answers').textContent = `${correctCount}Î¨∏Ï†ú`;
            document.getElementById('wrong-answers').textContent = `${questions.length - correctCount}Î¨∏Ï†ú`;
            document.getElementById('final-score').textContent = `${score}Ï†ê`;

            let message = '';
            let circleColor = '';

            if (score >= 90) {
                message = 'üåü ÏôÑÎ≤ΩÌï©ÎãàÎã§!';
                circleColor = 'linear-gradient(45deg, #FF6B9D, #C44569)';
            } else if (score >= 80) {
                message = 'üéâ ÌõåÎ•≠Ìï¥Ïöî!';
                circleColor = 'linear-gradient(45deg, #FF6B9D, #C44569)';
            } else if (score >= 70) {
                message = 'üëç ÏûòÌñàÏñ¥Ïöî!';
                circleColor = 'linear-gradient(45deg, #FF6B9D, #C44569)';
            } else {
                message = 'üí™ Îã§Ïãú ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!';
                circleColor = 'linear-gradient(45deg, #ff9800, #f57c00)';
            }

            document.getElementById('result-message').textContent = message;
            document.getElementById('score-circle').style.background = circleColor;
        }

        // Ï±ïÌÑ∞ Îã§Ïãú ÌíÄÍ∏∞
        function retryChapter() {
            startLearning(currentChapterIndex);
        }

        // Îã§Ïùå Ï±ïÌÑ∞
        function nextChapter() {
            if (currentChapterIndex + 1 < bookData.chapterList.length) {
                if (bookData.chapterList[currentChapterIndex + 1].status !== 'locked') {
                    startLearning(currentChapterIndex + 1);
                } else {
                    showBookDetail();
                }
            } else {
                showBookDetail();
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        window.addEventListener('DOMContentLoaded', function() {
            showBookDetail();
        });

        // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('learning-screen').style.display === 'block') {
                if (e.key === 'ArrowLeft') {
                    previousQuestion();
                } else if (e.key === 'ArrowRight') {
                    nextQuestion();
                } else if (e.key >= '1' && e.key <= '4') {
                    const index = parseInt(e.key) - 1;
                    if (index < questions[currentQuestionIndex]?.options.length) {
                        selectOption(index);
                    }
                }
            }

            if (e.key === 'Escape') {
                closeAudioModal();
            }
        });

        // Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        document.addEventListener('DOMContentLoaded', function() {
            const audioPlayer = document.getElementById('audio-player');

            audioPlayer.addEventListener('play', function() {
                document.querySelector('.play-pause-btn').textContent = '‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ';
            });

            audioPlayer.addEventListener('pause', function() {
                document.querySelector('.play-pause-btn').textContent = '‚ñ∂Ô∏è Ïû¨ÏÉù';
            });

            audioPlayer.addEventListener('ended', function() {
                document.querySelector('.play-pause-btn').textContent = '‚ñ∂Ô∏è Ïû¨ÏÉù';
            });
        });
    </script>
</body>
</html>