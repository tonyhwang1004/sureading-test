<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Giver - Level 5 - ìˆ˜ë¦¬ë”©ì–´í•™ì›</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #2C3E50 0%, #3498DB 50%, #5DADE2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* í—¤ë” */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: #666;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
            color: #333;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: #2C3E50;
            color: white;
            transform: translateY(-2px);
        }

        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ */
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        /* ì±… ìƒì„¸ í™”ë©´ */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-size: 0.9rem;
            color: #666;
        }

        .breadcrumb a {
            color: #2C3E50;
            text-decoration: none;
            cursor: pointer;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .book-detail-header {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: flex-start;
        }

        .detail-book-cover {
            width: 150px;
            height: 220px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
            font-weight: bold;
            flex-shrink: 0;
            background: linear-gradient(45deg, #2C3E50, #3498DB);
        }

        .book-info {
            flex: 1;
        }

        .book-info h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .book-info .author {
            font-size: 1.2rem;
            color: #2C3E50;
            margin-bottom: 20px;
        }

        .book-summary {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .book-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2C3E50;
        }

        .stat-box .label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* ì±•í„° ê·¸ë¦¬ë“œ */
        .chapters-section {
            margin-top: 40px;
        }

        .chapters-section h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .chapter-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .chapter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .chapter-card.completed {
            border-color: #28a745;
            background: linear-gradient(135deg, #28a74508, #ffffff);
        }

        .chapter-card.current {
            border-color: #2C3E50;
            background: linear-gradient(135deg, #2C3E5008, #ffffff);
        }

        .chapter-card.locked {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .chapter-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .chapter-info h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .chapter-info p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.5;
        }

        .chapter-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .chapter-status.completed {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .chapter-status.current {
            background: rgba(44, 62, 80, 0.1);
            color: #2C3E50;
        }

        .chapter-status.locked {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .chapter-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .chapter-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .audio-btn {
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            color: white;
        }

        .quiz-btn {
            background: linear-gradient(45deg, #3498DB, #5DADE2);
            color: white;
        }

        .chapter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .chapter-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* í•™ìŠµ í™”ë©´ */
        .learning-screen {
            display: none;
        }

        .learning-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .learning-progress {
            background: #f8f9fa;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .learning-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #2C3E50, #3498DB);
            transition: width 0.3s ease;
        }

        .question-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .passage {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: #e9ecef;
            border-color: #2C3E50;
        }

        .option.selected {
            background: rgba(44, 62, 80, 0.1);
            border-color: #2C3E50;
        }

        .learning-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn {
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            color: white;
        }

        .prev-btn {
            background: #6c757d;
            color: white;
        }

        .submit-btn {
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ê²°ê³¼ í™”ë©´ */
        .result-screen {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .result-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        /* ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ëª¨ë‹¬ */
        .audio-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .audio-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .close-audio {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .audio-player {
            width: 100%;
            margin: 20px 0;
            border-radius: 10px;
        }

        .audio-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .audio-control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-pause-btn {
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            color: white;
        }

        .speed-btn {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .download-btn {
            background: #3498DB;
            color: white;
        }

        .audio-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .audio-info.hidden {
            display: none;
        }

        /* Level 5 íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
        .level-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(45deg, #2C3E50, #3498DB);
            color: white;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .book-detail-header {
                flex-direction: column;
                text-align: center;
            }

            .book-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .learning-controls {
                flex-direction: column;
            }

            .chapter-actions {
                grid-template-columns: 1fr;
            }

            .audio-controls {
                justify-content: center;
                gap: 10px;
            }

            .audio-content {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">ğŸ‘ï¸</div>
                <div class="logo-text">
                    <h1>The Giver</h1>
                    <p>Level 5 - Lois Lowryì˜ ë‰´ë² ë¦¬ ë©”ë‹¬ ìˆ˜ìƒì‘</p>
                </div>
            </div>
            <div class="nav-buttons">
                <a href="http://www.suelibrary.store/" class="nav-btn">ë©”ì¸ìœ¼ë¡œ</a>
            </div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="main-content">
            <!-- ì±… ìƒì„¸ í™”ë©´ -->
            <div class="book-detail-screen" id="book-detail-screen">
                <div class="level-badge">Level 5</div>
                <div class="breadcrumb">
                    <span>The Giver</span>
                </div>

                <div class="book-detail-header">
                    <div class="detail-book-cover">ğŸ‘ï¸</div>
                    <div class="book-info">
                        <h2>The Giver</h2>
                        <div class="author">Lois Lowry</div>
                        <div class="book-summary">
                            In a perfect world without pain, war, fear, or choices, twelve-year-old Jonas lives with his parents and sister. When Jonas is selected as the Receiver of Memory, he begins training with The Giver, who transmits all the memories of the past to him. Through these memories, Jonas discovers the terrible truth about his utopian community and realizes what they have given up for their perfect society. This 1994 Newbery Medal winner explores themes of freedom, choice, and what makes us truly human.
                        </div>
                        <div class="book-stats">
                            <div class="stat-box">
                                <div class="value">23</div>
                                <div class="label">ì±•í„°</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">115</div>
                                <div class="label">ì´ ë¬¸ì œ</div>
                            </div>
                            <div class="stat-box">
                                <div class="value">Level 5</div>
                                <div class="label">ë ˆë²¨</div>
                            </div>
                            <div class="stat-box">
                                <div class="value" id="progress-value">0%</div>
                                <div class="label">ì§„ë„</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chapters-section">
                    <h3>ğŸ‘ï¸ ì±•í„°ë³„ í•™ìŠµ</h3>
                    <div class="chapters-grid" id="chapters-grid">
                        <!-- ì±•í„° ì¹´ë“œë“¤ -->
                    </div>
                </div>
            </div>

            <!-- í•™ìŠµ í™”ë©´ -->
            <div class="learning-screen" id="learning-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">The Giver</a>
                    <span>></span>
                    <span id="learning-chapter-breadcrumb">Chapter 1</span>
                </div>

                <div class="learning-header">
                    <h2 id="learning-title">Chapter 1</h2>
                    <div class="learning-progress">
                        <div class="learning-progress-bar" id="learning-progress-bar" style="width: 0%"></div>
                    </div>
                    <p id="learning-progress-text">ë¬¸ì œ 1 / 5</p>
                </div>

                <div class="question-container" id="question-container">
                    <!-- ë¬¸ì œê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>

                <div class="learning-controls">
                    <button class="control-btn prev-btn" id="prev-btn" onclick="previousQuestion()" disabled>ì´ì „</button>
                    <button class="control-btn next-btn" id="next-btn" onclick="nextQuestion()">ë‹¤ìŒ</button>
                    <button class="control-btn submit-btn" id="submit-btn" onclick="submitAnswers()" style="display: none;">ì œì¶œ</button>
                </div>
            </div>

            <!-- ê²°ê³¼ í™”ë©´ -->
            <div class="result-screen" id="result-screen">
                <div class="breadcrumb">
                    <a onclick="showBookDetail()">The Giver</a>
                    <span>></span>
                    <span>ê²°ê³¼</span>
                </div>

                <div class="result-header">
                    <h2>ğŸ‰ í•™ìŠµ ì™„ë£Œ!</h2>
                    <div class="score-circle" id="score-circle">100%</div>
                    <h3 id="result-message">í›Œë¥­í•©ë‹ˆë‹¤!</h3>
                </div>

                <div class="result-details">
                    <div class="result-stat">
                        <h4>ì´ ë¬¸ì œ</h4>
                        <p id="total-questions">5ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì •ë‹µ</h4>
                        <p id="correct-answers">5ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì˜¤ë‹µ</h4>
                        <p id="wrong-answers">0ë¬¸ì œ</p>
                    </div>
                    <div class="result-stat">
                        <h4>ì ìˆ˜</h4>
                        <p id="final-score">100ì </p>
                    </div>
                </div>

                <div class="result-actions">
                    <button class="control-btn prev-btn" onclick="retryChapter()">ë‹¤ì‹œ í’€ê¸°</button>
                    <button class="control-btn next-btn" onclick="nextChapter()">ë‹¤ìŒ ì±•í„°</button>
                    <button class="control-btn submit-btn" onclick="showBookDetail()">ì±•í„° ëª©ë¡</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ëª¨ë‹¬ -->
    <div class="audio-modal" id="audio-modal">
        <div class="audio-content">
            <button class="close-audio" onclick="closeAudioModal()">Ã—</button>
            <h3 id="audio-chapter-title">Chapter 1</h3>
            <p id="audio-chapter-subtitle">The Giver - Lois Lowry</p>

            <audio class="audio-player" id="audio-player" controls preload="metadata">
                <source id="audio-source" src="" type="audio/mpeg">
                ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </audio>

            <div class="audio-controls">
                <button class="audio-control-btn play-pause-btn" onclick="togglePlayPause()">â–¶ï¸ ì¬ìƒ</button>
                <button class="audio-control-btn speed-btn" onclick="changeSpeed()">1.0x</button>
                <button class="audio-control-btn" onclick="resetToChapterStart()" style="background: #28a745; color: white;">ğŸ”„ êµ¬ê°„ì²˜ìŒ</button>
                <button class="audio-control-btn download-btn" onclick="downloadAudio()">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
            </div>

            <div class="audio-info" id="audio-info">
                <div id="audio-status" style="margin-top: 10px; font-weight: bold; color: #2C3E50;"></div>
            </div>
        </div>
    </div>

    <script>
// ğŸ¯ êµ¬ê¸€ í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ ì˜¤ë””ì˜¤ URL ì„¤ì •
const AUDIO_BASE_URL = 'https://storage.googleapis.com/kim-mom-reading-audio/audio/';

// ğŸ§ The Giver ì™„ë²½í•œ ì‹œê°„ ë§¤í•‘ (ì‹œì‘/ë ì‹œê°„ í¬í•¨)
const giverTimeMapping = {
    0: { startTime: 0, endTime: 411, duration: 411 },           // Chapter 1: 0:00:00 - 0:06:51 (6ë¶„ 51ì´ˆ)
    1: { startTime: 411, endTime: 787, duration: 376 },         // Chapter 2: 0:06:51 - 0:13:07 (6ë¶„ 16ì´ˆ)
    2: { startTime: 787, endTime: 1728, duration: 941 },        // Chapter 3: 0:13:07 - 0:28:48 (15ë¶„ 41ì´ˆ)
    3: { startTime: 1728, endTime: 2323, duration: 595 },       // Chapter 4: 0:28:48 - 0:38:43 (9ë¶„ 55ì´ˆ)
    4: { startTime: 2323, endTime: 3042, duration: 719 },       // Chapter 5: 0:38:43 - 0:50:42 (11ë¶„ 59ì´ˆ)
    5: { startTime: 3042, endTime: 3565, duration: 523 },       // Chapter 6: 0:50:42 - 0:59:25 (8ë¶„ 43ì´ˆ)
    6: { startTime: 3565, endTime: 5291, duration: 1726 },      // Chapter 7: 0:59:25 - 1:28:11 (28ë¶„ 46ì´ˆ)
    7: { startTime: 5291, endTime: 6191, duration: 900 },       // Chapter 8: 1:28:11 - 1:43:11 (15ë¶„)
    8: { startTime: 6191, endTime: 6599, duration: 408 },       // Chapter 9: 1:43:11 - 1:49:59 (6ë¶„ 48ì´ˆ)
    9: { startTime: 6599, endTime: 7473, duration: 874 },       // Chapter 10: 1:49:59 - 2:04:33 (14ë¶„ 34ì´ˆ)
    10: { startTime: 7473, endTime: 8323, duration: 850 },      // Chapter 11: 2:04:33 - 2:18:43 (14ë¶„ 10ì´ˆ)
    11: { startTime: 8323, endTime: 9183, duration: 860 },      // Chapter 12: 2:18:43 - 2:33:03 (14ë¶„ 20ì´ˆ)
    12: { startTime: 9183, endTime: 9666, duration: 483 },      // Chapter 13: 2:33:03 - 2:41:06 (8ë¶„ 3ì´ˆ)
    13: { startTime: 9666, endTime: 10114, duration: 448 },     // Chapter 14: 2:41:06 - 2:48:34 (7ë¶„ 28ì´ˆ)
    14: { startTime: 10114, endTime: 10594, duration: 480 },    // Chapter 15: 2:48:34 - 2:56:34 (8ë¶„)
    15: { startTime: 10594, endTime: 11287, duration: 693 },    // Chapter 16: 2:56:34 - 3:08:07 (11ë¶„ 33ì´ˆ)
    16: { startTime: 11287, endTime: 12124, duration: 837 },    // Chapter 17: 3:08:07 - 3:22:04 (13ë¶„ 57ì´ˆ)
    17: { startTime: 12124, endTime: 12948, duration: 824 },    // Chapter 18: 3:22:04 - 3:35:48 (13ë¶„ 44ì´ˆ)
    18: { startTime: 12948, endTime: 13855, duration: 907 },    // Chapter 19: 3:35:48 - 3:50:55 (15ë¶„ 7ì´ˆ)
    19: { startTime: 13855, endTime: 14462, duration: 607 },    // Chapter 20: 3:50:55 - 4:01:02 (10ë¶„ 7ì´ˆ)
    20: { startTime: 14462, endTime: 15094, duration: 632 },    // Chapter 21: 4:01:02 - 4:11:34 (10ë¶„ 32ì´ˆ)
    21: { startTime: 15094, endTime: 16059, duration: 965 },    // Chapter 22: 4:11:34 - 4:27:39 (16ë¶„ 5ì´ˆ)
    22: { startTime: 16059, endTime: 17220, duration: 1161 }    // Chapter 23: 4:27:39 - 4:47:00 (19ë¶„ 21ì´ˆ)
};

// ì „ì—­ ë³€ìˆ˜
let currentChapter = 0;
let currentQuestion = 0;
let userAnswers = [];
let questions = [];
let currentAudio = null;
let playbackSpeed = 1.0;
let isChapterMode = false; // ì±•í„° ëª¨ë“œ ì—¬ë¶€ (ì±•í„° ëì—ì„œ ìë™ ì •ì§€)

// ğŸ§ ì‹œê°„ì„ ì‹œ:ë¶„:ì´ˆ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
function formatTime(seconds) {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const secs = Math.floor(seconds % 60);

    if (hours > 0) {
        return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    } else {
        return `${minutes}:${secs.toString().padStart(2, '0')}`;
    }
}

// ğŸ§ ì±•í„° ê¸¸ì´ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
function getChapterDuration(chapterIndex) {
    const chapter = giverTimeMapping[chapterIndex];
    if (!chapter) return "0:00";

    const minutes = Math.floor(chapter.duration / 60);
    const seconds = Math.floor(chapter.duration % 60);
    return `${minutes}:${seconds.toString().padStart(2, '0')}`;
}

// ğŸ§ The Giver ì˜¤ë””ì˜¤ URL ìƒì„± í•¨ìˆ˜ (ë‹¨ì¼ íŒŒì¼)
function getAudioUrl(chapterIndex) {
    const fileName = 'The_Giver_Complete.mp3'; // ìˆ˜ì •ëœ íŒŒì¼ëª…
    return {
        primary: `${AUDIO_BASE_URL}TG001_The_Giver/${fileName}`,
        startTime: giverTimeMapping[chapterIndex]?.startTime || 0,
        endTime: giverTimeMapping[chapterIndex]?.endTime || null,
        duration: giverTimeMapping[chapterIndex]?.duration || 0,
        alternatives: [`${AUDIO_BASE_URL}TG001_The_Giver/${fileName}`]
    };
}

// ğŸ§ ì±•í„° ë ê°ì§€ ë° ìë™ ì •ì§€ í•¨ìˆ˜
function monitorChapterEnd(audioPlayer, endTime, chapterIndex) {
    const checkTime = () => {
        if (isChapterMode && audioPlayer.currentTime >= endTime) {
            audioPlayer.pause();

            const audioStatus = document.getElementById('audio-status');
            audioStatus.innerHTML = `âœ… Chapter ${chapterIndex + 1} ì™„ë£Œ! ë‹¤ìŒ ì±•í„°ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ê³„ì† ì¬ìƒí•˜ì„¸ìš”.`;

            document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';

            console.log(`ğŸ Chapter ${chapterIndex + 1} ì™„ë£Œ (${formatTime(endTime)}ì—ì„œ ì •ì§€)`);

            // ë‹¤ìŒ ì±•í„° ìë™ ì œì•ˆ (ì„ íƒì‚¬í•­)
            if (chapterIndex < 22) {
                setTimeout(() => {
                    if (confirm(`Chapter ${chapterIndex + 1}ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. Chapter ${chapterIndex + 2}ë¥¼ ì¬ìƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        playChapterAudio(chapterIndex + 1);
                    }
                }, 1000);
            }

            return;
        }

        // ì¬ìƒ ì¤‘ì´ë©´ ê³„ì† ì²´í¬
        if (!audioPlayer.paused) {
            requestAnimationFrame(checkTime);
        }
    };

    checkTime();
}

// ğŸ§ The Giver ì˜¤ë””ì˜¤ ì¬ìƒ í•¨ìˆ˜ (ì™„ì „ ë²„ì „)
function playChapterAudio(chapterIndex) {
    const chapter = bookData.chapterList[chapterIndex];
    const audioData = getAudioUrl(chapterIndex);

    document.getElementById('audio-modal').style.display = 'flex';
    document.getElementById('audio-chapter-title').textContent = `Chapter ${chapterIndex + 1}`;
    document.getElementById('audio-chapter-subtitle').textContent = `${bookData.title} - ${bookData.author}`;
    document.getElementById('audio-info').classList.remove('hidden');

    const audioPlayer = document.getElementById('audio-player');
    const audioSource = document.getElementById('audio-source');
    const audioStatus = document.getElementById('audio-status');

    // ì±•í„° ëª¨ë“œ í™œì„±í™”
    isChapterMode = true;
    currentChapter = chapterIndex;

    audioStatus.textContent = 'ğŸ”„ ì˜¤ë””ì˜¤ íŒŒì¼ì„ ë¡œë”© ì¤‘...';

    // ë‹¨ì¼ íŒŒì¼ ë¡œë“œ
    audioSource.src = audioData.primary;
    audioPlayer.load();

    const successHandler = function() {
        // ì •í™•í•œ ì±•í„° ì‹œì‘ì ìœ¼ë¡œ ì í”„
        audioPlayer.currentTime = audioData.startTime;

        const startTimeDisplay = formatTime(audioData.startTime);
        const endTimeDisplay = formatTime(audioData.endTime);
        const durationDisplay = getChapterDuration(chapterIndex);

        audioStatus.innerHTML = `âœ… Chapter ${chapterIndex + 1} ì¤€ë¹„ì™„ë£Œ!<br>
                                ğŸ“ êµ¬ê°„: ${startTimeDisplay} ~ ${endTimeDisplay} (${durationDisplay})<br>
                                ğŸµ â–¶ï¸ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”`;

        // ì±•í„° ë ê°ì§€ ì‹œì‘
        monitorChapterEnd(audioPlayer, audioData.endTime, chapterIndex);

        // ì¬ìƒ ë²„íŠ¼ ì´ë²¤íŠ¸ì— ì±•í„° ëª¨ë“œ í‘œì‹œ ì¶”ê°€
        const playPauseBtn = document.querySelector('.play-pause-btn');
        if (playPauseBtn) {
            playPauseBtn.onclick = function() {
                if (audioPlayer.paused) {
                    audioPlayer.play().then(() => {
                        this.textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
                        audioStatus.innerHTML = `ğŸµ Chapter ${chapterIndex + 1} ì¬ìƒ ì¤‘! (${startTimeDisplay}~${endTimeDisplay})`;
                        // ì¬ìƒ ì‹œì‘ì‹œ ì±•í„° ë ê°ì§€ ì¬ì‹œì‘
                        monitorChapterEnd(audioPlayer, audioData.endTime, chapterIndex);
                    }).catch(e => {
                        console.log('ì¬ìƒ ì‹¤íŒ¨:', e);
                        audioStatus.innerHTML = 'âŒ ì¬ìƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    });
                } else {
                    audioPlayer.pause();
                    this.textContent = 'â–¶ï¸ ì¬ìƒ';
                    audioStatus.innerHTML = `â¸ï¸ Chapter ${chapterIndex + 1} ì¼ì‹œì •ì§€ë¨`;
                }
            };
        }
    };

    const errorHandler = function() {
        audioStatus.innerHTML = 'âŒ ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
        console.error('ì˜¤ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨:', audioData.primary);
    };

    audioPlayer.addEventListener('canplaythrough', successHandler, { once: true });
    audioPlayer.addEventListener('error', errorHandler, { once: true });

    currentAudio = audioPlayer;
    playbackSpeed = 1.0;
}

// ğŸ§ ì „ì²´ ì˜¤ë””ì˜¤ë¶ ì¬ìƒ í•¨ìˆ˜ (ì±•í„° êµ¬ë¶„ ì—†ì´ ì—°ì† ì¬ìƒ)
function playFullAudiobook() {
    isChapterMode = false; // ì±•í„° ëª¨ë“œ ë¹„í™œì„±í™”

    const audioPlayer = document.getElementById('audio-player');
    const audioSource = document.getElementById('audio-source');
    const audioStatus = document.getElementById('audio-status');

    document.getElementById('audio-modal').style.display = 'flex';
    document.getElementById('audio-chapter-title').textContent = 'The Giver - ì „ì²´ ì¬ìƒ';
    document.getElementById('audio-chapter-subtitle').textContent = 'ì—°ì† ì¬ìƒ ëª¨ë“œ';

    audioStatus.textContent = 'ğŸ”„ ì „ì²´ ì˜¤ë””ì˜¤ë¶ ë¡œë”© ì¤‘...';

    audioSource.src = `${AUDIO_BASE_URL}TG001_The_Giver/The_Giver_Complete.mp3`;
    audioPlayer.load();

    audioPlayer.addEventListener('canplaythrough', function() {
        audioPlayer.currentTime = 0; // ì²˜ìŒë¶€í„° ì‹œì‘
        audioStatus.innerHTML = 'âœ… ì „ì²´ ì˜¤ë””ì˜¤ë¶ ì¤€ë¹„ì™„ë£Œ! (ì´ 4ì‹œê°„ 47ë¶„)<br>ğŸµ â–¶ï¸ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”';
    }, { once: true });
}

// ğŸ§ êµ¬ê°„ì²˜ìŒìœ¼ë¡œ í•¨ìˆ˜ (í˜„ì¬ ì±•í„° ì‹œì‘ì ìœ¼ë¡œ)
function resetToChapterStart() {
    if (!currentAudio) return;

    if (isChapterMode) {
        const startTime = giverTimeMapping[currentChapter]?.startTime || 0;
        currentAudio.currentTime = startTime;

        const timeDisplay = formatTime(startTime);
        console.log(`ğŸ”„ Chapter ${currentChapter + 1} ì‹œì‘ì ìœ¼ë¡œ ì´ë™: ${timeDisplay}`);

        const audioStatus = document.getElementById('audio-status');
        audioStatus.innerHTML = `ğŸ”„ Chapter ${currentChapter + 1} ì‹œì‘ì ìœ¼ë¡œ ì´ë™: ${timeDisplay}`;
    } else {
        currentAudio.currentTime = 0;
        console.log('ğŸ”„ ì „ì²´ ì˜¤ë””ì˜¤ë¶ ì²˜ìŒìœ¼ë¡œ ì´ë™');
    }
}

// ğŸ§ ë‹¤ìŒ ì±•í„°ë¡œ ì´ë™ í•¨ìˆ˜
function jumpToNextChapter() {
    if (!currentAudio || !isChapterMode) return;

    const nextChapterIdx = currentChapter + 1;

    if (nextChapterIdx < 23) {
        playChapterAudio(nextChapterIdx);
    } else {
        alert('ë§ˆì§€ë§‰ ì±•í„°ì…ë‹ˆë‹¤!');
    }
}

// ğŸ§ ì´ì „ ì±•í„°ë¡œ ì´ë™ í•¨ìˆ˜
function jumpToPreviousChapter() {
    if (!currentAudio || !isChapterMode) return;

    const prevChapterIdx = currentChapter - 1;

    if (prevChapterIdx >= 0) {
        playChapterAudio(prevChapterIdx);
    } else {
        alert('ì²« ë²ˆì§¸ ì±•í„°ì…ë‹ˆë‹¤!');
    }
}

// ğŸ§ íŠ¹ì • ì‹œê°„ìœ¼ë¡œ ì í”„í•˜ëŠ” í•¨ìˆ˜
function jumpToTime(timeInSeconds) {
    if (!currentAudio) return;

    currentAudio.currentTime = timeInSeconds;
    const timeDisplay = formatTime(timeInSeconds);
    console.log(`â° ${timeDisplay}ë¡œ ì´ë™`);
}

// ğŸ§ í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì±•í„° ì •ë³´ í‘œì‹œ
function getCurrentChapterInfo() {
    if (!currentAudio || !isChapterMode) return null;

    const currentTime = currentAudio.currentTime;
    let currentChapterInfo = null;

    // í˜„ì¬ ì‹œê°„ì´ ì–´ëŠ ì±•í„°ì— ì†í•˜ëŠ”ì§€ ì°¾ê¸°
    for (let i = 0; i < 23; i++) {
        const chapter = giverTimeMapping[i];
        if (currentTime >= chapter.startTime && currentTime < chapter.endTime) {
            currentChapterInfo = {
                chapterNumber: i + 1,
                startTime: formatTime(chapter.startTime),
                endTime: formatTime(chapter.endTime),
                currentTime: formatTime(currentTime),
                progress: Math.round(((currentTime - chapter.startTime) / chapter.duration) * 100)
            };
            break;
        }
    }

    return currentChapterInfo;
}

// ğŸ§ ì±•í„° ì •ë³´ë¥¼ UIì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
function updateChapterDisplay() {
    const info = getCurrentChapterInfo();
    if (info) {
        const audioStatus = document.getElementById('audio-status');
        audioStatus.innerHTML = `ğŸµ Chapter ${info.chapterNumber} ì¬ìƒ ì¤‘ (${info.progress}% ì™„ë£Œ)<br>
                                ğŸ“ ${info.currentTime} / ${info.endTime}`;
    }
}

// ğŸ§ ì´ˆê¸°í™” í•¨ìˆ˜
function initializeGiverAudio() {
    console.log('ğŸ§ The Giver ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
    console.log('ğŸ“š ì´ 23ê°œ ì±•í„°, 4ì‹œê°„ 47ë¶„');
    console.log('ğŸ¯ ì±•í„°ë³„ ì •í™•í•œ ì‹œì‘/ë ì‹œê°„ ì„¤ì •ë¨');

    // 5ì´ˆë§ˆë‹¤ ì±•í„° ì •ë³´ ì—…ë°ì´íŠ¸ (ì„ íƒì‚¬í•­)
    setInterval(() => {
        if (currentAudio && !currentAudio.paused && isChapterMode) {
            updateChapterDisplay();
        }
    }, 5000);
}

// ì´ˆê¸°í™” ì‹¤í–‰
document.addEventListener('DOMContentLoaded', initializeGiverAudio);



        // ê¸°ë³¸ ì˜¤ë””ì˜¤ ì»¨íŠ¸ë¡¤ í•¨ìˆ˜ë“¤
        function closeAudioModal() {
            document.getElementById('audio-modal').style.display = 'none';
            if (currentAudio) currentAudio.pause();
        }

        function togglePlayPause() {
            if (!currentAudio) return;
            if (currentAudio.paused) {
                currentAudio.play();
                document.querySelector('.play-pause-btn').textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
            } else {
                currentAudio.pause();
                document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
            }
        }

        function changeSpeed() {
            if (!currentAudio) return;
            const speeds = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0];
            const currentIndex = speeds.indexOf(playbackSpeed);
            playbackSpeed = speeds[(currentIndex + 1) % speeds.length];
            currentAudio.playbackRate = playbackSpeed;
            document.querySelector('.speed-btn').textContent = `${playbackSpeed}x`;
        }

        function downloadAudio() {
            const audioSource = document.getElementById('audio-source');
            if (audioSource.src) {
                const link = document.createElement('a');
                link.href = audioSource.src;
                link.download = `${document.getElementById('audio-chapter-title').textContent}.mp3`;
                link.click();
            }
        }

        // The Giver ë„ì„œ ë°ì´í„° (ì •í™•í•œ 23ì±•í„°)
        const bookData = {
            id: 'TG001',
            title: "The Giver",
            author: 'Lois Lowry',
            cover: 'ğŸ‘ï¸',
            progress: 0,
            chapters: 23,
            totalQuestions: 115,
            coverColor: 'linear-gradient(45deg, #2C3E50, #3498DB)',
            summary: "In a perfect world without pain, war, fear, or choices, twelve-year-old Jonas lives with his parents and sister. When Jonas is selected as the Receiver of Memory, he begins training with The Giver, who transmits all the memories of the past to him. Through these memories, Jonas discovers the terrible truth about his utopian community and realizes what they have given up for their perfect society. This 1994 Newbery Medal winner explores themes of freedom, choice, and what makes us truly human.",
            chapterList: [
                { title: 'Chapter 1', description: 'Jonas feels apprehensive about the December Ceremony of Twelve where he will receive his life Assignment.', status: 'current', questionCount: 5 },
                { title: 'Chapter 2', description: 'Jonas learns about the ceremony system and his father brings home baby Gabriel for extra care.', status: 'current', questionCount: 5 },
                { title: 'Chapter 3', description: 'Jonas notices something strange about an apple that seems to change, though no one else can see it.', status: 'current', questionCount: 5 },
                { title: 'Chapter 4', description: 'Jonas volunteers at the House of the Old and has his first Stirrings - confusing new feelings.', status: 'current', questionCount: 5 },
                { title: 'Chapter 5', description: 'Jonas tells his family about his Stirrings and begins taking daily pills to suppress them.', status: 'current', questionCount: 5 },
                { title: 'Chapter 6', description: 'The December Ceremony begins, and children receive their life Assignments based on their age groups.', status: 'current', questionCount: 5 },
                { title: 'Chapter 7', description: 'At the Ceremony of Twelve, Jonas is skipped over when Assignments are given, causing anxiety and confusion.', status: 'current', questionCount: 5 },
                { title: 'Chapter 8', description: 'Jonas is selected as the new Receiver of Memory, the most honored position in the community.', status: 'current', questionCount: 5 },
                { title: 'Chapter 9', description: 'Jonas receives his training instructions, which are very different from other Assignments - he can lie and ask questions.', status: 'current', questionCount: 5 },
                { title: 'Chapter 10', description: 'Jonas meets The Giver and begins his training, receiving his first memory - sledding down a snowy hill.', status: 'current', questionCount: 5 },
                { title: 'Chapter 11', description: 'Jonas experiences more memories including sunshine, sunburn, and pain, learning about the world before Sameness.', status: 'current', questionCount: 5 },
                { title: 'Chapter 12', description: 'Jonas begins to see color, starting with red, and learns how the community eliminated color and choice.', status: 'current', questionCount: 5 },
                { title: 'Chapter 13', description: 'Jonas learns about animals and death through painful memories, including seeing an elephant killed by poachers.', status: 'current', questionCount: 5 },
                { title: 'Chapter 14', description: 'Jonas receives memories of war and extreme pain, and accidentally transmits a calming memory to baby Gabriel.', status: 'current', questionCount: 5 },
                { title: 'Chapter 15', description: 'Jonas experiences a traumatic memory of war and death, understanding the terrible burden The Giver carries.', status: 'current', questionCount: 5 },
                { title: 'Chapter 16', description: 'Jonas receives The Giver\'s favorite memory of Christmas and family love, but his own family cannot understand love.', status: 'current', questionCount: 5 },
                { title: 'Chapter 17', description: 'Jonas stops taking his pills and his Stirrings return. He realizes his friends are playing war games without understanding.', status: 'current', questionCount: 5 },
                { title: 'Chapter 18', description: 'The Giver tells Jonas about Rosemary, the previous Receiver who failed and asked for release ten years ago.', status: 'current', questionCount: 5 },
                { title: 'Chapter 19', description: 'Jonas watches a video of his father releasing a newborn twin and realizes that release means death.', status: 'current', questionCount: 5 },
                { title: 'Chapter 20', description: 'Horrified by the truth about release, Jonas and The Giver plan Jonas\'s escape to return memories to the community.', status: 'current', questionCount: 5 },
                { title: 'Chapter 21', description: 'When Gabriel is scheduled for release, Jonas takes him and flees the community earlier than planned.', status: 'current', questionCount: 5 },
                { title: 'Chapter 22', description: 'Jonas and Gabriel travel through unfamiliar terrain, facing hunger, cold, and the challenges of the outside world.', status: 'current', questionCount: 5 },
                { title: 'Chapter 23', description: 'Near death from cold and starvation, Jonas finds the sled from his first memory and slides toward Elsewhere with Gabriel.', status: 'current', questionCount: 5 }
            ]
        };

        // ë¬¸ì œ ë°ì´í„° (ì‹¤ì œ ì±… ë‚´ìš© ê¸°ë°˜) - ì „ì²´ 23ì±•í„°
        const questionsData = {
            0: [ // Chapter 1
                {
                    passage: "It was almost December, and Jonas was beginning to be frightened. No. Wrong word, Jonas thought. Frightened meant that deep, sickening feeling of something terrible about to happen.",
                    question: "What word does Jonas decide better describes his feelings about the December ceremony?",
                    options: ["Scared", "Apprehensive", "Worried", "Nervous"],
                    correct: 1
                },
                {
                    passage: "He had been frightened then. The sense of his own community silent, waiting, had made his stomach churn. He had been really, truly frightened.",
                    question: "What event made Jonas feel truly frightened in the past?",
                    options: ["A fire in the community", "An unidentified aircraft flying over the community", "Getting lost in the community", "A flood"],
                    correct: 1
                },
                {
                    passage: "NEEDLESS TO SAY, HE WILL BE RELEASED, the voice had said, followed by silence.",
                    question: "What happened to the pilot who flew over the community?",
                    options: ["He was promoted", "He was released", "He was given a warning", "He was transferred"],
                    correct: 1
                },
                {
                    passage: "During the nightly sharing of feelings, each family member tells about something that happened during the day.",
                    question: "What is the nightly ritual called in Jonas's family?",
                    options: ["Sharing of memories", "Telling of feelings", "Daily reports", "Evening discussions"],
                    correct: 1
                },
                {
                    passage: "His parents were both concerned about different things, and they gave him advice about his Assignment.",
                    question: "What is Jonas worried about regarding December?",
                    options: ["The weather", "His birthday party", "The Ceremony of Twelve and his Assignment", "School examinations"],
                    correct: 2
                }
            ],
            1: [ // Chapter 2
                {
                    passage: "\"The Ceremony of Twelve is the last of the Ceremonies. After that, no more official recognition of your progression through childhood.\"",
                    question: "What makes the Ceremony of Twelve special compared to other ceremonies?",
                    options: ["It's the biggest party", "It's the last ceremony of childhood", "It's when you get married", "It's when you choose your name"],
                    correct: 1
                },
                {
                    passage: "\"At the Ceremony, you'll be assigned your life's work. After that, you'll be an adult.\"",
                    question: "What happens to Jonas at the Ceremony of Twelve?",
                    options: ["He chooses his own job", "He gets assigned his life's work", "He moves to a new house", "He receives a new name"],
                    correct: 1
                },
                {
                    passage: "\"I broke the rules this afternoon and looked up his name. I wanted to give him a chance.\"",
                    question: "What rule did Jonas's father break?",
                    options: ["He stayed late at work", "He looked up a newchild's name before naming day", "He brought work home", "He skipped dinner"],
                    correct: 1
                },
                {
                    passage: "\"His name will be Gabriel, if he makes it to Naming Day.\"",
                    question: "Why might Gabriel not make it to Naming Day?",
                    options: ["He might be transferred to another community", "He might be released", "He might be adopted early", "He might get sick"],
                    correct: 1
                },
                {
                    passage: "Family units can only have two children, one male and one female.",
                    question: "How are children distributed to family units?",
                    options: ["Families can choose how many children they want", "Each family gets exactly two children, one male and one female", "Only wealthy families get children", "Children are assigned randomly"],
                    correct: 1
                }
            ],
            2: [ // Chapter 3
                {
                    passage: "Jonas's father brought the newchild Gabriel home for extra nurturing, as he was not developing as well as he should.",
                    question: "Why did Jonas's father bring Gabriel home?",
                    options: ["Gabriel needed extra nurturing", "It was Gabriel's naming day", "The family requested a baby", "Gabriel was being released"],
                    correct: 0
                },
                {
                    passage: "The newchild had pale eyes, like Jonas did. Light eyes were very rare in the community.",
                    question: "What physical characteristic do Jonas and Gabriel share?",
                    options: ["Dark hair", "Pale, light-colored eyes", "Tall height", "Small hands"],
                    correct: 1
                },
                {
                    passage: "\"Maybe he had the same Birthmother as you.\"",
                    question: "Why does Mother suggest Jonas and Gabriel might be related?",
                    options: ["They act similarly", "They both have pale eyes", "They were born in the same year", "They like the same foods"],
                    correct: 1
                },
                {
                    passage: "Birthmothers never see their newchildren. Once the newchildren are named, they are handed to their assigned families.",
                    question: "What happens to Birthmothers after they give birth?",
                    options: ["They raise their children", "They never see their newchildren", "They choose the families", "They name the children"],
                    correct: 1
                },
                {
                    passage: "There weren't many mirrors in the community, so Jonas didn't think much about his light eyes.",
                    question: "Why doesn't Jonas think about his unusual eye color?",
                    options: ["Everyone has light eyes", "There aren't many mirrors in the community", "His parents told him not to", "He's color blind"],
                    correct: 1
                }
            ],
            3: [ // Chapter 4
                {
                    passage: "Jonas volunteers at the House of the Old, where he helps care for the elderly community members.",
                    question: "Where does Jonas volunteer his hours?",
                    options: ["The Nurturing Center", "The House of the Old", "The Department of Justice", "The school"],
                    correct: 1
                },
                {
                    passage: "While at the House of the Old, Jonas helps with feeding and bathing the residents who can no longer care for themselves.",
                    question: "What kind of work does Jonas do at his volunteer assignment?",
                    options: ["Teaching children", "Helping feed and bathe elderly residents", "Delivering messages", "Cleaning buildings"],
                    correct: 1
                },
                {
                    passage: "Jonas enjoys working with the Old because they have stories and seem different from other community members.",
                    question: "Why does Jonas like volunteering at the House of the Old?",
                    options: ["It's easy work", "The Old have stories and seem different", "He gets extra food", "His friends work there"],
                    correct: 1
                },
                {
                    passage: "At the House of the Old, Jonas meets Larissa, who tells him about the release ceremony of Roberto.",
                    question: "Who tells Jonas about Roberto's release ceremony?",
                    options: ["His mother", "Larissa", "The Chief Elder", "Asher"],
                    correct: 1
                },
                {
                    passage: "Larissa describes how wonderful Roberto's release ceremony was, with speeches celebrating his life.",
                    question: "How does Larissa describe Roberto's release ceremony?",
                    options: ["Sad and somber", "Wonderful with speeches celebrating his life", "Quick and simple", "Private with no ceremony"],
                    correct: 1
                }
            ],
            4: [ // Chapter 5
                {
                    passage: "Jonas wakes up from a confusing dream and feels strange new sensations that he doesn't understand.",
                    question: "What happens to Jonas at the beginning of this chapter?",
                    options: ["He gets sick", "He has confusing dreams and strange new feelings", "He argues with his parents", "He loses something important"],
                    correct: 1
                },
                {
                    passage: "During the sharing of feelings, Jonas reluctantly tells his family about his confusing dream.",
                    question: "What does Jonas share with his family?",
                    options: ["His fears about the Ceremony", "His confusing dream", "His volunteer work", "His friends' problems"],
                    correct: 1
                },
                {
                    passage: "Jonas's parents explain that he is experiencing Stirrings, which are natural but must be controlled.",
                    question: "What do Jonas's parents call his new feelings?",
                    options: ["Growing pains", "Stirrings", "Assignment anxiety", "Community service"],
                    correct: 1
                },
                {
                    passage: "Mother gives Jonas pills that he must take each morning to suppress his Stirrings.",
                    question: "What solution do Jonas's parents give him for the Stirrings?",
                    options: ["Extra exercise", "More volunteer hours", "Daily pills to suppress them", "Special counseling"],
                    correct: 2
                },
                {
                    passage: "Jonas learns that all adults in the community take the same pills to control their emotions and desires.",
                    question: "Who else takes the pills Jonas now must take?",
                    options: ["Only teenagers", "All adults in the community", "Just his parents", "People with problems"],
                    correct: 1
                }
            ],
            5: [ // Chapter 6
                {
                    passage: "The December Ceremony begins with the naming and placement of the newchildren with their family units.",
                    question: "How does the December Ceremony begin?",
                    options: ["With speeches by Elders", "With naming and placement of newchildren", "With the Ceremony of Twelve", "With a community meal"],
                    correct: 1
                },
                {
                    passage: "Gabriel has been selected to receive extra nurturing for one more year instead of being assigned to a family.",
                    question: "What happens to Gabriel at the Ceremony?",
                    options: ["He's assigned to Jonas's family", "He receives extra nurturing for one more year", "He's released from the community", "He's moved to another community"],
                    correct: 1
                },
                {
                    passage: "The Ceremony continues through each age group, with children receiving new privileges and responsibilities.",
                    question: "How does the Ceremony proceed?",
                    options: ["All ages together", "Through each age group with new privileges", "Only for the Twelves", "Randomly selected children"],
                    correct: 1
                },
                {
                    passage: "The Eights receive their jackets with smaller buttons, symbolizing their growing independence.",
                    question: "What do the Eights receive at the Ceremony?",
                    options: ["Bicycles", "Comfort objects", "Jackets with smaller buttons", "New names"],
                    correct: 2
                },
                {
                    passage: "The Nines are given bicycles, which represent their increased freedom to travel within the community.",
                    question: "What significant gift do the Nines receive?",
                    options: ["Jackets", "Bicycles", "Books", "Job assignments"],
                    correct: 1
                }
            ],
            6: [ // Chapter 7
                {
                    passage: "At the Ceremony of Twelve, Jonas watches as his friends receive their life Assignments one by one.",
                    question: "What happens at the Ceremony of Twelve?",
                    options: ["Children choose their own jobs", "Children receive their life Assignments", "Children graduate from school", "Children get married"],
                    correct: 1
                },
                {
                    passage: "Asher is assigned to be Director of Recreation, which seems perfect for his playful personality.",
                    question: "What Assignment does Asher receive?",
                    options: ["Nurturer", "Director of Recreation", "Instructor of Threes", "Pilot"],
                    correct: 1
                },
                {
                    passage: "Fiona receives the Assignment of Caretaker of the Old, working at the House of the Old.",
                    question: "What will be Fiona's life work?",
                    options: ["Birthmother", "Caretaker of the Old", "Food Production", "Instructor"],
                    correct: 1
                },
                {
                    passage: "When Jonas's turn comes, the Chief Elder skips over him without giving him an Assignment.",
                    question: "What happens when it's Jonas's turn to receive his Assignment?",
                    options: ["He gets the same job as his father", "The Chief Elder skips over him", "He's assigned to be a Pilot", "He refuses his Assignment"],
                    correct: 1
                },
                {
                    passage: "Jonas feels confused and embarrassed as the ceremony continues without him receiving an Assignment.",
                    question: "How does Jonas feel when he's skipped over?",
                    options: ["Relieved and happy", "Confused and embarrassed", "Angry and defiant", "Proud and excited"],
                    correct: 1
                }
            ],
            7: [ // Chapter 8
                {
                    passage: "At the end of the ceremony, the Chief Elder explains that Jonas wasn't given an Assignment because he was selected.",
                    question: "Why didn't Jonas receive a regular Assignment?",
                    options: ["He failed his evaluations", "He was selected for something special", "He was too young", "He requested a delay"],
                    correct: 1
                },
                {
                    passage: "Jonas has been chosen to be the new Receiver of Memory, the most honored position in the community.",
                    question: "What position has Jonas been selected for?",
                    options: ["Chief Elder", "Receiver of Memory", "Director of Recreation", "Head Nurturer"],
                    correct: 1
                },
                {
                    passage: "The Chief Elder explains that the Receiver must have intelligence, integrity, courage, and the Capacity to See Beyond.",
                    question: "What qualities must the Receiver have?",
                    options: ["Strength and speed", "Intelligence, integrity, courage, and Capacity to See Beyond", "Artistic ability", "Leadership skills"],
                    correct: 1
                },
                {
                    passage: "The crowd becomes silent and respectful when they learn of Jonas's selection as Receiver.",
                    question: "How does the community react to Jonas's selection?",
                    options: ["They cheer loudly", "They become silent and respectful", "They seem disappointed", "They leave the ceremony"],
                    correct: 1
                },
                {
                    passage: "Jonas feels both honored and frightened by his selection to this important but mysterious position.",
                    question: "How does Jonas feel about being chosen as Receiver?",
                    options: ["Only excited", "Both honored and frightened", "Completely terrified", "Disappointed"],
                    correct: 1
                }
            ],
            8: [ // Chapter 9
                {
                    passage: "Jonas receives special instructions for his training that are very different from other Assignments.",
                    question: "What makes Jonas's training instructions unique?",
                    options: ["They're the same as everyone else's", "They're very different from other Assignments", "They're written in a foreign language", "They're given verbally only"],
                    correct: 1
                },
                {
                    passage: "The instructions allow Jonas to ask questions of anyone and to not apply for release under any circumstances.",
                    question: "What unusual permissions do Jonas's instructions include?",
                    options: ["To skip school", "To ask questions of anyone and not apply for release", "To travel outside the community", "To choose his own schedule"],
                    correct: 1
                },
                {
                    passage: "Jonas is exempted from rules governing rudeness and is allowed to lie if necessary.",
                    question: "What rule exemptions does Jonas receive?",
                    options: ["From taking medication", "From rudeness rules and allowed to lie", "From attending ceremonies", "From family sharing time"],
                    correct: 1
                },
                {
                    passage: "The final instruction states that Jonas is prohibited from sharing his training with anyone, including family.",
                    question: "What is Jonas prohibited from doing regarding his training?",
                    options: ["Taking notes", "Sharing it with anyone, including family", "Missing sessions", "Asking questions"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes that his life will be very different and lonely because of the secrecy required.",
                    question: "What does Jonas realize about his future life?",
                    options: ["It will be exactly like before", "It will be very different and lonely due to secrecy", "It will be more social", "It will be easier"],
                    correct: 1
                }
            ],
            9: [ // Chapter 10
                {
                    passage: "Jonas reports to the Annex behind the House of the Old to begin his training with the current Receiver.",
                    question: "Where does Jonas go for his training?",
                    options: ["The school", "The Annex behind the House of the Old", "The Nurturing Center", "His own home"],
                    correct: 1
                },
                {
                    passage: "The Receiver's dwelling is filled with books, which are forbidden to everyone else in the community.",
                    question: "What does Jonas notice about the Receiver's dwelling?",
                    options: ["It's very small", "It's filled with books", "It has no furniture", "It's completely dark"],
                    correct: 1
                },
                {
                    passage: "The old Receiver tells Jonas that he will now be called The Giver, and Jonas will be the new Receiver.",
                    question: "What does the old Receiver tell Jonas to call him?",
                    options: ["Teacher", "The Giver", "Master", "Father"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that he will transmit all the memories of the world to Jonas through touch.",
                    question: "How will The Giver share memories with Jonas?",
                    options: ["Through books", "Through touch", "Through speaking", "Through pictures"],
                    correct: 1
                },
                {
                    passage: "Jonas learns that he must receive all the memories of pain and joy that the community has given up.",
                    question: "What kind of memories must Jonas receive?",
                    options: ["Only happy ones", "All memories of pain and joy the community gave up", "Only recent memories", "Only his own memories"],
                    correct: 1
                }
            ],
            10: [ // Chapter 11
                {
                    passage: "The Giver transmits Jonas's first memory: the exhilarating experience of sledding down a snowy hill.",
                    question: "What is Jonas's first transmitted memory?",
                    options: ["A birthday party", "Sledding down a snowy hill", "A family dinner", "Playing in a garden"],
                    correct: 1
                },
                {
                    passage: "Jonas experiences snow and cold for the first time, sensations unknown in his climate-controlled community.",
                    question: "What new sensations does Jonas experience in his first memory?",
                    options: ["Heat and fire", "Snow and cold", "Wind and rain", "Flowers and perfume"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that Climate Control eliminated weather, hills, and snow to create Sameness.",
                    question: "Why doesn't Jonas's community have weather or hills?",
                    options: ["They moved underground", "Climate Control created Sameness by eliminating them", "They live in a desert", "They're in a different world"],
                    correct: 1
                },
                {
                    passage: "Jonas receives a memory of sunshine and warmth, then experiences sunburn to understand pain.",
                    question: "What does Jonas experience to learn about pain?",
                    options: ["A broken bone", "Sunburn", "A bee sting", "Falling down"],
                    correct: 1
                },
                {
                    passage: "The Giver tells Jonas that receiving memories is his burden, but also his honor.",
                    question: "How does The Giver describe receiving memories?",
                    options: ["Only a punishment", "Both a burden and an honor", "Just a job", "Easy and fun"],
                    correct: 1
                }
            ],
            11: [ // Chapter 12
                {
                    passage: "Jonas begins to see flashes of color, starting with red, which he notices in Fiona's hair and an apple.",
                    question: "What new ability does Jonas develop?",
                    options: ["Reading minds", "Seeing color, starting with red", "Flying", "Time travel"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that Jonas is beginning to see color, which was eliminated from the community long ago.",
                    question: "What does The Giver tell Jonas about color?",
                    options: ["It never existed", "It was eliminated from the community long ago", "Only he can see it", "It's dangerous"],
                    correct: 1
                },
                {
                    passage: "Jonas learns that the community chose Sameness over the unpredictability of color and choice.",
                    question: "Why did the community eliminate color?",
                    options: ["It was too expensive", "They chose Sameness over unpredictability", "It made people sick", "It was impossible to control"],
                    correct: 1
                },
                {
                    passage: "The Giver shows Jonas a memory of a rainbow, revealing the beauty the community has given up.",
                    question: "What colorful memory does The Giver share with Jonas?",
                    options: ["A sunset", "A rainbow", "Colorful flowers", "A painted house"],
                    correct: 1
                },
                {
                    passage: "Jonas questions whether it was right for the community to eliminate color and choice.",
                    question: "What does Jonas begin to question?",
                    options: ["His parents' love", "Whether eliminating color and choice was right", "The Giver's honesty", "His own abilities"],
                    correct: 1
                }
            ],
            12: [ // Chapter 13
                {
                    passage: "The Giver transmits a painful memory of an elephant being killed by poachers, showing Jonas death and loss.",
                    question: "What painful memory involving animals does Jonas receive?",
                    options: ["A dog being hit by a car", "An elephant being killed by poachers", "A bird with a broken wing", "A cat being abandoned"],
                    correct: 1
                },
                {
                    passage: "Jonas learns that animals existed in the past but were eliminated from the community like color.",
                    question: "What does Jonas learn about animals?",
                    options: ["They never existed", "They existed but were eliminated like color", "They live in another community", "Only he can see them"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that the community gave up too much when they chose Sameness.",
                    question: "What is The Giver's opinion about Sameness?",
                    options: ["It was completely necessary", "The community gave up too much for it", "It should be stricter", "It's perfect as it is"],
                    correct: 1
                },
                {
                    passage: "Jonas begins to understand that his community's perfection comes at the cost of experiencing real life.",
                    question: "What realization does Jonas begin to have?",
                    options: ["His community is completely evil", "Perfection comes at the cost of experiencing real life", "Everything is exactly as it should be", "He should leave immediately"],
                    correct: 1
                },
                {
                    passage: "The memory of the elephant's death helps Jonas understand the concept of loss and grief.",
                    question: "What concepts does the elephant memory help Jonas understand?",
                    options: ["Joy and celebration", "Loss and grief", "Anger and revenge", "Peace and calm"],
                    correct: 1
                }
            ],
            13: [ // Chapter 14
                {
                    passage: "Jonas receives a traumatic memory of war, experiencing intense pain, suffering, and death for the first time.",
                    question: "What traumatic memory does Jonas receive in this chapter?",
                    options: ["A natural disaster", "A memory of war with pain and death", "A terrible accident", "A family tragedy"],
                    correct: 1
                },
                {
                    passage: "The memory shows Jonas a battlefield with wounded and dying soldiers, giving him understanding of true pain.",
                    question: "What does the war memory show Jonas?",
                    options: ["A peaceful negotiation", "A battlefield with wounded and dying soldiers", "A celebration of victory", "Military training"],
                    correct: 1
                },
                {
                    passage: "Jonas is overwhelmed by the physical and emotional pain from the war memory.",
                    question: "How does Jonas react to the war memory?",
                    options: ["He finds it interesting", "He's overwhelmed by the pain", "He wants to experience more", "He's completely unaffected"],
                    correct: 1
                },
                {
                    passage: "That night, Jonas accidentally transmits a calming memory to Gabriel when the baby is restless.",
                    question: "What does Jonas accidentally do to Gabriel?",
                    options: ["Wakes him up", "Transmits a calming memory", "Makes him cry", "Tells him a story"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes he has the power to transmit memories to others, just like The Giver does to him.",
                    question: "What power does Jonas discover he has?",
                    options: ["Reading minds", "The ability to transmit memories to others", "Seeing the future", "Controlling emotions"],
                    correct: 1
                }
            ],
            14: [ // Chapter 15
                {
                    passage: "The Giver transmits an even more devastating war memory to Jonas, showing him the full horror of battle.",
                    question: "What kind of memory does The Giver share with Jonas in this chapter?",
                    options: ["A peaceful memory", "An even more devastating war memory", "A childhood memory", "A memory of celebration"],
                    correct: 1
                },
                {
                    passage: "Jonas experiences lying wounded on a battlefield, feeling unbearable pain and watching others die around him.",
                    question: "What does Jonas experience in this war memory?",
                    options: ["Leading troops to victory", "Lying wounded with unbearable pain", "Escaping from battle", "Helping wounded soldiers"],
                    correct: 1
                },
                {
                    passage: "The memory is so painful that Jonas cannot bear it and asks The Giver to stop.",
                    question: "How does Jonas react to this intense war memory?",
                    options: ["He wants more memories like it", "He cannot bear it and asks The Giver to stop", "He finds it educational", "He falls asleep during it"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that he must carry all these painful memories alone, which is his burden.",
                    question: "What burden does The Giver explain that he carries?",
                    options: ["Taking care of the community", "All the painful memories alone", "Making difficult decisions", "Training new Receivers"],
                    correct: 1
                },
                {
                    passage: "Jonas begins to understand the terrible loneliness and suffering that The Giver has endured for years.",
                    question: "What does Jonas begin to understand about The Giver?",
                    options: ["He's been lying about everything", "The terrible loneliness and suffering he's endured", "He enjoys having painful memories", "He wants to retire soon"],
                    correct: 1
                }
            ],
            15: [ // Chapter 16
                {
                    passage: "The Giver shares his favorite memory with Jonas: a family celebrating Christmas with love, joy, and togetherness.",
                    question: "What is The Giver's favorite memory that he shares with Jonas?",
                    options: ["A summer picnic", "A family celebrating Christmas", "A wedding ceremony", "A birthday party"],
                    correct: 1
                },
                {
                    passage: "In the Christmas memory, Jonas experiences the warmth of family love and the joy of giving gifts.",
                    question: "What does Jonas experience in the Christmas memory?",
                    options: ["Fear and anxiety", "The warmth of family love and joy of giving", "Loneliness and sadness", "Anger and frustration"],
                    correct: 1
                },
                {
                    passage: "Jonas learns about the concept of love from this memory and asks his parents if they love him.",
                    question: "What does Jonas ask his parents after receiving the Christmas memory?",
                    options: ["If they're proud of him", "If they love him", "If they're happy", "If they miss him"],
                    correct: 1
                },
                {
                    passage: "Jonas's parents laugh at his question about love, saying it's too generalized a word to be meaningful.",
                    question: "How do Jonas's parents respond when he asks about love?",
                    options: ["They say they love him deeply", "They laugh and say it's too generalized to be meaningful", "They get angry at the question", "They ignore the question"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes that his family has never experienced true love or deep emotions.",
                    question: "What painful realization does Jonas have about his family?",
                    options: ["They don't care about him", "They've never experienced true love or deep emotions", "They're planning to release him", "They're not his real parents"],
                    correct: 1
                }
            ],
            16: [ // Chapter 17
                {
                    passage: "Jonas stops taking his pills for Stirrings, wanting to experience real emotions and feelings.",
                    question: "What important decision does Jonas make regarding his medication?",
                    options: ["He takes extra pills", "He stops taking his pills for Stirrings", "He shares his pills with Gabriel", "He asks for stronger pills"],
                    correct: 1
                },
                {
                    passage: "Jonas watches his friends playing a war game and is horrified because he now knows the reality of war.",
                    question: "Why is Jonas horrified when he sees his friends playing?",
                    options: ["They're being too rough", "They're playing a war game and he knows war's reality", "They're ignoring him", "They're breaking rules"],
                    correct: 1
                },
                {
                    passage: "Jonas tries to explain to Asher about the horror of war, but Asher doesn't understand.",
                    question: "What happens when Jonas tries to explain war to Asher?",
                    options: ["Asher becomes interested", "Asher doesn't understand", "Asher gets angry", "Asher reports him to the Elders"],
                    correct: 1
                },
                {
                    passage: "Jonas feels increasingly isolated from his friends because they cannot understand his new knowledge.",
                    question: "How does Jonas feel about his relationships with friends?",
                    options: ["Closer than ever", "Increasingly isolated due to his new knowledge", "Exactly the same", "More popular"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes that without the memories, his friends and family cannot truly understand life.",
                    question: "What does Jonas realize about people without memories?",
                    options: ["They're happier", "They cannot truly understand life", "They're smarter", "They're better off"],
                    correct: 1
                }
            ],
            17: [ // Chapter 18
                {
                    passage: "The Giver tells Jonas about Rosemary, the previous Receiver-in-training who failed ten years ago.",
                    question: "Who does The Giver tell Jonas about?",
                    options: ["His daughter", "Rosemary, the previous failed Receiver", "His wife", "The Chief Elder"],
                    correct: 1
                },
                {
                    passage: "Rosemary could not handle the painful memories and asked to be released after only five weeks of training.",
                    question: "What happened to Rosemary during her training?",
                    options: ["She became the new Giver", "She couldn't handle painful memories and asked for release", "She ran away", "She was promoted"],
                    correct: 1
                },
                {
                    passage: "When Rosemary was released, all her memories returned to the community, causing chaos and confusion.",
                    question: "What happened when Rosemary was released?",
                    options: ["Nothing changed", "Her memories returned to the community causing chaos", "She took all memories with her", "The community celebrated"],
                    correct: 1
                },
                {
                    passage: "The Giver reveals that Rosemary was his daughter, making her loss deeply personal and painful.",
                    question: "What personal connection did The Giver have to Rosemary?",
                    options: ["She was his student", "She was his daughter", "She was his friend", "She was his sister"],
                    correct: 1
                },
                {
                    passage: "Jonas learns that if he died or left, all his received memories would return to the community.",
                    question: "What would happen if Jonas died or left the community?",
                    options: ["Nothing would change", "All his memories would return to the community", "The Giver would lose his memories", "A new Receiver would be chosen"],
                    correct: 1
                }
            ],
            18: [ // Chapter 19
                {
                    passage: "Jonas asks to see a recording of a release ceremony, and The Giver shows him his father releasing a newborn twin.",
                    question: "What does Jonas ask to see, and what does The Giver show him?",
                    options: ["A naming ceremony", "A recording of his father releasing a newborn twin", "A birthday celebration", "A graduation ceremony"],
                    correct: 1
                },
                {
                    passage: "Jonas watches in horror as his father injects the smaller twin with a lethal substance, killing the baby.",
                    question: "What horrifying truth does Jonas discover about release?",
                    options: ["People are sent away", "His father kills the baby with a lethal injection", "It's a celebration", "It's just a transfer"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes that 'release' means death, and his father is actually a killer who doesn't understand what he's doing.",
                    question: "What does Jonas realize about the meaning of 'release'?",
                    options: ["It's a promotion", "It means death", "It's a vacation", "It's retirement"],
                    correct: 1
                },
                {
                    passage: "The Giver explains that Jonas's father doesn't know he's killing because he has no memories of death or loss.",
                    question: "Why doesn't Jonas's father understand what he's doing?",
                    options: ["He's evil", "He has no memories of death or loss", "He enjoys killing", "He's following orders"],
                    correct: 1
                },
                {
                    passage: "Jonas is devastated to learn that his loving father is unknowingly a murderer in their society.",
                    question: "How does Jonas feel about discovering the truth about his father?",
                    options: ["Proud", "Devastated that his loving father is unknowingly a murderer", "Relieved", "Angry"],
                    correct: 1
                }
            ],
            19: [ // Chapter 20
                {
                    passage: "Jonas refuses to go home after learning the truth about release and decides to stay with The Giver.",
                    question: "What does Jonas decide after learning about release?",
                    options: ["To go home and act normal", "To refuse to go home and stay with The Giver", "To report his father", "To leave the community alone"],
                    correct: 1
                },
                {
                    passage: "Jonas and The Giver develop a plan for Jonas to escape, which will return all memories to the community.",
                    question: "What plan do Jonas and The Giver develop?",
                    options: ["To reform the community gradually", "For Jonas to escape, returning memories to the community", "To train more Receivers", "To confront the Chief Elder"],
                    correct: 1
                },
                {
                    passage: "The plan requires Jonas to leave during the night and cross the boundary of the community.",
                    question: "What does the escape plan require Jonas to do?",
                    options: ["Leave during the day", "Leave at night and cross the community boundary", "Take his family with him", "Wait for permission"],
                    correct: 1
                },
                {
                    passage: "The Giver will stay behind to help the community deal with the returned memories and emotions.",
                    question: "What will The Giver do when Jonas escapes?",
                    options: ["Escape with Jonas", "Stay to help the community deal with returned memories", "Become the new Chief Elder", "Leave for another community"],
                    correct: 1
                },
                {
                    passage: "Jonas realizes this plan will change everything for his community, forcing them to face reality.",
                    question: "What does Jonas realize about the impact of their plan?",
                    options: ["Nothing will change", "It will change everything, forcing them to face reality", "Only he will benefit", "It will make things worse"],
                    correct: 1
                }
            ],
            20: [ // Chapter 21
                {
                    passage: "Jonas learns that Gabriel is scheduled to be released the next morning, forcing him to act immediately.",
                    question: "What urgent news forces Jonas to change his escape plan?",
                    options: ["His parents are suspicious", "Gabriel is scheduled to be released the next morning", "The Giver is sick", "The community discovered his plan"],
                    correct: 1
                },
                {
                    passage: "Jonas steals his father's bicycle and takes Gabriel with him, beginning their escape from the community.",
                    question: "How does Jonas begin his escape?",
                    options: ["He walks out alone", "He steals his father's bicycle and takes Gabriel", "He asks permission to leave", "He waits for The Giver"],
                    correct: 1
                },
                {
                    passage: "As Jonas flees with Gabriel, he uses his power to transmit calming memories to keep the baby quiet.",
                    question: "How does Jonas keep Gabriel quiet during their escape?",
                    options: ["With food", "By transmitting calming memories", "With toys", "By singing"],
                    correct: 1
                },
                {
                    passage: "Jonas travels through the night, staying off the main paths to avoid search parties.",
                    question: "How does Jonas try to avoid being caught?",
                    options: ["He travels on main roads", "He stays off main paths to avoid search parties", "He hides in buildings", "He travels only during the day"],
                    correct: 1
                },
                {
                    passage: "Search planes fly overhead looking for Jonas and Gabriel, but they remain hidden.",
                    question: "What danger do Jonas and Gabriel face from above?",
                    options: ["Bad weather", "Search planes looking for them", "Wild birds", "Falling objects"],
                    correct: 1
                }
            ],
            21: [ // Chapter 22
                {
                    passage: "Jonas and Gabriel travel for days through unfamiliar terrain, facing hunger and exhaustion.",
                    question: "What challenges do Jonas and Gabriel face during their journey?",
                    options: ["Wild animals", "Hunger and exhaustion through unfamiliar terrain", "Other people", "Bad weather only"],
                    correct: 1
                },
                {
                    passage: "The landscape becomes more difficult with hills and rough terrain that Jonas has never experienced.",
                    question: "How does the landscape change as they travel?",
                    options: ["It becomes easier", "It becomes more difficult with hills and rough terrain", "It stays exactly the same", "It becomes completely flat"],
                    correct: 1
                },
                {
                    passage: "Jonas's stolen bicycle becomes useless on the rough terrain, forcing them to walk.",
                    question: "What happens to Jonas's bicycle during the journey?",
                    options: ["It gets faster", "It becomes useless on rough terrain", "It breaks completely", "Someone steals it"],
                    correct: 1
                },
                {
                    passage: "Both Jonas and Gabriel become weaker as they struggle with cold, hunger, and fatigue.",
                    question: "How do Jonas and Gabriel's physical conditions change?",
                    options: ["They become stronger", "They become weaker from cold, hunger, and fatigue", "They stay the same", "They only get tired"],
                    correct: 1
                },
                {
                    passage: "Jonas uses his remaining memories of warmth to try to keep Gabriel and himself alive.",
                    question: "How does Jonas try to help them survive?",
                    options: ["By finding shelter", "By using memories of warmth", "By building a fire", "By finding food"],
                    correct: 1
                }
            ],
            22: [ // Chapter 23
                {
                    passage: "Jonas and Gabriel reach the top of a hill where Jonas recognizes the sled from his first memory.",
                    question: "What does Jonas find at the top of the hill?",
                    options: ["A house", "The sled from his first memory", "Other people", "Food and shelter"],
                    correct: 1
                },
                {
                    passage: "With his last bit of strength, Jonas places Gabriel on the sled and they slide down the snowy hill.",
                    question: "What does Jonas do with the sled?",
                    options: ["He leaves it behind", "He places Gabriel on it and they slide down", "He uses it to build shelter", "He breaks it for firewood"],
                    correct: 1
                },
                {
                    passage: "As they sled down the hill, Jonas begins to hear music and see lights from houses below.",
                    question: "What does Jonas begin to experience as they sled down?",
                    options: ["Complete darkness", "Music and lights from houses", "More cold and snow", "Silence and emptiness"],
                    correct: 1
                },
                {
                    passage: "Jonas believes they have reached Elsewhere, where people experience true emotions and freedom.",
                    question: "What does Jonas believe they have reached?",
                    options: ["Another controlled community", "Elsewhere with true emotions and freedom", "A dangerous wilderness", "The same place they left"],
                    correct: 1
                },
                {
                    passage: "The novel ends ambiguously, leaving readers to wonder if Jonas and Gabriel have truly escaped or if Jonas is dying.",
                    question: "How does the novel end?",
                    options: ["With a clear happy ending", "Ambiguously, questioning if they escaped or Jonas is dying", "With Jonas returning home", "With Gabriel being rescued"],
                    correct: 1
                }
            ]
        };

        // ì±… ìƒì„¸ ì •ë³´ í‘œì‹œ
        function showBookDetail() {
            document.getElementById('book-detail-screen').style.display = 'block';
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'none';
            generateChapterGrid();
            updateProgress();
        }

        // ì±•í„° ê·¸ë¦¬ë“œ ìƒì„±
        function generateChapterGrid() {
            const grid = document.getElementById('chapters-grid');
            grid.innerHTML = '';

            bookData.chapterList.forEach((chapter, index) => {
                const chapterCard = document.createElement('div');
                chapterCard.className = `chapter-card ${chapter.status}`;

                chapterCard.innerHTML = `
                    <div class="chapter-header">
                        <div class="chapter-info">
                            <h4>${chapter.title}</h4>
                            <p>${chapter.description} (${chapter.questionCount}ë¬¸ì œ)</p>
                        </div>
                        <div class="chapter-status ${chapter.status}">
                            ${chapter.status === 'completed' ? 'âœ… ì™„ë£Œ' :
                              chapter.status === 'current' ? 'ğŸ“– ì§„í–‰ì¤‘' : 'ğŸ”’ ì ê¹€'}
                        </div>
                    </div>
                    <div class="chapter-actions">
                        <button class="chapter-btn audio-btn" onclick="playChapterAudio(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            ğŸ§ ì˜¤ë””ì˜¤
                        </button>
                        <button class="chapter-btn quiz-btn" onclick="startLearning(${index})"
                                ${chapter.status === 'locked' ? 'disabled' : ''}>
                            ğŸ“ ë¬¸ì œí’€ê¸°
                        </button>
                    </div>
                `;

                grid.appendChild(chapterCard);
            });
        }

        // ì§„ë„ ì—…ë°ì´íŠ¸
        function updateProgress() {
            const completedChapters = bookData.chapterList.filter(chapter => chapter.status === 'completed').length;
            const progressPercent = Math.round((completedChapters / bookData.chapters) * 100);
            document.getElementById('progress-value').textContent = `${progressPercent}%`;
        }

        // í•™ìŠµ ì‹œì‘
        function startLearning(chapterIndex) {
            if (bookData.chapterList[chapterIndex].status === 'locked') return;

            currentChapter = chapterIndex;
            currentQuestion = 0;
            userAnswers = [];
            questions = questionsData[chapterIndex] || [];

            if (questions.length === 0) {
                alert('ì´ ì±•í„°ì˜ ë¬¸ì œê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            document.getElementById('book-detail-screen').style.display = 'none';
            document.getElementById('learning-screen').style.display = 'block';
            document.getElementById('result-screen').style.display = 'none';

            const chapter = bookData.chapterList[chapterIndex];
            document.getElementById('learning-title').textContent = chapter.title;
            document.getElementById('learning-chapter-breadcrumb').textContent = chapter.title;

            showQuestion();
        }

        // ë¬¸ì œ í‘œì‹œ
        function showQuestion() {
            if (currentQuestion >= questions.length) {
                submitAnswers();
                return;
            }

            const question = questions[currentQuestion];
            const container = document.getElementById('question-container');

            container.innerHTML = `
                <div class="passage">${question.passage}</div>
                <div class="question-text">${question.question}</div>
                <div class="options">
                    ${question.options.map((option, index) =>
                        `<div class="option" onclick="selectOption(${index})" data-index="${index}">
                            ${String.fromCharCode(65 + index)}. ${option}
                        </div>`
                    ).join('')}
                </div>
            `;

            // ì§„ë„ ë°” ì—…ë°ì´íŠ¸
            const progressPercent = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('learning-progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('learning-progress-text').textContent = `ë¬¸ì œ ${currentQuestion + 1} / ${questions.length}`;

            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.getElementById('prev-btn').disabled = currentQuestion === 0;
            document.getElementById('next-btn').style.display = currentQuestion === questions.length - 1 ? 'none' : 'inline-block';
            document.getElementById('submit-btn').style.display = currentQuestion === questions.length - 1 ? 'inline-block' : 'none';

            // ì´ì „ ë‹µë³€ì´ ìˆë‹¤ë©´ í‘œì‹œ
            if (userAnswers[currentQuestion] !== undefined) {
                const selectedOption = container.querySelector(`[data-index="${userAnswers[currentQuestion]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
        }

        // ì˜µì…˜ ì„ íƒ
        function selectOption(index) {
            // ê¸°ì¡´ ì„ íƒ ì œê±°
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });

            // ìƒˆ ì„ íƒ ì¶”ê°€
            document.querySelector(`[data-index="${index}"]`).classList.add('selected');
            userAnswers[currentQuestion] = index;
        }

        // ë‹¤ìŒ ë¬¸ì œ
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion();
            }
        }

        // ì´ì „ ë¬¸ì œ
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        // ë‹µì•ˆ ì œì¶œ
        function submitAnswers() {
            let correctCount = 0;
            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] === questions[i].correct) {
                    correctCount++;
                }
            }

            const score = Math.round((correctCount / questions.length) * 100);

            // ì±•í„° ìƒíƒœ ì—…ë°ì´íŠ¸
            if (score >= 70) { // 70ì  ì´ìƒì´ë©´ í†µê³¼
                bookData.chapterList[currentChapter].status = 'completed';

                // ë‹¤ìŒ ì±•í„° ì ê¸ˆ í•´ì œ
                if (currentChapter + 1 < bookData.chapterList.length) {
                    if (bookData.chapterList[currentChapter + 1].status === 'locked') {
                        bookData.chapterList[currentChapter + 1].status = 'current';
                    }
                }
            }

            showResult(correctCount, score);
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(correctCount, score) {
            document.getElementById('learning-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';

            document.getElementById('score-circle').textContent = `${score}%`;
            document.getElementById('total-questions').textContent = `${questions.length}ë¬¸ì œ`;
            document.getElementById('correct-answers').textContent = `${correctCount}ë¬¸ì œ`;
            document.getElementById('wrong-answers').textContent = `${questions.length - correctCount}ë¬¸ì œ`;
            document.getElementById('final-score').textContent = `${score}ì `;

            let message = '';
            let circleColor = '';

            if (score >= 90) {
                message = 'ğŸŒŸ ì™„ë²½í•©ë‹ˆë‹¤!';
                circleColor = 'linear-gradient(45deg, #2C3E50, #3498DB)';
            } else if (score >= 80) {
                message = 'ğŸ‰ í›Œë¥­í•´ìš”!';
                circleColor = 'linear-gradient(45deg, #2C3E50, #3498DB)';
            } else if (score >= 70) {
                message = 'ğŸ‘ ì˜í–ˆì–´ìš”!';
                circleColor = 'linear-gradient(45deg, #2C3E50, #3498DB)';
            } else {
                message = 'ğŸ’ª ë‹¤ì‹œ ë„ì „í•´ë³´ì„¸ìš”!';
                circleColor = 'linear-gradient(45deg, #ff9800, #f57c00)';
            }

            document.getElementById('result-message').textContent = message;
            document.getElementById('score-circle').style.background = circleColor;
        }

        // ì±•í„° ë‹¤ì‹œ í’€ê¸°
        function retryChapter() {
            startLearning(currentChapter);
        }

        // ë‹¤ìŒ ì±•í„°
        function nextChapter() {
            if (currentChapter + 1 < bookData.chapterList.length) {
                if (bookData.chapterList[currentChapter + 1].status !== 'locked') {
                    startLearning(currentChapter + 1);
                } else {
                    showBookDetail();
                }
            } else {
                showBookDetail();
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', function() {
            showBookDetail();
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('learning-screen').style.display === 'block') {
                if (e.key === 'ArrowLeft') {
                    previousQuestion();
                } else if (e.key === 'ArrowRight') {
                    nextQuestion();
                } else if (e.key >= '1' && e.key <= '4') {
                    const optionIndex = parseInt(e.key) - 1;
                    if (optionIndex < questions[currentQuestion]?.options.length) {
                        selectOption(optionIndex);
                    }
                }
            }

            if (e.key === 'Escape') {
                closeAudioModal();
            }
        });

        // ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', function() {
            const audioPlayer = document.getElementById('audio-player');

            if (audioPlayer) {
                audioPlayer.addEventListener('play', function() {
                    document.querySelector('.play-pause-btn').textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
                });

                audioPlayer.addEventListener('pause', function() {
                    document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
                });

                audioPlayer.addEventListener('ended', function() {
                    document.querySelector('.play-pause-btn').textContent = 'â–¶ï¸ ì¬ìƒ';
                });
            }
        });
    </script>
</body>
</html>